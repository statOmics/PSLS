<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Lieven Clement" />


<title>10. Categorical Data Analysis</title>

<script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">PSLS</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01-intro.html">1. Introduction</a>
    </li>
    <li>
      <a href="02-concepts.html">2. Concepts</a>
    </li>
    <li>
      <a href="03-experimentalDesign.html">3. Experimental Design I</a>
    </li>
    <li>
      <a href="04-dataExploration.html">4. Data Exploration</a>
    </li>
    <li>
      <a href="05-statisticalInference.html">5.1 Statistical Inference 1</a>
    </li>
    <li>
      <a href="05-statisticalInference-twosampleT.html">5.2 Statistical Inference 2</a>
    </li>
    <li>
      <a href="06-linearRegression.html">6. Linear Regression</a>
    </li>
    <li>
      <a href="07-Anova.html">7. Analysis of Variance</a>
    </li>
    <li>
      <a href="08-MultipleRegression.html">8. Multiple Regression</a>
    </li>
    <li>
      <a href="08-MultipleRegression-SpecificDesigns.html">8.2 Multiple Regression: Factorial Designs</a>
    </li>
    <li>
      <a href="08-experimentalDesignII.html">8.3. Experimental Design II</a>
    </li>
    <li>
      <a href="08-experimentalDesignIII.html">8.4. Experimental Design II</a>
    </li>
    <li>
      <a href="09-NonparametericStatistics-WilcoxonMannWithney.html">9.1. Nonparametric Statistics 1</a>
    </li>
    <li>
      <a href="09-NonparametericStatistics-KruskalWallis.html">9.2. Nonparametric Statistics 2</a>
    </li>
    <li>
      <a href="10-categoricalDataAnalysis.html">10. Categorical Data Analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-laptop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="04_exercises.html">4. Data Exploration</a>
    </li>
    <li>
      <a href="05_exercises.html">5. Statistical inference</a>
    </li>
    <li>
      <a href="06_exercises.html">6. Simple linear regression</a>
    </li>
    <li>
      <a href="07_exercises.html">7. ANOVA</a>
    </li>
    <li>
      <a href="08_exercises.html">8. Multiple linear regression</a>
    </li>
    <li>
      <a href="09_exercises.html">9. Non-parametric statistics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/statOmics/PSLS">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://statomics.github.io/">statOmics</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">10. Categorical Data Analysis</h1>
<h4 class="author">Lieven Clement</h4>
<h4 class="date">statOmics, Ghent University (<a href="https://statomics.github.io" class="uri">https://statomics.github.io</a>)</h4>

</div>


<p><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rmisc)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NHANES)</span></code></pre></div>
<div id="introduction" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>Until now we used models for a continuous response in function of categorical or continuous predictor. Here we will focus on a categorical response.</p>
<ul>
<li>we study the association of a categorical outcome and a categorical predictor and</li>
<li>touch upon methods to model a categorical outcome with a continuous response.</li>
</ul>
<hr />
</div>
<div id="test-for-a-proportion" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Test for a proportion</h1>
<div id="saksen-study" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Saksen-study</h2>
<ul>
<li>Fairly closed population (few migration)</li>
<li>Probability that an unborn child is male?</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>boys <span class="ot">&lt;-</span> <span class="dv">3175</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">6155</span></span></code></pre></div>
<ul>
<li>On 6155 unborn children 3175 boys are observed.</li>
<li>Is there a difference in the probability on the gender of an unborn child?</li>
</ul>
<hr />
<ul>
<li><p>The data are derived from a binary random variable <span class="math inline">\(X\)</span></p>
<ul>
<li><span class="math inline">\(X=1\)</span> for a boy and</li>
<li><span class="math inline">\(X=0\)</span> for a girl.</li>
</ul></li>
<li><p>Note: count problem: the outcome is a count (number of boys)</p></li>
<li><p>Formally we have considered a population of unborn children where each individual is characterized by a 0 or 1.</p></li>
</ul>
<hr />
</div>
<div id="bernoulli-probability-mass-distribution" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Bernoulli Probability Mass Distribution</h2>
<ul>
<li><p>Binary data can be modelled using a Bernoulli distribution: <span class="math display">\[\begin{eqnarray*}
X_i &amp;\sim&amp; B(\pi) \text{ with}\\
B(\pi)&amp;=&amp;\pi^{X_i}(1-\pi)^{(1-X_i)},
\end{eqnarray*}\]</span></p></li>
<li><p>It has one model parameter <span class="math inline">\(\pi\)</span></p>
<ul>
<li>Expected value of <span class="math inline">\(X_i\)</span>: <span class="math inline">\(\text{E}[X_i]=\pi,\)</span></li>
<li>Proportion of unborn boys (children with <span class="math inline">\(X=1\)</span>) in the population.</li>
<li>Hence <span class="math inline">\(\pi\)</span> is the probability that a random individual from the population is a boy (an observation with <span class="math inline">\(X=1\)</span>).</li>
</ul></li>
<li><p>The variance of Bernoulli data is also related to <span class="math inline">\(\pi\)</span>. <span class="math display">\[\text{Var}[X_i]=\pi (1-\pi).\]</span></p></li>
</ul>
<hr />
<p>Some Bernoulli probability mass functions</p>
<p><img src="10-categoricalDataAnalysis_files/figure-html/unnamed-chunk-2-1.png" width="100%" style="display: block; margin: auto;" /></p>
<hr />
<ul>
<li>In the Saksen study 6155 observaties were sampled at random from the population.</li>
<li>We can estimate <span class="math inline">\(\pi\)</span> using the sample mean: <span class="math display">\[\hat \pi = \bar X = \frac{\sum\limits_{i=1}^n X_i}{n},\]</span></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> boys <span class="sc">/</span> n</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>pi</span></code></pre></div>
<pre><code>[1] 0.5158408</code></pre>
<p>In our example <span class="math inline">\(\bar x =\)</span> 3175 / 6155 = 51.6%.</p>
<hr />
</div>
<div id="binomiale-test" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Binomiale test</h2>
<ul>
<li><p>Is the observed probability 51.6% that an unborn child is male, sufficient evidence to conclude that there is a higher chance on a boy than on a girl?</p></li>
<li><p>Statistical test for <span class="math display">\[H_0: \pi=1/2 \text{ versus } H_1: \pi\neq 1/2,\]</span></p></li>
<li><p>We need known the distribution of</p>
<ul>
<li><span class="math inline">\(X\)</span> and <span class="math inline">\(\bar X\)</span></li>
<li>or of the sum <span class="math inline">\(S=n\bar X\)</span>.</li>
</ul></li>
</ul>
<hr />
<ul>
<li><p>Suppose that <span class="math inline">\(H_0:\pi=1/2\)</span> is true (boys and girls have an equal frequency in the population)</p></li>
<li><p>A random individual from the population has a probability of <span class="math display">\[P(X=1)=\pi=1/2.\]</span> to be a boy</p></li>
<li><p>Two children that are drawn independently :</p>
<ul>
<li>Probability of <span class="math inline">\(\pi=1/2\)</span> on a boy for the first and second child (independent from each other)</li>
<li>Outcomes <span class="math inline">\((x_1, x_2)\)</span> for both children have 4 possible combinations: <span class="math inline">\((0,0),(0,1),(1,0)\text{ en }(1,1).\)</span></li>
<li>Each of them has a probability of <span class="math inline">\(1/4 = 1/2 \times 1/2\)</span>.</li>
</ul></li>
<li><p>Random variable <span class="math inline">\(S\)</span> is the sum of the outcomes :</p></li>
</ul>
<table>
<thead>
<tr class="header">
<th align="center"><span class="math inline">\((x_1,x_2)\)</span></th>
<th align="center"><span class="math inline">\(s\)</span></th>
<th align="center"><span class="math inline">\(P(S = s)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">(0,0)</td>
<td align="center">0</td>
<td align="center">1/4</td>
</tr>
<tr class="even">
<td align="center">(0,1), (1,0)</td>
<td align="center">1</td>
<td align="center">1/2</td>
</tr>
<tr class="odd">
<td align="center">(1,1)</td>
<td align="center">2</td>
<td align="center">1/4</td>
</tr>
</tbody>
</table>
<hr />
<div id="general-n-independent-samples" class="section level3" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> General: <span class="math inline">\(n\)</span> independent samples</h3>
<ul>
<li><p>Probability for <span class="math inline">\(\pi\)</span> on success (<span class="math inline">\(X=1\)</span>)</p></li>
<li><p>Total number of successes <span class="math inline">\(S\)</span> (sum of all values of 1) can take <span class="math inline">\(n+1\)</span> possible values <span class="math display">\[S=k\text{, met }k=0,\ldots,n\]</span></p></li>
<li><p>Distribution of <span class="math inline">\(S\)</span>? <span class="math display">\[\begin{equation}
P(S=k) = \left (
\begin{array}{c}
n \\
k \\
\end{array}
\right ) \pi^k (1-\pi)^{n-k}
\end{equation}\]</span></p></li>
<li><p><span class="math inline">\(1-\pi\)</span>: probability on 0 for individual observation and</p></li>
<li><p>binomial coefficient <span class="math display">\[\begin{equation*}
\left (
\begin{array}{c}
n \\
k \\
\end{array}
\right ) = \frac{n \times (n-1) \times ...\times (n-k+1) }{ k!} = \frac{ n!}{ k!(n-k)! }
\end{equation*}\]</span></p></li>
<li><p>In R you can calculate the probabilities on each <span class="math inline">\(S=k\)</span> with the function <code>dbinom(k,n,p)</code></p></li>
</ul>
<hr />
</div>
<div id="binomial-distribution" class="section level3" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Binomial Distribution</h3>
<p>S is a:</p>
<ul>
<li><p><em>Binomial distributed random variable</em> with <em>Binomial probability mass function</em></p></li>
<li><p>Parameters</p>
<ul>
<li><span class="math inline">\(n\)</span> (total number of draws from the population, is equivalent to maximal value of the outcome)</li>
<li><span class="math inline">\(\pi\)</span> (probability on <code>success</code> for each draw).</li>
</ul></li>
<li><p>Calculate probability on <span class="math inline">\(k\)</span> successes on <span class="math inline">\(n\)</span> independent draws each with a succes probability of <span class="math inline">\(\pi\)</span>.</p></li>
<li><p>For binary data X.</p></li>
<li><p>e.g.: wild type vs mutant of a gene, infected or not infected with HIV, …</p></li>
<li><p>Use: Compare proportions or risks on a particular event between groups.</p></li>
</ul>
<hr />
</div>
<div id="some-binomial-probability-mass-functions." class="section level3" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Some Binomial probability mass functions.</h3>
<div class="figure" style="text-align: center">
<img src="10-categoricalDataAnalysis_files/figure-html/binoms-1.png" alt="Binomiale verdelingen." width="80%" />
<p class="caption">
Binomiale verdelingen.
</p>
</div>
<hr />
<p>Test statistic <span class="math display">\[H_0:\pi=1/2\text{ vs }H_1:\pi\neq 1/2\]</span></p>
<ul>
<li><span class="math inline">\(\bar X-1/2\)</span> or, equivalent,</li>
<li><span class="math inline">\(\Delta=n(\bar X-\pi_0)=S-s_0\)</span>.</li>
<li>Distribution of the latter test statistic can be derived immediately from the Binomial distribution:
<ul>
<li>We observe <span class="math inline">\(s=\)</span> 3175 and thus <span class="math inline">\(\delta=s-s_0=\)</span> 3175 <span class="math inline">\(-\)</span> 6155 <span class="math inline">\(\times 0.5=\)</span> 97.5.</li>
<li>When boys and girls are equally likely, i.e. under <span class="math inline">\(H_0:\pi=1/2\)</span>, we will get following two-sided p-value: <span class="math display">\[p=\text{P}_0\left[S-s_0\geq \vert \delta\vert \right] + \text{P}_0\left[S-s_0\leq - \vert \delta\vert \right].\]</span></li>
</ul></li>
<li>Note, that we can rewrite it in terms of S. <span class="math display">\[p=\text{P}_0\left[S\geq s_0+ \vert \delta\vert \right] + \text{P}_0\left[S \leq s_0 - \vert \delta\vert \right].\]</span></li>
</ul>
<hr />
<ul>
<li>For the Saksen study we calculate:</li>
</ul>
<p><span class="math display">\[\begin{eqnarray*}
\text{P}_0\left[S\geq s_0+ \vert \delta\vert \right] &amp;=&amp; P(S \geq 6155 \times 0.5 + \vert 3175 - 6155 \times 0.5\vert ) \\&amp;=&amp; P(S \geq 3175)\\
&amp;= &amp;P(S= 3175) + P(S=3176) + ... + P(S=6155)\\
&amp; =&amp; 0.0067\\\\
\text{P}_0\left[S \leq s_0 - \vert \delta\vert \right] &amp;=&amp; P(S \leq  6155 \times 0.5 - \vert 3175- 6155 \times 0.5\vert) \\&amp;=&amp; P(S \leq 2980)\\ &amp;= &amp;P(S=0) + ... + P(S=2980) \\
&amp;=&amp;0.0067
\end{eqnarray*}\]</span></p>
<ul>
<li>The Binomial distribution is symmetric for<span class="math inline">\(\pi=1/2\)</span>: <span class="math display">\[\text{P}_0\left[S\geq s_0+ \vert \delta\vert \right] = \text{P}_0\left[S \leq s_0 - \vert \delta\vert \right]\]</span></li>
<li>This is no longer the case when <span class="math inline">\(\pi\)</span> deviate from 0.5.</li>
</ul>
<hr />
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>pi0 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>s0 <span class="ot">&lt;-</span> pi0 <span class="sc">*</span> n</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">&lt;-</span> <span class="fu">abs</span>(boys <span class="sc">-</span> s0)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>delta</span></code></pre></div>
<pre><code>[1] 97.5</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>sUp <span class="ot">&lt;-</span> s0 <span class="sc">+</span> delta</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>sDown <span class="ot">&lt;-</span> s0 <span class="sc">-</span> delta</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(sDown, sUp)</span></code></pre></div>
<pre><code>[1] 2980 3175</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>pUp <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pbinom</span>(sUp <span class="sc">-</span> <span class="dv">1</span>, n, pi0)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>pDown <span class="ot">&lt;-</span> <span class="fu">pbinom</span>(sDown, n, pi0)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> pUp <span class="sc">+</span> pDown</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(pUp, pDown, p)</span></code></pre></div>
<pre><code>[1] 0.006699883 0.006699883 0.013399766</code></pre>
<hr />
<ul>
<li>If <span class="math inline">\(\pi= 1/2\)</span>, the probability to observe at least <span class="math inline">\(\delta=\)</span> 97.5 boys more or less than the mean under <span class="math inline">\(H_0: s_0=\)</span> 3077.5 in a random sample under H_0 is only 1.34% is: <strong><span class="math inline">\(p\)</span>-value of binomial test.</strong></li>
<li>Very unlikely to observe such a large number of boys in a random sample when boys and girls have the same frequency in the population (under <span class="math inline">\(H_0\)</span>).</li>
<li>Hence the hypothesis that the frequency of boys and girls is the same is not supported by the data.</li>
</ul>
<hr />
<p><img src="10-categoricalDataAnalysis_files/figure-html/unnamed-chunk-5-1.png" width="100%" style="display: block; margin: auto;" /></p>
<hr />
<p>The test can immediately be conducted using the <code>binomial.test</code> function in R.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.test</span>(<span class="at">x =</span> boys, <span class="at">n =</span> n, <span class="at">p =</span> pi0)</span></code></pre></div>
<pre><code>
    Exact binomial test

data:  boys and n
number of successes = 3175, number of trials = 6155, p-value = 0.0134
alternative hypothesis: true probability of success is not equal to 0.5
95 percent confidence interval:
 0.5032696 0.5283969
sample estimates:
probability of success 
             0.5158408 </code></pre>
<p>On the 5% significance-level we conclude that there is on average a higher probability on a unborn male child than an unborn female child.</p>
<hr />
</div>
<div id="confidence-interval-on-a-proportion" class="section level3" number="2.3.4">
<h3><span class="header-section-number">2.3.4</span> Confidence interval on a proportion</h3>
<ul>
<li>Estimator of the proportion of boys in the population is the sample mean <span class="math inline">\(\hat \pi=\bar x=\)</span> 0.516</li>
<li>The standard error is <span class="math display">\[SE_{\bar x}=\sqrt{\frac{\text{Var}[X]}{n}}=\sqrt{\frac{\pi(1-\pi)}{n}}\]</span></li>
<li>We can estimate this based on the sample: <span class="math inline">\(SE_{\bar x}=\sqrt{\frac{\hat\pi(1-\hat\pi)}{n}}=\)</span> 0.0064.</li>
<li>95% CI via CLT: <span class="math inline">\(\hat\pi \pm 1.96 SE_{\hat\pi}.\)</span></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pi <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pi) <span class="sc">/</span> n)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>pi <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se</span></code></pre></div>
<pre><code>[1] 0.5033559 0.5283257</code></pre>
<hr />
</div>
<div id="ci-on-proportion-in-small-sample" class="section level3" number="2.3.5">
<h3><span class="header-section-number">2.3.5</span> CI on proportion in small sample?</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">binom.test</span>(<span class="at">x =</span> boys, <span class="at">n =</span> n, <span class="at">p =</span> pi0)<span class="sc">$</span>conf.int</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>CI</span></code></pre></div>
<pre><code>[1] 0.5032696 0.5283969
attr(,&quot;conf.level&quot;)
[1] 0.95</code></pre>
<hr />
</div>
<div id="conclusion" class="section level3" number="2.3.6">
<h3><span class="header-section-number">2.3.6</span> Conclusion</h3>
<ul>
<li><p>Note that the test for a proportion is equivalent to a one-sample t-test for binary data.</p></li>
<li><p>For the Saksen population we conclude at the 5% significance level that the gender of unborn children is more likely to be male than female (<span class="math inline">\(p=\)</span> 0.013). The probability that an unborn child is male equals 51.6% (95% CI [50.3,52.8]%).</p></li>
</ul>
<hr />
</div>
</div>
</div>
<div id="test-for-association-between-two-qualitative-variables" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Test for association between two qualitative variables</h1>
<div id="paired-observations" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Paired observations</h2>
<ul>
<li>2 measurements on same individual</li>
<li>e.g. before and after exposure to a chemical substance</li>
<li>observe a categorical outcome before and after.</li>
<li><em>paired binary responses</em></li>
<li>Statistical analysis has to account for paired design.</li>
</ul>
<hr />
<div id="example-females-choose-gentle-but-not-healthy-or-macho-males-in-campbell-dwarf-hamsters-rogovin-et-al.-2017" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Example: Females choose gentle, but not healthy or macho males in Campbell dwarf hamsters (Rogovin et al. 2017)</h3>
<p><img src="10-categoricalDataAnalysis_files/figure-html/unnamed-chunk-9-1.png" width="70%" style="display: block; margin: auto;" /></p>
<hr />
<ul>
<li><p>The gate is opened upon 3 minutes</p></li>
<li><p>aggressive vs non-agressive male</p></li>
<li><p>Each female undergoes the test twice:</p>
<ul>
<li>once upon stay in hostile environment (high population density, shortage of feed, a lot of competition)</li>
<li>and once upon stay in gentle evironment.</li>
</ul></li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">friendly_agressive</th>
<th align="left">friendly_non-agressive</th>
<th align="left">total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">hostile_agressive</td>
<td align="left">3 (e)</td>
<td align="left">17 (f)</td>
<td align="left">20</td>
</tr>
<tr class="even">
<td align="left">hostile_non-agressive</td>
<td align="left">1 (g)</td>
<td align="left">13 (h)</td>
<td align="left">14</td>
</tr>
<tr class="odd">
<td align="left">total</td>
<td align="left">4</td>
<td align="left">30</td>
<td align="left">34</td>
</tr>
</tbody>
</table>
<hr />
</div>
<div id="absolute-risk-difference-ard" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Absolute risk difference (ARD)</h3>
<ul>
<li><p><span class="math inline">\(\pi_1=P[\text{agressive male } \vert \text{hostile}]\)</span></p></li>
<li><p><span class="math inline">\(\hat \pi_1=(e+f)/n\)</span>, with <span class="math inline">\(n=e+f+g+h\)</span>.</p></li>
<li><p><span class="math inline">\(\pi_0=P[\text{agressive male } \vert \text{ friendly}]\)</span></p></li>
<li><p><span class="math inline">\(\hat \pi_0=(e+g)/n\)</span> <span class="math display">\[\begin{equation*}
\widehat{\text{ARD}}=\hat\pi_1-\hat\pi_0=\frac{e+f}{n}-\frac{e+g}{n}=\frac{f-g}{n}
\end{equation*}\]</span></p></li>
<li><p>Only affected by discordant pairs <span class="math inline">\(f\)</span> en <span class="math inline">\(g\)</span></p></li>
</ul>
<hr />
<ul>
<li><p>Standard error on ARD <span class="math display">\[\begin{equation*}
\text{SE}_{\widehat{\text{ARD}}}=\frac{1}{n}\sqrt{f+g-\frac{(f-g)^2}{n}}
\end{equation*}\]</span></p></li>
<li><p>If we have large number of observations we can use the CLT to establish an <span class="math inline">\((1-\alpha)100\%\)</span> CI on the ARD <span class="math display">\[\left[\widehat{\text{ARD}}-z_{\alpha/2}\text{SE}_{\widehat{\text{ARD}}},\widehat{\text{ARD}}-z_{\alpha/2}\text{SE}_{\widehat{\text{ARD}}}\right]\]</span> or <span class="math display">\[\left[\frac{f-g}{n}-\frac{z_{\alpha/2}}{n}\sqrt{f+g-\frac{(f-g)^2}{n}},\frac{f-g}{n}+\frac{z_{\alpha/2}}{n}\sqrt{f+g-\frac{(f-g)^2}{n}}\right] \]</span></p></li>
</ul>
<hr />
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>hamster <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">17</span>, <span class="dv">1</span>, <span class="dv">13</span>), <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(hamster) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;hostile-agressive&quot;</span>, <span class="st">&quot;hostile-non-agressive&quot;</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(hamster) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;friendly-agressive&quot;</span>, <span class="st">&quot;friendly-non-agressive&quot;</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> hamster[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> hamster[<span class="dv">2</span>, <span class="dv">1</span>]</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">sum</span>(hamster)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>riskdiff <span class="ot">&lt;-</span> (f <span class="sc">-</span> g) <span class="sc">/</span> n</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>riskdiff</span></code></pre></div>
<pre><code>[1] 0.4705882</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(f <span class="sc">+</span> g <span class="sc">-</span> (f <span class="sc">-</span> g)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> n) <span class="sc">/</span> n</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>se</span></code></pre></div>
<pre><code>[1] 0.09517144</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> riskdiff <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> se</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>ci</span></code></pre></div>
<pre><code>[1] 0.2840556 0.6571208</code></pre>
<hr />
<p><span class="math display">\[\begin{equation*}
\widehat{\text{ARD}}=\frac{17-1}{34}=0.471
\end{equation*}\]</span> The absolute risk difference on choosing for an agressive male is 47.1% larger upon staying in a hostile environment that when residing in a gentle environment. - The standard error <span class="math display">\[\begin{equation*}
\text{SE}_{\widehat{\text{ARD}}}=\frac{1}{34}\sqrt{17+1-\frac{(17-1)^2}{34}}=0.0952
\end{equation*}\]</span> - A 95% confidence interval on this absolute risk difference is <span class="math display">\[\begin{equation*}
\left[0.471-1.96\times 0.0952,0.471+1.96\times 0.0952\right]=[0.284,0.658]
\end{equation*}\]</span></p>
<hr />
</div>
</div>
<div id="mcnemar-test" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> McNemar test</h2>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">friendly_agressive</th>
<th align="left">friendly_non-agressive</th>
<th align="left">total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">hostile_agressive</td>
<td align="left">3 (e)</td>
<td align="left">17 (f)</td>
<td align="left">20</td>
</tr>
<tr class="even">
<td align="left">hostile_non-agressive</td>
<td align="left">1 (g)</td>
<td align="left">13 (h)</td>
<td align="left">14</td>
</tr>
<tr class="odd">
<td align="left">total</td>
<td align="left">4</td>
<td align="left">30</td>
<td align="left">34</td>
</tr>
</tbody>
</table>
<ul>
<li>Assess if risk on choice for agressive male differs between residing in hostile and friendly environment.</li>
<li>Only discordant pairs give information.</li>
<li><span class="math inline">\(f&gt;g\)</span> indication against <span class="math inline">\(H_0\)</span>: choice of partner not associated with environment.</li>
<li>Evaluate probability that in a random discordant pair, a female chooses an agressive male upon a stay in a hostile environment.</li>
<li>We estimate the probability as <span class="math display">\[\frac{f}{f+g}\]</span></li>
</ul>
<hr />
<p><span class="math display">\[\begin{eqnarray*}
  \text{E}\left[f/(f+g)\right]&amp;\stackrel{H_0}{=}&amp; 0.5\\
  f &amp; \stackrel{H_0}{\sim}&amp; \text{Binom}(n=f+g,\pi=0.5)\\
  \text{SE}_{\frac{f}{f+g}} &amp; \stackrel{H_0}{=}&amp; \sqrt{(f+g)\times 0.5\times 0.5}=\frac{\sqrt{f+g}}{2}
\end{eqnarray*}\]</span></p>
<hr />
<ul>
<li>Asymptotically a one-sample z-test (based on the Normal distribution)</li>
</ul>
<p><span class="math display">\[\begin{equation*}
z=\frac{f-(f+g)/2}{\sqrt{f+g}/2}=\frac{f-g}{\sqrt{f+g}}
\end{equation*}\]</span></p>
<ul>
<li>Normal approximation is good if <span class="math display">\[f \times g/(f+g) \geq 5\]</span></li>
</ul>
<p>The <strong>Mc Nemar test</strong> is the analogon of the paired t-test for binary qualitative variables.</p>
<hr />
<p>In R we can conduct the analysis using the <code>mcnemar.test</code> function</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcnemar.test</span>(hamster)</span></code></pre></div>
<pre><code>
    McNemar&#39;s Chi-squared test with continuity correction

data:  hamster
McNemar&#39;s chi-squared = 12.5, df = 1, p-value = 0.000407</code></pre>
<ul>
<li>We reject the null hypothesis at the 5% significance level</li>
<li>We conclude that the choice of partner is extremely significantly associated with the environment.</li>
</ul>
<hr />
<ul>
<li>Normale approximation is not optimal and we can perform an exact test using the binomiale test</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.test</span>(<span class="at">x =</span> f, <span class="at">n =</span> f <span class="sc">+</span> g, <span class="at">p =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>
    Exact binomial test

data:  f and f + g
number of successes = 17, number of trials = 18, p-value = 0.000145
alternative hypothesis: true probability of success is not equal to 0.5
95 percent confidence interval:
 0.7270564 0.9985944
sample estimates:
probability of success 
             0.9444444 </code></pre>
<hr />
<div id="conclusion-1" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Conclusion</h3>
<ul>
<li>We conclude that the partner choice is extremely signficantly associated with the environment (<span class="math inline">\(p&lt;0.001\)</span>).</li>
<li>The probability on choosing an agressive male is on average 47.1% higher when a female hamster resides in a hostile environment than when she resides in a friendly environment (95% CI [28.4,65.7]%).</li>
</ul>
<hr />
</div>
</div>
</div>
<div id="unpaired-observations" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Unpaired observations</h1>
<div id="genetic-association-study" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Genetic association study</h2>
<ul>
<li>Are genetic polymorphisms in the BRCA1 gene associated with breast cancer?</li>
<li>Retrospective case-control study with 800 breast cancer cases en 572 controls</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>brca <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/GTPB/PSLS20/master/data/brca.csv&quot;</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(brca)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["cancer"],"name":[1],"type":["chr"],"align":["left"]},{"label":["variant"],"name":[2],"type":["chr"],"align":["left"]},{"label":["variant2"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"control","2":"pro/pro","3":"other"},{"1":"control","2":"pro/pro","3":"other"},{"1":"control","2":"pro/pro","3":"other"},{"1":"control","2":"pro/pro","3":"other"},{"1":"control","2":"pro/pro","3":"other"},{"1":"control","2":"pro/pro","3":"other"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(brca)</span></code></pre></div>
<pre><code>    cancer            variant            variant2        
 Length:1372        Length:1372        Length:1372       
 Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character  </code></pre>
<hr />
<table>
<thead>
<tr class="header">
<th align="left">Genotype</th>
<th align="left">Control</th>
<th align="left">Cases</th>
<th align="left">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Pro/Pro</td>
<td align="left">266 (a)</td>
<td align="left">342 (d)</td>
<td align="left">608 (a+d)</td>
</tr>
<tr class="even">
<td align="left">Pro/Leu</td>
<td align="left">250 (b)</td>
<td align="left">369 (e)</td>
<td align="left">619 (b+e)</td>
</tr>
<tr class="odd">
<td align="left">Leu/Leu</td>
<td align="left">56 (c)</td>
<td align="left">89 (f)</td>
<td align="left">145 (c+f)</td>
</tr>
<tr class="even">
<td align="left">Totaal</td>
<td align="left">572 (a+b+c)</td>
<td align="left">800 (d+e+f)</td>
<td align="left">1372 (n)</td>
</tr>
</tbody>
</table>
<ul>
<li>In case-control study one chooses a fixed number of cases and controls and registers which exposures they had in the past.</li>
<li>Retrospective study</li>
<li>Impossible to assess risks and risk-differences on breast cancer because the proportion of cases and controls does not reflect that in the population!</li>
</ul>
<hr />
<table>
<thead>
<tr class="header">
<th align="left">Genotype</th>
<th align="left">Controls</th>
<th align="left">Cases</th>
<th align="left">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Pro/Pro</td>
<td align="left">266 (a)</td>
<td align="left">342 (d)</td>
<td align="left">608 (a+d)</td>
</tr>
<tr class="even">
<td align="left">Pro/Leu</td>
<td align="left">250 (b)</td>
<td align="left">369 (e)</td>
<td align="left">619 (b+e)</td>
</tr>
<tr class="odd">
<td align="left">Leu/Leu</td>
<td align="left">56 (c)</td>
<td align="left">89 (f)</td>
<td align="left">145 (c+f)</td>
</tr>
<tr class="even">
<td align="left">Totaal</td>
<td align="left">572 (a+b+c)</td>
<td align="left">800 (d+e+f)</td>
<td align="left">1372 (n)</td>
</tr>
</tbody>
</table>
<ul>
<li>Is possible to assess probability on allel Leu/Leu
<ul>
<li>cases: <span class="math inline">\(\pi_1=f/(d+e+f)=89/800=11.1\%\)</span></li>
<li>controls:<span class="math inline">\(\pi_0=c/(a+b+c)=56/572=9.8\%\)</span></li>
</ul></li>
<li>Relative risk on exposure for cases versus controls is <span class="math inline">\(11.1/9.8=1.14\)</span>.</li>
<li>The probability on the Leu/Leu genotype is 14% higher for women with breast cancer than for women without borstkanker.</li>
<li>It suggests an association, but it does not let us conclude how much higher the risk is on breast cancer for women with the Leu/Leu genotype as compared to the other women.</li>
<li>Other statistic?</li>
</ul>
<hr />
<p><span class="math display">\[\begin{equation*}
Odds=\frac{p}{1-p}
\end{equation*}\]</span> with <span class="math inline">\(p\)</span> the probability on the event.</p>
<p>Transformation of risk with following properties:</p>
<ul>
<li><p>odds has value between 1 and <span class="math inline">\(\infty\)</span>.</p></li>
<li><p>odds only equals 1 for probability <span class="math inline">\(p=1/2\)</span>.</p></li>
<li><p>de odds increases if probability increases.</p></li>
<li><p>popular in gambling: how much more likely is it to win than to loose</p></li>
</ul>
<hr />
<table>
<thead>
<tr class="header">
<th align="left">Genotype</th>
<th align="left">Controls</th>
<th align="left">Cases</th>
<th align="left">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Pro/Pro</td>
<td align="left">266 (a)</td>
<td align="left">342 (d)</td>
<td align="left">608 (a+d)</td>
</tr>
<tr class="even">
<td align="left">Pro/Leu</td>
<td align="left">250 (b)</td>
<td align="left">369 (e)</td>
<td align="left">619 (b+e)</td>
</tr>
<tr class="odd">
<td align="left">Leu/Leu</td>
<td align="left">56 (c)</td>
<td align="left">89 (f)</td>
<td align="left">145 (c+f)</td>
</tr>
<tr class="even">
<td align="left">Totaal</td>
<td align="left">572 (a+b+c)</td>
<td align="left">800 (d+e+f)</td>
<td align="left">1372 (n)</td>
</tr>
</tbody>
</table>
<p>Odds on allel Leu/Leu</p>
<ul>
<li><p>Cases: <span class="math inline">\(\mbox{odds}_1=\frac{ f/(d+e+f)}{(d+e)/(d+e+f)}=f/(d+e)=89/711=0.125\)</span>. The double Leu/Leu variant is 8 times less likely than other allele combinations in the breast cancer cases</p></li>
<li><p>Controls: <span class="math inline">\(\mbox{odds}_2=c/(a+b)=56/516=0.109\)</span>.</p></li>
<li><p>Association between exposure and outcome: <span class="math display">\[
OR_{Leu/Leu}=\frac{\mbox{odds}_T}{\mbox{odds}_C}= \frac{f/(d+e)}{c/(a+b)}=\frac{f/(d+e)}{c/(a+b)}=1.15
\]</span></p></li>
</ul>
<hr />
<table>
<thead>
<tr class="header">
<th align="left">Genotype</th>
<th align="left">Controls</th>
<th align="left">Cases</th>
<th align="left">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Pro/Pro</td>
<td align="left">266 (a)</td>
<td align="left">342 (d)</td>
<td align="left">608 (a+d)</td>
</tr>
<tr class="even">
<td align="left">Pro/Leu</td>
<td align="left">250 (b)</td>
<td align="left">369 (e)</td>
<td align="left">619 (b+e)</td>
</tr>
<tr class="odd">
<td align="left">Leu/Leu</td>
<td align="left">56 (c)</td>
<td align="left">89 (f)</td>
<td align="left">145 (c+f)</td>
</tr>
<tr class="even">
<td align="left">Totaal</td>
<td align="left">572 (a+b+c)</td>
<td align="left">800 (d+e+f)</td>
<td align="left">1372 (n)</td>
</tr>
</tbody>
</table>
<ul>
<li>If the study would have been a random sample of the population (number of cases and controls not fixed by design) then we would be able to calculate the odds ratio on breast cancer for people with and without the double Leu/leu variant. <span class="math display">\[\begin{equation*}
OR_{case}=\frac{ \frac{ f}{c}}{ \frac{(d+e)}{(a+b)}} = \frac{f(a+b)}{c(d+e)}=OR_{Leu/Leu}=1.15,
\end{equation*}\]</span></li>
<li>OR is a symmetric statistic!</li>
<li>OR on borstcancer can be estimated!</li>
<li>The odds on borstcancer is 15% higher for women with this specific allele combination.</li>
</ul>
<hr />
<ul>
<li><p>Is the difference large enough to generalize the effect in the sample towards the population?</p></li>
<li><p>We will first rewrite the data in a 2x2 table</p></li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">Genotype</th>
<th align="left">Controls</th>
<th align="left">Cases</th>
<th align="left">Totaal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">other</td>
<td align="left">516 (a)</td>
<td align="left">711 (c)</td>
<td align="left">1227 (a+c)</td>
</tr>
<tr class="even">
<td align="left">Leu/Leu</td>
<td align="left">56 (b)</td>
<td align="left">89 (d)</td>
<td align="left">145 (b+d)</td>
</tr>
<tr class="odd">
<td align="left">Total</td>
<td align="left">572 (a+b)</td>
<td align="left">800 (c+d)</td>
<td align="left">1372 (n)</td>
</tr>
</tbody>
</table>
<hr />
</div>
<div id="pearson-chi-square-test-for-independent-samples" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Pearson Chi-square test for independent samples</h2>
<ul>
<li><p>Test association between categorical exposure(e.g. variant, X) en categorical response (e.g. disease, Y). <span class="math display">\[H_0: \text{There is no association between } X \text{ and } Y \text{ vs } H_1: X \text{ and } Y \text{ are associated}\]</span></p></li>
<li><p>Consider row totals <span class="math inline">\(n_\text{other}=a+c\)</span>, <span class="math inline">\(n_\text{leu,leu}=b+d\)</span> and</p></li>
<li><p>column totals <span class="math inline">\(n_\text{contr}=a+b\)</span> en <span class="math inline">\(n_\text{case}=c+d\)</span>.</p></li>
<li><p>They give information on <em>marginal distribution</em> of the exposure (variant, X) and outcome (disease, Y), but not on the association between these variables.</p></li>
<li><p>Under <span class="math inline">\(H_0\)</span> <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent and one expects that <span class="math inline">\((b+d)/n\)</span> of the <span class="math inline">\(a+b\)</span> controls have a Leu/Leu variant, or that <span class="math inline">\((a+b)(b+d)/n\)</span> of them has a Leu/Leu variant</p></li>
<li><p>We can calculate this expected number <span class="math inline">\(E_{ij}\)</span> under the null hypothesis for <em>each cell</em> of the <span class="math inline">\(2 \times 2\)</span> table.</p></li>
</ul>
<hr />
<ul>
<li><p><span class="math inline">\(E_{11}\)</span> = Expected number under <span class="math inline">\(H_0\)</span> in (1,1)-cell = 1227 <span class="math inline">\(\times\)</span> 800/1372 = 715.5 ;</p></li>
<li><p><span class="math inline">\(E_{12}\)</span> = Expected number under <span class="math inline">\(H_0\)</span> in (1,2)-cell = 1227 <span class="math inline">\(\times\)</span> 572/1372 = 511.5 ;</p></li>
<li><p><span class="math inline">\(E_{21}\)</span> = Expected number under <span class="math inline">\(H_0\)</span> in (2,1)-cell = 145 <span class="math inline">\(\times\)</span> 800/1372 = 84.55 ;</p></li>
<li><p><span class="math inline">\(E_{22}\)</span> = Expected number under <span class="math inline">\(H_0\)</span> in (2,2)-cell = 145 <span class="math inline">\(\times\)</span> 572/1372 = 60.45 ;</p></li>
</ul>
<p>Test-statistic: <span class="math display">\[\begin{eqnarray*}
X^2 &amp;=&amp; \frac{\left (|O_{11} - E_{11}| - .5 \right)^2 }{ E_{11}} + \frac{
\left ( |O_{12} - E_{12}| - .5 \right)^2 }{E_{12} }+ \\
&amp;&amp;\quad\quad
\frac{ \left ( |O_{21}
- E_{21}| - .5 \right)^2 }{E_{21}}+ \frac{ \left ( |O_{22} - E_{22}| - .5
\right)^2 }{E_{22} }\\
 X^2 &amp;\stackrel{H_0}{\longrightarrow}&amp; \chi^2(df=1)
\end{eqnarray*}\]</span></p>
<hr />
<p><img src="10-categoricalDataAnalysis_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<hr />
<ul>
<li>A large value of the test statistic gives an indication that the null hypothesis is false.</li>
<li>The test will reject <span class="math inline">\(H_0\)</span> at the <span class="math inline">\(\alpha 100\%\)</span> significance level as soon as the observed test-statistic is larger than the <span class="math inline">\(100\%(1-\alpha)\)</span>-quantile, <span class="math inline">\(\chi^2_{1, \alpha}\)</span>, of the <span class="math inline">\(\chi^2_1\)</span>-distribution.</li>
<li>Otherwise we do not reject <span class="math inline">\(H_0\)</span>.</li>
<li>The p-value of a 2-sided test is the probability to observe a larger test-statistic in a random sample under the null than what we observed in our sample. <span class="math display">\[p=P_0[\chi^2_1 \geq x^2]\]</span>.</li>
</ul>
<hr />
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>expected <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) {</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) {</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    expected[i, j] <span class="ot">&lt;-</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(brcaTab2[i, ]) <span class="sc">*</span> <span class="fu">sum</span>(brcaTab2[, j]) <span class="sc">/</span> <span class="fu">sum</span>(brcaTab2)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>expected</span></code></pre></div>
<pre><code>         [,1]     [,2]
[1,] 715.4519 511.5481
[2,]  84.5481  60.4519</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="fu">abs</span>(brcaTab2 <span class="sc">-</span> expected) <span class="sc">-</span> .<span class="dv">5</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(x2, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>[1] 0.481519</code></pre>
<hr />
<ul>
<li>Because <span class="math inline">\(O_{ij}\)</span> are discrete values, the <span class="math inline">\(X^2\)</span> can only take discrete values and the continuouss <span class="math inline">\(\chi^2_1\)</span>-distribution is only an approximation of the real distribution.</li>
<li>To improve the approximation one substracts 0.5 from the value in each cell: <em>continuity-correction</em></li>
<li>We refer to this test as <em>Pearson Chi-squared test with Yates correction</em>.</li>
<li>When the correction is not used (i.e. when the values of `0.5’ in the estimator <span class="math inline">\(X^2\)</span> are replaced) we use the <em>Pearson Chi-squared test</em>.</li>
</ul>
<hr />
<p>In R you can switch the correction on or off by setting the argument <code>correct</code> on TRUE or FALSE, respectively:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(brcaTab2)</span></code></pre></div>
<pre><code>
    Pearson&#39;s Chi-squared test with Yates&#39; continuity correction

data:  brcaTab2
X-squared = 0.49542, df = 1, p-value = 0.4815</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(brcaTab2, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>
    Pearson&#39;s Chi-squared test

data:  brcaTab2
X-squared = 0.62871, df = 1, p-value = 0.4278</code></pre>
<hr />
<ul>
<li>Even with the <span class="math inline">\(\chi^2_1\)</span> correction the approximation is only valid if non of the cells has an expected count below 5 under <span class="math inline">\(H_0\)</span>.</li>
<li>When the <span class="math inline">\(\chi^2\)</span>-approximation is invalid we will use <em>Fisher’s exact test</em>.</li>
<li>Null hypothesis is also that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent, and, the alternative hypothesis that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are dependent.</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(brcaTab2)</span></code></pre></div>
<pre><code>
    Fisher&#39;s Exact Test for Count Data

data:  brcaTab2
p-value = 0.4764
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.5974269 1.2501878
sample estimates:
odds ratio 
 0.8670925 </code></pre>
<hr />
</div>
<div id="extension-to-categorical-variables-with-multiple-levels" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Extension to categorical variables with multiple levels</h2>
<ul>
<li><p>The <span class="math inline">\(\chi^2\)</span>-test can also be used if one of the categorical variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> has more than 2 levels</p></li>
<li><p>Again: the null hypothesis <span class="math inline">\(H_0\)</span>: <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent (not associated), against the alternative <span class="math inline">\(H_A: X\)</span> and <span class="math inline">\(Y\)</span> are associated.</p></li>
<li><p>Let the variable in the rows have <span class="math inline">\(r\)</span> different possible outcomes and the one in the columns <span class="math inline">\(c\)</span> possible outcomes, then we obtain an <span class="math inline">\(r \times c\)</span> table.</p></li>
<li><p>Again we will compare the observed values in cell <span class="math inline">\((i,j)\)</span>, referred to as <span class="math inline">\(O_{ij}\)</span>, with the expected number under <span class="math inline">\(H_0\)</span>, <span class="math inline">\(E_{ij}\)</span></p></li>
<li><p>Again <span class="math inline">\(E_{ij}\)</span> is the product of the <span class="math inline">\(i^\text{th}\)</span> row-total and the <span class="math inline">\(j^\text{th}\)</span> column total devided by the overall total.</p></li>
</ul>
<p><span class="math display">\[\begin{equation*}
X^2 = \sum_{ij} \frac{\left (O_{ij} - E_{ij}\right)^2 }{ E_{ij}}
\end{equation*}\]</span></p>
<hr />
<ul>
<li>We can show that the statistic follows a <span class="math inline">\(\chi^2\)</span> distribution with <span class="math inline">\((r-1) \times (c-1)\)</span> degrees of freedom under <span class="math inline">\(H_0\)</span>.</li>
<li>No continuity correction</li>
<li><strong>Pearson <span class="math inline">\(\chi^2\)</span> test</strong> is analogon of one-way ANOVA for qualitative variables.</li>
</ul>
<hr />
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>brcaTab <span class="ot">&lt;-</span> <span class="fu">table</span>(brca<span class="sc">$</span>variant, brca<span class="sc">$</span>cancer)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(brcaTab)</span></code></pre></div>
<pre><code>
    Pearson&#39;s Chi-squared test

data:  brcaTab
X-squared = 2.0551, df = 2, p-value = 0.3579</code></pre>
<ul>
<li>To assess if the variant of the BRCA1 gene is associated with breast cancer we conducted a Pearson <span class="math inline">\(\chi^2\)</span>test for the <span class="math inline">\(3 \times 2\)</span> table.</li>
<li>The statistic is now 2.055 and follows a <span class="math inline">\(\chi^2\)</span> distribution with 2 degrees of freedom under <span class="math inline">\(H_0\)</span>. The probability to obtain a <span class="math inline">\(\chi^2\)</span>-test statistic in a random sample under <span class="math inline">\(H_0\)</span> that is more extreme than 2.055, is 36%.</li>
<li>On the 5% level of significance we conclude that the variant of the BRCA-gene is not associated with breast cancer.</li>
</ul>
<hr />
</div>
</div>
<div id="logistic-regression" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Logistic regression</h1>
<ul>
<li><p>Framework to model binary data (e.g cancer vs no cancer): <em>logistic regression model</em>.</p></li>
<li><p>Model binary data with continuous and/or dummy variables.</p></li>
<li><p>The model assumes that observations for subject <span class="math inline">\(i=1,\ldots,n\)</span> are independent and follow a Bernoulli distribution.</p></li>
<li><p>The logarithm of the odds is modelled using a linear model, also referred to as linear predictor: <span class="math display">\[\begin{equation}
\left\{
\begin{array}{ccl}
Y_i&amp;\sim&amp;B(\pi_i)\\\\
\log \frac{\pi_i}{1-\pi_i}&amp;=&amp;\beta_0 + \beta_1X_{i1} + \ldots + \beta_p X_{ip}
\end{array}\right.
\end{equation}\]</span></p></li>
</ul>
<hr />
<div id="categorical-predictor" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Categorical predictor</h2>
<ul>
<li><p>breast cancer example: is BRCA 1 variant associated with breast cancer.</p></li>
<li><p>As in the Anova context, a factor in logistic regression is coded using dummy variables.</p></li>
<li><p>1 dummy variable less than the number of groups.</p></li>
<li><p>For BRCA 1 we need two dummy variables and obtain the following linear predictor:</p></li>
</ul>
<p><span class="math display">\[\begin{eqnarray*}
  \log \frac{\pi_i}{1-\pi_i} &amp;=&amp; \beta_0+\beta_1 x_{i1} +\beta_2 x_{i2}
\end{eqnarray*}\]</span></p>
<ul>
<li><p>with : <span class="math display">\[x_{i1} = \left\{ \begin{array}{ll}
1 &amp; \text{ if subject $i$ is heterozygous, Pro/Leu variant} \\
0 &amp; \text{if subject $i$ is homozygous, (Pro/Pro or Leu/Leu variant)} \end{array}\right. .\]</span> <span class="math display">\[x_{i2} = \left\{ \begin{array}{ll}
1 &amp; \text{ if subject $i$ is homozygous is the Leucine mutation: Leu/Leu } \\
0 &amp; \text{ of subject $i$ is not homozygous in the Leu/Leu variant} \end{array}\right. .\]</span></p></li>
<li><p>Homozygosity in the wild type allele Pro/Pro is the <strong>reference group</strong>.</p></li>
</ul>
<hr />
<p>We fit the model in R.</p>
<ul>
<li>Note that we use the function <code>as.factor</code> to convert the cancer variable to a factor variable. - We further use the function <code>relevel</code> to specify the control treatment as the reference group.</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>brca<span class="sc">$</span>cancer <span class="ot">&lt;-</span> brca<span class="sc">$</span>cancer <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relevel</span>(<span class="st">&quot;control&quot;</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>brca<span class="sc">$</span>variant <span class="ot">&lt;-</span> brca<span class="sc">$</span>variant <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relevel</span>(<span class="st">&quot;pro/pro&quot;</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>brcaLogit <span class="ot">&lt;-</span> <span class="fu">glm</span>(cancer <span class="sc">~</span> variant, <span class="at">data =</span> brca, <span class="at">family =</span> binomial)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(brcaLogit)</span></code></pre></div>
<pre><code>
Call:
glm(formula = cancer ~ variant, family = binomial, data = brca)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-1.379  -1.286   1.017   1.017   1.073  

Coefficients:
               Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)     0.25131    0.08175   3.074  0.00211 **
variantleu/leu  0.21197    0.18915   1.121  0.26243   
variantpro/leu  0.13802    0.11573   1.193  0.23302   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1863.9  on 1371  degrees of freedom
Residual deviance: 1861.9  on 1369  degrees of freedom
AIC: 1867.9

Number of Fisher Scoring iterations: 4</code></pre>
<p>The intercept is the log-odds on cancer in the reference class (Pro/Pro) and the slope terms are log odds ratios between treatment and reference class: <span class="math display">\[\begin{eqnarray*}
\log \text{ODDS}_\text{Pro/Pro}&amp;=&amp;\beta_0\\\\
\log \text{ODDS}_\text{Pro/Leu}&amp;=&amp;\beta_0+\beta_1\\\\
\log \text{ODDS}_\text{Leu/Leu}&amp;=&amp;\beta_0+\beta_2\\\\
\log  \frac{\text{ODDS}_\text{Pro/Leu}}{\text{ODDS}_\text{Pro/Pro}}&amp;=&amp;\log \text{ODDS}_\text{Pro/Leu}-\log ODDS_{Pro/Pro}\\
&amp;=&amp;\beta_0+\beta_1-\beta_0=\beta_1\\\\
\log  \frac{\text{ODDS}_\text{Leu/Leu}}{\text{ODDS}_\text{Pro/Pro}}&amp;=&amp;\beta_2
\end{eqnarray*}\]</span></p>
<ul>
<li>The analysis allows us to interpret the result immediately in oddses and odds ratios!</li>
</ul>
<hr />
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(brcaLogit, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Resid. Df"],"name":[3],"type":["int"],"align":["right"]},{"label":["Resid. Dev"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"NA","3":"1371","4":"1863.930","5":"NA","_rn_":"NULL"},{"1":"2","2":"2.05616","3":"1369","4":"1861.874","5":"0.3576931","_rn_":"variant"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The <span class="math inline">\(\chi^2\)</span>-test on the logsitic regression model also indicates that there is no significant association between cancer status and the genetic variant of the BRCA gene (<span class="math inline">\(p=\)</span> 0.358). De p-value is almost equivalent to the one of the <span class="math inline">\(\chi^2\)</span>-test (see previous section).</p>
<hr />
<ul>
<li><p>Significant association?</p>
<ul>
<li>Post-hoc tests to evaluate which of the odds ratios are different from 1.</li>
<li>For BRCA1 example we did not reject the omnibus hypothesis so no post-hoc analysis</li>
<li>For your reference we include the post hoc analysis so that you would have the code.</li>
</ul></li>
</ul>
<hr />
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(multcomp)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>posthoc <span class="ot">&lt;-</span> <span class="fu">glht</span>(brcaLogit, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">variant =</span> <span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>posthocTests <span class="ot">&lt;-</span> <span class="fu">summary</span>(posthoc)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>posthocTests</span></code></pre></div>
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: glm(formula = cancer ~ variant, family = binomial, data = brca)

Linear Hypotheses:
                       Estimate Std. Error z value Pr(&gt;|z|)
leu/leu - pro/pro == 0  0.21197    0.18915   1.121    0.493
pro/leu - pro/pro == 0  0.13802    0.11573   1.193    0.449
pro/leu - leu/leu == 0 -0.07395    0.18922  -0.391    0.917
(Adjusted p values reported -- single-step method)</code></pre>
<hr />
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>posthocCI <span class="ot">&lt;-</span> <span class="fu">confint</span>(posthoc)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>posthocCI</span></code></pre></div>
<pre><code>
     Simultaneous Confidence Intervals

Multiple Comparisons of Means: Tukey Contrasts


Fit: glm(formula = cancer ~ variant, family = binomial, data = brca)

Quantile = 2.3253
95% family-wise confidence level
 

Linear Hypotheses:
                       Estimate lwr      upr     
leu/leu - pro/pro == 0  0.21197 -0.22785  0.65179
pro/leu - pro/pro == 0  0.13802 -0.13108  0.40713
pro/leu - leu/leu == 0 -0.07395 -0.51393  0.36604</code></pre>
<ul>
<li>With the <code>confint</code> function CI are obtained on the log-odds ratios corrected for multiple testing.</li>
</ul>
<hr />
<ul>
<li>CI’s can be backtransformed to odds ratios:</li>
</ul>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>OR <span class="ot">&lt;-</span> <span class="fu">exp</span>(posthocCI<span class="sc">$</span>confint)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>OR</span></code></pre></div>
<pre><code>                   Estimate       lwr      upr
leu/leu - pro/pro 1.2361111 0.7962430 1.918975
pro/leu - pro/pro 1.1480000 0.8771438 1.502495
pro/leu - leu/leu 0.9287191 0.5981379 1.442007
attr(,&quot;conf.level&quot;)
[1] 0.95
attr(,&quot;calpha&quot;)
[1] 2.325291</code></pre>
<ul>
<li><p>De odds ratios that we obtain is exactly equal to the one we calculated based on the contingency table:</p></li>
<li><p>e.g <span class="math inline">\(\text{OR}_\text{Leu/Leu-Pro/Pro}=89\times 266/(56\times 342)=\)</span> 1.236.</p></li>
<li><p>Note, that statistical inference for logistic regression relies on asymptotic theory.</p></li>
</ul>
<hr />
</div>
<div id="continuous-predictor" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Continuous Predictor</h2>
<ul>
<li>Toxicolocal effect of carbon disulfite (CS<span class="math inline">\(_2\)</span>) on beetles.</li>
<li>Research hypothesis is there an effect of the CS<span class="math inline">\(_2\)</span> concentration on the mortality of beetles?</li>
</ul>
<p>Design:</p>
<ul>
<li>32 independent experiments</li>
<li>Each time 1 beatle is exposed to one of 8 CS<span class="math inline">\(_2\)</span> concentrations (mg/l).</li>
<li>The outcome: mortality (<span class="math inline">\(y=1\)</span>) or survival (<span class="math inline">\(y=0\)</span>).</li>
</ul>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>beetles <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/GTPB/PSLS20/master/data/beetles.csv&quot;</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(beetles)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["dose"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["status"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"169.07","2":"1"},{"1":"169.07","2":"0"},{"1":"169.07","2":"0"},{"1":"169.07","2":"0"},{"1":"172.42","2":"1"},{"1":"172.42","2":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(beetles<span class="sc">$</span>dose, beetles<span class="sc">$</span>status)</span></code></pre></div>
<pre><code>        
         0 1
  169.07 3 1
  172.42 3 1
  175.52 3 1
  178.42 2 2
  181.13 1 3
  183.69 0 4
  186.1  0 4
  188.39 0 4</code></pre>
<hr />
<p>We build a model for the log odds in function of the dose <span class="math inline">\(x_i\)</span>: <span class="math display">\[\log \frac{\pi_i}{1-\pi_i}=\beta_0+\beta_1 \times x_i.\]</span></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>beatleModel <span class="ot">&lt;-</span> <span class="fu">glm</span>(status <span class="sc">~</span> dose, <span class="at">data =</span> beetles, <span class="at">family =</span> binomial)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(beatleModel)</span></code></pre></div>
<pre><code>
Call:
glm(formula = status ~ dose, family = binomial, data = beetles)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.7943  -0.7136   0.2825   0.5177   2.1670  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept) -53.1928    18.0046  -2.954  0.00313 **
dose          0.3013     0.1014   2.972  0.00296 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 42.340  on 31  degrees of freedom
Residual deviance: 26.796  on 30  degrees of freedom
AIC: 30.796

Number of Fisher Scoring iterations: 5</code></pre>
<hr />
<ul>
<li><p>Intercept has an interpretation of a log odds on mortality when no <span class="math inline">\(\text{CS}_2\)</span> gas is applied.</p></li>
<li><p>Very small odds on mortality (<span class="math inline">\(\pi/(1-\pi)=\exp(-53.2)\)</span>) so the probability is almost 0.</p></li>
<li><p>Note that this is a very large extrapolation: minimum dose in dataset is 169.07 mg/l.</p></li>
<li><p>Estimated odds ratio for the effect of dose on the mortality probability is <span class="math inline">\(\exp(0.3013)=1.35\)</span>.</p></li>
<li><p>So a beatle exposed to a CS<span class="math inline">\(_2\)</span> concentration that is 1 mg/l larger than another beatle, will on average have an odds ratio on mortality of <span class="math inline">\(1.35\)</span>.</p></li>
</ul>
<hr />
<ul>
<li>We conclude that this effect is very significant (<span class="math inline">\(p=\)</span> 0.003).</li>
<li>Increasing the CS<span class="math inline">\(_2\)</span> dose increases the mortality.</li>
</ul>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>beetlesTab <span class="ot">&lt;-</span> <span class="fu">table</span>(beetles) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">grid =</span> <span class="fu">seq</span>(<span class="fu">min</span>(beetles<span class="sc">$</span>dose), <span class="fu">max</span>(beetles<span class="sc">$</span>dose), .<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">piHat =</span> <span class="fu">predict</span>(beatleModel,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">dose =</span> grid),</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;response&quot;</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(grid, piHat)) <span class="sc">+</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;dose&quot;</span>) <span class="sc">+</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;probability (dead)&quot;</span>) <span class="sc">+</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> dose <span class="sc">%&gt;%</span> <span class="fu">as.character</span>() <span class="sc">%&gt;%</span> <span class="fu">as.double</span>(), <span class="at">y =</span> status <span class="sc">%&gt;%</span> <span class="fu">as.character</span>() <span class="sc">%&gt;%</span> <span class="fu">as.double</span>(), <span class="at">label =</span> Freq), beetlesTab <span class="sc">%&gt;%</span> <span class="fu">filter</span>(status <span class="sc">==</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> dose <span class="sc">%&gt;%</span> <span class="fu">as.character</span>() <span class="sc">%&gt;%</span> <span class="fu">as.double</span>(), <span class="at">y =</span> status <span class="sc">%&gt;%</span> <span class="fu">as.character</span>() <span class="sc">%&gt;%</span> <span class="fu">as.double</span>(), <span class="at">label =</span> Freq), beetlesTab <span class="sc">%&gt;%</span> <span class="fu">filter</span>(status <span class="sc">==</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="10-categoricalDataAnalysis_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiMTAuIENhdGVnb3JpY2FsIERhdGEgQW5hbHlzaXMiCmF1dGhvcjogIkxpZXZlbiBDbGVtZW50IgpkYXRlOiAic3RhdE9taWNzLCBHaGVudCBVbml2ZXJzaXR5IChodHRwczovL3N0YXRvbWljcy5naXRodWIuaW8pIgotLS0KCjxhIHJlbD0ibGljZW5zZSIgaHJlZj0iaHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMCI+PGltZyBhbHQ9IkNyZWF0aXZlIENvbW1vbnMgTGljZW5zZSIgc3R5bGU9ImJvcmRlci13aWR0aDowIiBzcmM9Imh0dHBzOi8vaS5jcmVhdGl2ZWNvbW1vbnMub3JnL2wvYnktbmMtc2EvNC4wLzg4eDMxLnBuZyIgLz48L2E+CgpgYGB7ciBzZXR1cCwgaW5jbHVkZT1GQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGluY2x1ZGUgPSBUUlVFLCBjb21tZW50ID0gTkEsIGVjaG8gPSBUUlVFLAogIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFLCBjYWNoZSA9IFRSVUUKKQpgYGAKCmBgYHtyIGxpYnJhcmllc30KbGlicmFyeShSbWlzYykKbGlicmFyeSh0aWR5dmVyc2UpCmxpYnJhcnkoTkhBTkVTKQpgYGAKCgoKIyBJbnRyb2R1Y3Rpb24KClVudGlsIG5vdyB3ZSB1c2VkIG1vZGVscyBmb3IgYSBjb250aW51b3VzIHJlc3BvbnNlIGluIGZ1bmN0aW9uIG9mIGNhdGVnb3JpY2FsIG9yIGNvbnRpbnVvdXMgcHJlZGljdG9yLiBIZXJlIHdlIHdpbGwgZm9jdXMgb24gYSBjYXRlZ29yaWNhbCByZXNwb25zZS4KCi0gd2Ugc3R1ZHkgdGhlIGFzc29jaWF0aW9uIG9mIGEgY2F0ZWdvcmljYWwgb3V0Y29tZSBhbmQgYSBjYXRlZ29yaWNhbCBwcmVkaWN0b3IgYW5kCi0gdG91Y2ggdXBvbiBtZXRob2RzIHRvIG1vZGVsIGEgY2F0ZWdvcmljYWwgb3V0Y29tZSB3aXRoIGEgY29udGludW91cyByZXNwb25zZS4KCgotLS0KCiMgVGVzdCBmb3IgYSBwcm9wb3J0aW9uCgojIyBTYWtzZW4tc3R1ZHkKCi0gRmFpcmx5IGNsb3NlZCBwb3B1bGF0aW9uIChmZXcgbWlncmF0aW9uKQotIFByb2JhYmlsaXR5IHRoYXQgYW4gdW5ib3JuIGNoaWxkIGlzIG1hbGU/CgpgYGB7cn0KYm95cyA8LSAzMTc1Cm4gPC0gNjE1NQpgYGAKCi0gT24gYHIgbmAgdW5ib3JuIGNoaWxkcmVuIGByIGJveXNgIGJveXMgYXJlIG9ic2VydmVkLgotIElzIHRoZXJlIGEgZGlmZmVyZW5jZSBpbiB0aGUgcHJvYmFiaWxpdHkgb24gdGhlIGdlbmRlciBvZiBhbiB1bmJvcm4gY2hpbGQ/CgotLS0KCi0gVGhlIGRhdGEgYXJlIGRlcml2ZWQgZnJvbSBhIGJpbmFyeSByYW5kb20gdmFyaWFibGUgJFgkCgogIC0gJFg9MSQgZm9yIGEgYm95IGFuZAogIC0gJFg9MCQgZm9yIGEgZ2lybC4KCi0gTm90ZTogY291bnQgcHJvYmxlbTogdGhlIG91dGNvbWUgaXMgYSBjb3VudCAobnVtYmVyIG9mIGJveXMpCgotIEZvcm1hbGx5IHdlIGhhdmUgY29uc2lkZXJlZCBhIHBvcHVsYXRpb24gb2YgdW5ib3JuIGNoaWxkcmVuIHdoZXJlIGVhY2ggaW5kaXZpZHVhbCBpcyBjaGFyYWN0ZXJpemVkIGJ5IGEgMCBvciAxLgoKLS0tCgojIyBCZXJub3VsbGkgUHJvYmFiaWxpdHkgTWFzcyBEaXN0cmlidXRpb24KCi0gQmluYXJ5IGRhdGEgY2FuIGJlIG1vZGVsbGVkIHVzaW5nIGEgQmVybm91bGxpIGRpc3RyaWJ1dGlvbjoKICBcYmVnaW57ZXFuYXJyYXkqfQpYX2kgJlxzaW0mIEIoXHBpKSBcdGV4dHsgd2l0aH1cXApCKFxwaSkmPSZccGlee1hfaX0oMS1ccGkpXnsoMS1YX2kpfSwKXGVuZHtlcW5hcnJheSp9CgotIEl0IGhhcyBvbmUgbW9kZWwgcGFyYW1ldGVyICRccGkkCgogICAgLSBFeHBlY3RlZCB2YWx1ZSBvZiAkWF9pJDogJFx0ZXh0e0V9W1hfaV09XHBpLCQKICAgIC0gUHJvcG9ydGlvbiBvZiB1bmJvcm4gYm95cyAoY2hpbGRyZW4gd2l0aCAkWD0xJCkgaW4gdGhlIHBvcHVsYXRpb24uCiAgICAtIEhlbmNlICRccGkkIGlzIHRoZSBwcm9iYWJpbGl0eSB0aGF0IGEgcmFuZG9tIGluZGl2aWR1YWwgZnJvbSB0aGUgcG9wdWxhdGlvbiBpcyBhIGJveSAoYW4gb2JzZXJ2YXRpb24gd2l0aCAkWD0xJCkuCgotIFRoZSB2YXJpYW5jZSBvZiBCZXJub3VsbGkgZGF0YSBpcyBhbHNvIHJlbGF0ZWQgdG8gJFxwaSQuCiQkXHRleHR7VmFyfVtYX2ldPVxwaSAoMS1ccGkpLiQkCgotLS0KClNvbWUgQmVybm91bGxpIHByb2JhYmlsaXR5IG1hc3MgZnVuY3Rpb25zCgpgYGB7ciwgb3V0LndpZHRoPScxMDAlJywgZmlnLmFzcD0xLCBmaWcuYWxpZ249J2NlbnRlcicsZWNobz1GQUxTRX0KcGFyKG1mcm93ID0gYygxLCAzKSwgcHR5ID0gInMiKQpwcm9icyA8LSBjKDAuMjUsIC41LCAuNzUpCmZvciAoaSBpbiAxOmxlbmd0aChwcm9icykpCnsKICBwbG90KGMoMCwgMSksIGMoMSAtIHByb2JzW2ldLCBwcm9ic1tpXSksIHlsaW0gPSBjKDAsIDEpLCB0eXBlID0gImgiLCB4YXh0ID0gIm4iLCB4bGFiID0gIlgiLCB5bGFiID0gIlByb2JhYmlsaXR5IiwgbWFpbiA9IGFzLmV4cHJlc3Npb24oc3Vic3RpdHV0ZShwaSA9PSB2YWwsIGxpc3QodmFsID0gcHJvYnNbaV0pKSksIGx3ZCA9IDMpCiAgYXhpcygxLCBhdCA9IGMoMCwgMSkpCn0KYGBgCgotLS0KCi0gSW4gdGhlIFNha3NlbiBzdHVkeSAgNjE1NSBvYnNlcnZhdGllcyB3ZXJlIHNhbXBsZWQgYXQgcmFuZG9tIGZyb20gdGhlIHBvcHVsYXRpb24uCi0gV2UgY2FuIGVzdGltYXRlICRccGkkICB1c2luZyB0aGUgc2FtcGxlIG1lYW46CiQkXGhhdCBccGkgPSBcYmFyIFggPSBcZnJhY3tcc3VtXGxpbWl0c197aT0xfV5uIFhfaX17bn0sJCQKCmBgYHtyfQpwaSA8LSBib3lzIC8gbgpwaQpgYGAKCkluIG91ciBleGFtcGxlICRcYmFyIHggPSQgYHIgYm95c2AgLyBgciBuYCA9IGByIGZvcm1hdChwaSoxMDAsZGlnaXRzPTMpYCUuCgotLS0KCiMjIEJpbm9taWFsZSB0ZXN0CgotIElzIHRoZSBvYnNlcnZlZCBwcm9iYWJpbGl0eSBgciBmb3JtYXQocGkqMTAwLGRpZ2l0PTMpYCUgdGhhdCBhbiB1bmJvcm4gY2hpbGQgaXMgbWFsZSwgc3VmZmljaWVudCBldmlkZW5jZSB0byBjb25jbHVkZSB0aGF0IHRoZXJlIGlzIGEgaGlnaGVyIGNoYW5jZSBvbiBhIGJveSB0aGFuIG9uIGEgZ2lybD8KCi0gU3RhdGlzdGljYWwgdGVzdCBmb3IKICAkJEhfMDogXHBpPTEvMiBcdGV4dHsgdmVyc3VzIH0gSF8xOiBccGlcbmVxIDEvMiwkJAoKLSBXZSBuZWVkIGtub3duIHRoZSBkaXN0cmlidXRpb24gb2YKCiAgICAtICRYJCBhbmQgJFxiYXIgWCQKICAgIC0gb3Igb2YgdGhlIHN1bSAkUz1uXGJhciBYJC4KCi0tLQoKCi0gU3VwcG9zZSB0aGF0ICRIXzA6XHBpPTEvMiQgaXMgdHJ1ZSAoYm95cyBhbmQgZ2lybHMgaGF2ZSBhbiBlcXVhbCBmcmVxdWVuY3kgaW4gdGhlIHBvcHVsYXRpb24pCi0gQSByYW5kb20gaW5kaXZpZHVhbCBmcm9tIHRoZSBwb3B1bGF0aW9uIGhhcyBhIHByb2JhYmlsaXR5IG9mICQkUChYPTEpPVxwaT0xLzIuJCQgdG8gYmUgYSBib3kKCi0gVHdvIGNoaWxkcmVuIHRoYXQgYXJlIGRyYXduIGluZGVwZW5kZW50bHkgOgoKICAgIC0gUHJvYmFiaWxpdHkgb2YgJFxwaT0xLzIkIG9uIGEgYm95IGZvciB0aGUgZmlyc3QgYW5kIHNlY29uZCBjaGlsZCAoaW5kZXBlbmRlbnQgZnJvbSBlYWNoIG90aGVyKQogICAgLSBPdXRjb21lcyAkKHhfMSwgeF8yKSQgZm9yIGJvdGggY2hpbGRyZW4gaGF2ZSA0IHBvc3NpYmxlIGNvbWJpbmF0aW9uczoKICAgICQoMCwwKSwoMCwxKSwoMSwwKVx0ZXh0eyBlbiB9KDEsMSkuJAogICAgLSBFYWNoIG9mIHRoZW0gaGFzIGEgcHJvYmFiaWxpdHkgb2YgJDEvNCA9IDEvMiBcdGltZXMgMS8yJC4KCi0gUmFuZG9tIHZhcmlhYmxlICRTJCBpcyB0aGUgc3VtIG9mIHRoZSBvdXRjb21lcyA6CgokKHhfMSx4XzIpJHwkcyR8JFAoUyA9IHMpJHwKfDotLS06fDotLS06fDotLS06fAooMCwwKXwwfDEvNHwKKDAsMSksICgxLDApfDF8MS8yfAooMSwxKXwyfDEvNHwKCi0tLQoKIyMjIEdlbmVyYWw6ICRuJCBpbmRlcGVuZGVudCBzYW1wbGVzCgotIFByb2JhYmlsaXR5IGZvciAkXHBpJCBvbiBzdWNjZXNzICgkWD0xJCkKLSBUb3RhbCBudW1iZXIgb2Ygc3VjY2Vzc2VzICRTJCAoc3VtIG9mIGFsbCB2YWx1ZXMgb2YgMSkgY2FuIHRha2UgJG4rMSQgcG9zc2libGUgdmFsdWVzCiAgJCRTPWtcdGV4dHssIG1ldCB9az0wLFxsZG90cyxuJCQKLSBEaXN0cmlidXRpb24gb2YgJFMkPwpcYmVnaW57ZXF1YXRpb259ClAoUz1rKSA9IFxsZWZ0ICgKXGJlZ2lue2FycmF5fXtjfQpuIFxcCmsgXFwKXGVuZHthcnJheX0KXHJpZ2h0ICkgXHBpXmsgKDEtXHBpKV57bi1rfQpcZW5ke2VxdWF0aW9ufQotICQxLVxwaSQ6IHByb2JhYmlsaXR5IG9uIDAgZm9yIGluZGl2aWR1YWwgb2JzZXJ2YXRpb24gYW5kCi0gIGJpbm9taWFsIGNvZWZmaWNpZW50ClxiZWdpbntlcXVhdGlvbip9ClxsZWZ0ICgKXGJlZ2lue2FycmF5fXtjfQpuIFxcCmsgXFwKXGVuZHthcnJheX0KXHJpZ2h0ICkgPSBcZnJhY3tuIFx0aW1lcyAobi0xKSBcdGltZXMgLi4uXHRpbWVzIChuLWsrMSkgfXsgayF9ID0gXGZyYWN7IG4hfXsgayEobi1rKSEgfQpcZW5ke2VxdWF0aW9uKn0KCi0gSW4gUiB5b3UgY2FuIGNhbGN1bGF0ZSB0aGUgcHJvYmFiaWxpdGllcyBvbiBlYWNoICRTPWskIHdpdGggdGhlIGZ1bmN0aW9uIGBkYmlub20oayxuLHApYAoKCi0tLQoKIyMjIEJpbm9taWFsIERpc3RyaWJ1dGlvbgoKUyBpcyBhOgoKLSAgKkJpbm9taWFsIGRpc3RyaWJ1dGVkIHJhbmRvbSAgdmFyaWFibGUqIHdpdGggKkJpbm9taWFsIHByb2JhYmlsaXR5IG1hc3MgZnVuY3Rpb24qCgotIFBhcmFtZXRlcnMKCiAgICAtICRuJCAodG90YWwgbnVtYmVyIG9mIGRyYXdzIGZyb20gdGhlIHBvcHVsYXRpb24sIGlzIGVxdWl2YWxlbnQgdG8gbWF4aW1hbCB2YWx1ZSBvZiB0aGUgb3V0Y29tZSkKICAgIC0gJFxwaSQgKHByb2JhYmlsaXR5IG9uIGBzdWNjZXNzYCBmb3IgZWFjaCBkcmF3KS4KCi0gQ2FsY3VsYXRlIHByb2JhYmlsaXR5IG9uICRrJCBzdWNjZXNzZXMgb24gJG4kIGluZGVwZW5kZW50IGRyYXdzIGVhY2ggd2l0aCBhIHN1Y2NlcyBwcm9iYWJpbGl0eSBvZiAkXHBpJC4KLSBGb3IgYmluYXJ5IGRhdGEgWC4KLSBlLmcuOiB3aWxkIHR5cGUgdnMgbXV0YW50IG9mIGEgZ2VuZSwgaW5mZWN0ZWQgb3Igbm90IGluZmVjdGVkIHdpdGggSElWLCAuLi4KLSBVc2U6IENvbXBhcmUgcHJvcG9ydGlvbnMgb3Igcmlza3Mgb24gYSBwYXJ0aWN1bGFyIGV2ZW50IGJldHdlZW4gZ3JvdXBzLgoKLS0tCgojIyMgU29tZSBCaW5vbWlhbCBwcm9iYWJpbGl0eSBtYXNzIGZ1bmN0aW9ucy4KCmBgYHtyIGJpbm9tcyxmaWcuY2FwPSdCaW5vbWlhbGUgdmVyZGVsaW5nZW4uJywgb3V0LndpZHRoPSc4MCUnLCBmaWcuYXNwPS44LCBmaWcuYWxpZ249J2NlbnRlcicsZWNobz1GQUxTRX0KcGFyKG1mcm93ID0gYygyLCAyKSkKcHJvYnMgPC0gYygwLjI1LCAuNSwgLjc1KQpmb3IgKGkgaW4gMTpsZW5ndGgocHJvYnMpKQp7CiAgcGxvdCgwOjEwLCBkYmlub20oMDoxMCwgcHJvYiA9IHByb2JzW2ldLCBzaXplID0gMTApLCB5bGltID0gYygwLCAxKSwgdHlwZSA9ICJoIiwgeGxhYiA9ICJYIiwgeWxhYiA9ICJLYW5zIChEaWNodGhlaWQpIiwgbWFpbiA9IGFzLmV4cHJlc3Npb24oc3Vic3RpdHV0ZShwaSA9PSB2YWwsIGxpc3QodmFsID0gcGFzdGUocHJvYnNbaV0sICIsIG5vYnM9MTAiKSkpKSwgbHdkID0gMykKfQpwbG90KDI5MjU6MzIyNSwgZGJpbm9tKDI5MjU6MzIyNSwgcHJvYiA9IC41LCBzaXplID0gbiksIHR5cGUgPSAiaCIsIHhsYWIgPSAiWCIsIHlsYWIgPSAiS2FucyAoRGljaHRoZWlkKSIsIG1haW4gPSBhcy5leHByZXNzaW9uKHN1YnN0aXR1dGUocGkgPT0gdmFsLCBsaXN0KHZhbCA9IHBhc3RlMCgiMC41LCBub2JzPSIsIG4pKSkpKQpgYGAKCi0tLQoKVGVzdCBzdGF0aXN0aWMgJCRIXzA6XHBpPTEvMlx0ZXh0eyB2cyB9SF8xOlxwaVxuZXEgMS8yJCQKCgotICRcYmFyIFgtMS8yJCBvciwgZXF1aXZhbGVudCwKLSAkXERlbHRhPW4oXGJhciBYLVxwaV8wKT1TLXNfMCQuCi0gRGlzdHJpYnV0aW9uIG9mIHRoZSBsYXR0ZXIgdGVzdCBzdGF0aXN0aWMgY2FuIGJlIGRlcml2ZWQgaW1tZWRpYXRlbHkgZnJvbSB0aGUgQmlub21pYWwgZGlzdHJpYnV0aW9uOgogIC0gV2Ugb2JzZXJ2ZSAkcz0kIGByIGJveXNgIGFuZCB0aHVzICRcZGVsdGE9cy1zXzA9JCBgciBib3lzYCAkLSQgYHIgbmAgJFx0aW1lcyAwLjU9JCBgciBib3lzLW4vMmAuCiAgLSBXaGVuIGJveXMgYW5kIGdpcmxzIGFyZSBlcXVhbGx5IGxpa2VseSwgaS5lLiB1bmRlciAkSF8wOlxwaT0xLzIkLCB3ZSB3aWxsIGdldCBmb2xsb3dpbmcgdHdvLXNpZGVkIHAtdmFsdWU6CiAgICAkJHA9XHRleHR7UH1fMFxsZWZ0W1Mtc18wXGdlcSBcdmVydCBcZGVsdGFcdmVydCBccmlnaHRdICsgXHRleHR7UH1fMFxsZWZ0W1Mtc18wXGxlcSAtIFx2ZXJ0IFxkZWx0YVx2ZXJ0IFxyaWdodF0uJCQKCi0gTm90ZSwgdGhhdCB3ZSBjYW4gcmV3cml0ZSBpdCBpbiB0ZXJtcyBvZiBTLgokJHA9XHRleHR7UH1fMFxsZWZ0W1NcZ2VxIHNfMCsgXHZlcnQgXGRlbHRhXHZlcnQgXHJpZ2h0XSArIFx0ZXh0e1B9XzBcbGVmdFtTIFxsZXEgc18wIC0gXHZlcnQgXGRlbHRhXHZlcnQgXHJpZ2h0XS4kJAoKLS0tCgotIEZvciB0aGUgU2Frc2VuIHN0dWR5IHdlIGNhbGN1bGF0ZToKClxiZWdpbntlcW5hcnJheSp9Clx0ZXh0e1B9XzBcbGVmdFtTXGdlcSBzXzArIFx2ZXJ0IFxkZWx0YVx2ZXJ0IFxyaWdodF0gJj0mIFAoUyBcZ2VxIDYxNTUgXHRpbWVzIDAuNSArIFx2ZXJ0IDMxNzUgLSA2MTU1IFx0aW1lcyAwLjVcdmVydCApIFxcJj0mIFAoUyBcZ2VxIDMxNzUpXFwKJj0gJlAoUz0gMzE3NSkgKyBQKFM9MzE3NikgKyAuLi4gKyBQKFM9NjE1NSlcXAomID0mIDAuMDA2N1xcXFwKXHRleHR7UH1fMFxsZWZ0W1MgXGxlcSBzXzAgLSBcdmVydCBcZGVsdGFcdmVydCBccmlnaHRdICY9JiBQKFMgXGxlcSAgNjE1NSBcdGltZXMgMC41IC0gXHZlcnQgMzE3NS0gNjE1NSBcdGltZXMgMC41XHZlcnQpIFxcJj0mIFAoUyBcbGVxIDI5ODApXFwgJj0gJlAoUz0wKSArIC4uLiArIFAoUz0yOTgwKSBcXAomPSYwLjAwNjcKXGVuZHtlcW5hcnJheSp9CgotIFRoZSBCaW5vbWlhbCBkaXN0cmlidXRpb24gaXMgc3ltbWV0cmljIGZvciRccGk9MS8yJDoKJCRcdGV4dHtQfV8wXGxlZnRbU1xnZXEgc18wKyBcdmVydCBcZGVsdGFcdmVydCBccmlnaHRdID0gXHRleHR7UH1fMFxsZWZ0W1MgXGxlcSBzXzAgLSBcdmVydCBcZGVsdGFcdmVydCBccmlnaHRdJCQKLSBUaGlzIGlzIG5vIGxvbmdlciB0aGUgY2FzZSB3aGVuICRccGkkIGRldmlhdGUgZnJvbSAwLjUuCgotLS0KCgpgYGB7cn0KcGkwIDwtIDAuNQpzMCA8LSBwaTAgKiBuCmRlbHRhIDwtIGFicyhib3lzIC0gczApCmRlbHRhCgpzVXAgPC0gczAgKyBkZWx0YQpzRG93biA8LSBzMCAtIGRlbHRhCmMoc0Rvd24sIHNVcCkKCnBVcCA8LSAxIC0gcGJpbm9tKHNVcCAtIDEsIG4sIHBpMCkKcERvd24gPC0gcGJpbm9tKHNEb3duLCBuLCBwaTApCnAgPC0gcFVwICsgcERvd24KYyhwVXAsIHBEb3duLCBwKQpgYGAKCi0tLQoKCi0gSWYgJFxwaT0gMS8yJCwgdGhlIHByb2JhYmlsaXR5IHRvIG9ic2VydmUgYXQgbGVhc3QgICRcZGVsdGE9JCBgciBkZWx0YWAgYm95cyBtb3JlIG9yIGxlc3MgdGhhbiB0aGUgbWVhbiB1bmRlciAkSF8wOiBzXzA9JCBgciBzMGAgaW4gYSByYW5kb20gc2FtcGxlIHVuZGVyIEhfMCBpcyBvbmx5IGByIGZvcm1hdChwKjEwMCxkaWdpdHM9MylgJSBpczogKiokcCQtdmFsdWUgb2YgYmlub21pYWwgdGVzdC4qKgotIFZlcnkgdW5saWtlbHkgdG8gb2JzZXJ2ZSBzdWNoIGEgbGFyZ2UgbnVtYmVyIG9mIGJveXMgaW4gYSByYW5kb20gc2FtcGxlIHdoZW4gYm95cyBhbmQgZ2lybHMgaGF2ZSB0aGUgc2FtZSAgZnJlcXVlbmN5IGluIHRoZSBwb3B1bGF0aW9uICh1bmRlciAkSF8wJCkuCi0gSGVuY2UgdGhlIGh5cG90aGVzaXMgdGhhdCB0aGUgZnJlcXVlbmN5IG9mIGJveXMgYW5kIGdpcmxzIGlzIHRoZSBzYW1lIGlzIG5vdCBzdXBwb3J0ZWQgYnkgdGhlIGRhdGEuCgotLS0KCmBgYHtyLCBvdXQud2lkdGg9JzEwMCUnLCBmaWcuYXNwPS44LCBmaWcuYWxpZ249J2NlbnRlcicsZWNobz1GQUxTRX0KcGxvdChzMCArIHNlcSgtMTUwLjUsIDE1MC41LCAxKSwgZGJpbm9tKHMwICsgc2VxKC0xNTAuNSwgMTUwLjUsIDEpLCBwcm9iID0gLjUsIHNpemUgPSBuKSwgdHlwZSA9ICJoIiwgeGxhYiA9ICJYIiwgeWxhYiA9ICJQcm9iYWJpbGl0eSIsIG1haW4gPSBhcy5leHByZXNzaW9uKHN1YnN0aXR1dGUocGkgPT0gdmFsLCBsaXN0KHZhbCA9IHBhc3RlMCgiMC41LCBub2JzPSIsIG4pKSkpLCB5bGltID0gYygtLjAwMDksIDAuMDExKSkKYWJsaW5lKHYgPSBzMCwgbHdkID0gMiwgY29sID0gNCkKYWJsaW5lKHYgPSBib3lzLCBsd2QgPSAyLCBjb2wgPSAyKQphYmxpbmUodiA9IHNEb3duLCBsd2QgPSAxLCBjb2wgPSAyLCBsdHkgPSAyKQp0ZXh0KGMoc0Rvd24sIHMwLCBib3lzLCBib3lzKSwgYyhyZXAoMC4wMTEsIDMpLCAwLjAxKSwgbGFiZWxzID0gYyhleHByZXNzaW9uKHBhc3RlKHNbMF0gLSBkZWx0YSkpLCBleHByZXNzaW9uKHNbMF0pLCBleHByZXNzaW9uKHMgPT0gc1swXSArIGRlbHRhKSwgYXMuZXhwcmVzc2lvbihzdWJzdGl0dXRlKHMgPT0gdmFsLCBsaXN0KHZhbCA9IGJveXMpKSkpLCBwb3MgPSA0LCBjb2wgPSBjKDIsIDQsIDIpKQp0ZXh0KHNEb3duIC0gNTAsIC0uMDAwNSwgbGFiZWwgPSAicC12YWx1ZSIsIGNvbCA9IDIsIHBvcyA9IDQpCnRleHQoc1VwLCAtLjAwMDUsIGxhYmVsID0gInAtdmFsdWUiLCBjb2wgPSAyLCBwb3MgPSA0KQphcnJvd3MoczAgKyAxNTAwLjUsIC0uMDAwOSwgc1VwLCAtLjAwMDksIGNvbCA9IDIsIGx3ZCA9IDIsIGFuZ2xlID0gMjAsIGxlbmd0aCA9IC4xKQphcnJvd3MoczAgLSAxNTAwLjUsIC0uMDAwOSwgc0Rvd24sIC0uMDAwOSwgY29sID0gMiwgbHdkID0gMiwgYW5nbGUgPSAyMCwgbGVuZ3RoID0gLjEpCmBgYAoKLS0tCgpUaGUgdGVzdCBjYW4gaW1tZWRpYXRlbHkgYmUgY29uZHVjdGVkIHVzaW5nIHRoZSBgYmlub21pYWwudGVzdGAgZnVuY3Rpb24gaW4gUi4KCmBgYHtyfQpiaW5vbS50ZXN0KHggPSBib3lzLCBuID0gbiwgcCA9IHBpMCkKYGBgCgpPbiB0aGUgNSUgc2lnbmlmaWNhbmNlLWxldmVsIHdlIGNvbmNsdWRlIHRoYXQgdGhlcmUgaXMgb24gYXZlcmFnZSBhIGhpZ2hlciBwcm9iYWJpbGl0eSBvbiBhIHVuYm9ybiBtYWxlIGNoaWxkIHRoYW4gYW4gdW5ib3JuIGZlbWFsZSBjaGlsZC4KCi0tLQoKIyMjIENvbmZpZGVuY2UgaW50ZXJ2YWwgb24gYSBwcm9wb3J0aW9uCgotIEVzdGltYXRvciBvZiB0aGUgcHJvcG9ydGlvbiBvZiBib3lzIGluIHRoZSBwb3B1bGF0aW9uICBpcyB0aGUgc2FtcGxlIG1lYW4gJFxoYXQgXHBpPVxiYXIgeD0kIGByIGZvcm1hdChwaSxkaWdpdHM9MylgCi0gVGhlIHN0YW5kYXJkIGVycm9yIGlzCiQkU0Vfe1xiYXIgeH09XHNxcnR7XGZyYWN7XHRleHR7VmFyfVtYXX17bn19PVxzcXJ0e1xmcmFje1xwaSgxLVxwaSl9e259fSQkCi0gV2UgY2FuIGVzdGltYXRlIHRoaXMgYmFzZWQgb24gdGhlIHNhbXBsZTogJFNFX3tcYmFyIHh9PVxzcXJ0e1xmcmFje1xoYXRccGkoMS1caGF0XHBpKX17bn19PSQgYHIgZm9ybWF0KHNxcnQocGkqKDEtcGkpL24pLGRpZ2l0cz0yKWAuCi0gOTUlIENJIHZpYSBDTFQ6ICRcaGF0XHBpIFxwbSAxLjk2IFNFX3tcaGF0XHBpfS4kCgpgYGB7cn0Kc2UgPC0gc3FydChwaSAqICgxIC0gcGkpIC8gbikKcGkgKyBjKC0xLCAxKSAqIHFub3JtKDAuOTc1KSAqIHNlCmBgYAoKLS0tCgojIyMgQ0kgb24gcHJvcG9ydGlvbiBpbiBzbWFsbCBzYW1wbGU/CgpgYGB7cn0KQ0kgPC0gYmlub20udGVzdCh4ID0gYm95cywgbiA9IG4sIHAgPSBwaTApJGNvbmYuaW50CkNJCmBgYAoKLS0tCgoKIyMjIENvbmNsdXNpb24KCi0gTm90ZSB0aGF0IHRoZSB0ZXN0IGZvciBhIHByb3BvcnRpb24gaXMgZXF1aXZhbGVudCB0byBhIG9uZS1zYW1wbGUgdC10ZXN0IGZvciBiaW5hcnkgZGF0YS4KCi0gRm9yIHRoZSBTYWtzZW4gcG9wdWxhdGlvbiB3ZSBjb25jbHVkZSBhdCB0aGUgNSUgc2lnbmlmaWNhbmNlIGxldmVsIHRoYXQgdGhlIGdlbmRlciBvZiB1bmJvcm4gY2hpbGRyZW4gaXMgbW9yZSBsaWtlbHkgdG8gYmUgbWFsZSB0aGFuIGZlbWFsZSAoJHA9JCBgciByb3VuZChiaW5vbS50ZXN0KHg9Ym95cyxuPW4scD1waTApJHAudmFsdWUsMylgKS4KVGhlIHByb2JhYmlsaXR5IHRoYXQgYW4gdW5ib3JuIGNoaWxkIGlzIG1hbGUgZXF1YWxzIGByIGZvcm1hdChwaSoxMDAsZGlnaXRzPTMpYCUgKDk1JSBDSSBbYHIgcGFzdGUoZm9ybWF0KENJKjEwMCxkaWdpdHM9MyksY29sbGFwc2U9IiwiKWBdJSkuCgotLS0KCiMgVGVzdCBmb3IgYXNzb2NpYXRpb24gYmV0d2VlbiB0d28gcXVhbGl0YXRpdmUgdmFyaWFibGVzCiMjIFBhaXJlZCBvYnNlcnZhdGlvbnMKCi0gMiBtZWFzdXJlbWVudHMgb24gc2FtZSBpbmRpdmlkdWFsCi0gZS5nLiBiZWZvcmUgYW5kIGFmdGVyIGV4cG9zdXJlIHRvIGEgY2hlbWljYWwgc3Vic3RhbmNlCi0gb2JzZXJ2ZSBhIGNhdGVnb3JpY2FsIG91dGNvbWUgYmVmb3JlIGFuZCBhZnRlci4KLSAqcGFpcmVkIGJpbmFyeSByZXNwb25zZXMqCi0gU3RhdGlzdGljYWwgYW5hbHlzaXMgaGFzIHRvIGFjY291bnQgZm9yIHBhaXJlZCBkZXNpZ24uCgotLS0KCiMjIyBFeGFtcGxlOiAgRmVtYWxlcyBjaG9vc2UgZ2VudGxlLCBidXQgbm90IGhlYWx0aHkgb3IgbWFjaG8gbWFsZXMgaW4gQ2FtcGJlbGwgZHdhcmYgaGFtc3RlcnMgKFJvZ292aW4gZXQgYWwuIDIwMTcpCgpgYGB7ciwgb3V0LndpZHRoPSc3MCUnLCBmaWcuYXNwPTEsIGZpZy5hbGlnbj0nY2VudGVyJyxlY2hvPUZBTFNFfQpsaWJyYXJ5KHBsb3RyaXgpCnBhcihtYXIgPSBjKDAsIDAsIDAsIDApLCBtYWkgPSBjKDAsIDAsIDAsIDApKQpwbG90KDAsIDAsIGF4ZXMgPSBGQUxTRSwgeGxhYiA9ICIiLCB5bGFiID0gIiIsIGNvbCA9IDAsIHhsaW0gPSBjKDAsIDMpLCB5bGltID0gYygwLCAzKSkKcmVjdCgwLCAwLCAzLCAzKQpsaW5lcyhjKDEsIDEpLCBjKDAsIDMpKQpsaW5lcyhjKDIsIDIpLCBjKDAsIDMpKQpsaW5lcyhjKDEsIDEpLCBjKDEsIDIpLCBsd2QgPSAyKQpsaW5lcyhjKDEsIDEpLCBjKDEsIDIpLCBsd2QgPSA0KQpsaW5lcyhjKDIsIDIpLCBjKDEsIDIpLCBsd2QgPSA0KQpyZWN0KDEuNDUsIDEsIDEuNTUsIDEuMykKZHJhdy5jaXJjbGUoMS41LCAxLjM2LCAwLjA1KQpsaW5lcyhjKDEuNSwgMS41KSwgYygxLCAuODUpKQp0ZXh0KDEuNSwgMS4xNSwgIlxcVkUiLCB2Zm9udCA9IGMoInNhbnMgc2VyaWYiLCAiYm9sZCIpLCBjZXggPSAxLjMpCnJlY3QoMC41LCAxLjA1LCAwLjgsIDEuMTUpCmRyYXcuY2lyY2xlKDAuODYsIDEuMSwgMC4wNSkKbGluZXMoYygwLjUsIDAuMzUpLCBjKDEuMSwgMS4xKSkKbGluZXMoYygwLjgsIDApLCBjKDEuMSwgMS41KSwgbHR5ID0gMikKdGV4dCgwLjY1LCAxLjEsICJcXE1BIiwgdmZvbnQgPSBjKCJzYW5zIHNlcmlmIiwgImJvbGQiKSwgY2V4ID0gMS4zKQpyZWN0KDIuNSwgMS45NSwgMi4yLCAxLjg1KQpkcmF3LmNpcmNsZSgyLjE0LCAxLjksIDAuMDUpCmxpbmVzKGMoMi41LCAyLjY1KSwgYygxLjksIDEuOSkpCmxpbmVzKGMoMi4yLCAzKSwgYygxLjksIDEuNSksIGx0eSA9IDIpCnRleHQoMi4zNSwgMS45LCAiXFxNQSIsIHZmb250ID0gYygic2FucyBzZXJpZiIsICJib2xkIiksIGNleCA9IDEuMykKYGBgCgotLS0KCi0gVGhlIGdhdGUgaXMgb3BlbmVkIHVwb24gMyBtaW51dGVzCi0gYWdncmVzc2l2ZSB2cyBub24tYWdyZXNzaXZlIG1hbGUKLSBFYWNoIGZlbWFsZSB1bmRlcmdvZXMgdGhlIHRlc3QgdHdpY2U6CgogICAgLSBvbmNlIHVwb24gc3RheSBpbiBob3N0aWxlIGVudmlyb25tZW50IChoaWdoIHBvcHVsYXRpb24gZGVuc2l0eSwgc2hvcnRhZ2Ugb2YgZmVlZCwgYSBsb3Qgb2YgY29tcGV0aXRpb24pCiAgICAtIGFuZCBvbmNlIHVwb24gc3RheSBpbiBnZW50bGUgZXZpcm9ubWVudC4KCgpgYGB7ciBjYXRIYW1zdGVyLCBlY2hvPUZBTFNFfQpoYW1zdGVyIDwtIG1hdHJpeChjKDMsIDE3LCAxLCAxMyksIG5jb2wgPSAyLCBieXJvdyA9IFRSVUUpCnJvd25hbWVzKGhhbXN0ZXIpIDwtIGMoImhvc3RpbGVfYWdyZXNzaXZlIiwgImhvc3RpbGVfbm9uLWFncmVzc2l2ZSIpCmNvbG5hbWVzKGhhbXN0ZXIpIDwtIGMoImZyaWVuZGx5X2FncmVzc2l2ZSIsICJmcmllbmRseV9ub24tYWdyZXNzaXZlIikKaGFtc3RlclRvdCA8LSBtYXRyaXgoMCwgbnJvdyA9IDMsIG5jb2wgPSAzKQpoYW1zdGVyVG90WzE6MiwgMToyXSA8LSBoYW1zdGVyCmhhbXN0ZXJUb3RbMywgMToyXSA8LSBjb2xTdW1zKGhhbXN0ZXIpCmhhbXN0ZXJUb3RbLCAzXSA8LSByb3dTdW1zKGhhbXN0ZXJUb3RbLCAxOjJdKQpoYW1zdGVyTGV0dGVycyA8LSBtYXRyaXgoYygiIChlKSIsICIgKGYpIiwgIiIsICIgKGcpIiwgIiAoaCkiLCAiIiwgIiIsICIiLCAiIiksIG5jb2wgPSAzLCBieXJvdyA9IFRSVUUpCmhhbXN0ZXJUb3QgPC0gbWF0cml4KHBhc3RlMChoYW1zdGVyVG90LCBoYW1zdGVyTGV0dGVycyksIGJ5cm93ID0gRkFMU0UsIG5jb2wgPSAzKQpjb2xuYW1lcyhoYW1zdGVyVG90KSA8LSBjKGNvbG5hbWVzKGhhbXN0ZXIpLCAidG90YWwiKQpyb3duYW1lcyhoYW1zdGVyVG90KSA8LSBjKHJvd25hbWVzKGhhbXN0ZXIpLCAidG90YWwiKQprbml0cjo6a2FibGUoaGFtc3RlclRvdCwgYm9va3RhYnMgPSBUUlVFKQpgYGAKCi0tLQoKIyMjIEFic29sdXRlIHJpc2sgZGlmZmVyZW5jZSAoQVJEKQoKLSAkXHBpXzE9UFtcdGV4dHthZ3Jlc3NpdmUgbWFsZSB9IFx2ZXJ0IFx0ZXh0e2hvc3RpbGV9XSQKLSAkXGhhdCBccGlfMT0oZStmKS9uJCwgd2l0aCAkbj1lK2YrZytoJC4KCi0gJFxwaV8wPVBbXHRleHR7YWdyZXNzaXZlIG1hbGUgfSBcdmVydCBcdGV4dHsgZnJpZW5kbHl9XSQKLSAkXGhhdCBccGlfMD0oZStnKS9uJApcYmVnaW57ZXF1YXRpb24qfQpcd2lkZWhhdHtcdGV4dHtBUkR9fT1caGF0XHBpXzEtXGhhdFxwaV8wPVxmcmFje2UrZn17bn0tXGZyYWN7ZStnfXtufT1cZnJhY3tmLWd9e259ClxlbmR7ZXF1YXRpb24qfQotIE9ubHkgYWZmZWN0ZWQgYnkgZGlzY29yZGFudCBwYWlycyAkZiQgZW4gJGckCgotLS0KCi0gU3RhbmRhcmQgZXJyb3Igb24gQVJEClxiZWdpbntlcXVhdGlvbip9Clx0ZXh0e1NFfV97XHdpZGVoYXR7XHRleHR7QVJEfX19PVxmcmFjezF9e259XHNxcnR7ZitnLVxmcmFjeyhmLWcpXjJ9e259fQpcZW5ke2VxdWF0aW9uKn0KCi0gSWYgd2UgaGF2ZSBsYXJnZSBudW1iZXIgb2Ygb2JzZXJ2YXRpb25zIHdlIGNhbiB1c2UgdGhlIENMVCB0byBlc3RhYmxpc2ggYW4gJCgxLVxhbHBoYSkxMDBcJSQgQ0kgb24gdGhlIEFSRAokJFxsZWZ0W1x3aWRlaGF0e1x0ZXh0e0FSRH19LXpfe1xhbHBoYS8yfVx0ZXh0e1NFfV97XHdpZGVoYXR7XHRleHR7QVJEfX19LFx3aWRlaGF0e1x0ZXh0e0FSRH19LXpfe1xhbHBoYS8yfVx0ZXh0e1NFfV97XHdpZGVoYXR7XHRleHR7QVJEfX19XHJpZ2h0XSQkCm9yCiQkXGxlZnRbXGZyYWN7Zi1nfXtufS1cZnJhY3t6X3tcYWxwaGEvMn19e259XHNxcnR7ZitnLVxmcmFjeyhmLWcpXjJ9e259fSxcZnJhY3tmLWd9e259K1xmcmFje3pfe1xhbHBoYS8yfX17bn1cc3FydHtmK2ctXGZyYWN7KGYtZyleMn17bn19XHJpZ2h0XSAkJAoKLS0tCgpgYGB7cn0KaGFtc3RlciA8LSBtYXRyaXgoYygzLCAxNywgMSwgMTMpLCBuY29sID0gMiwgYnlyb3cgPSBUUlVFKQpyb3duYW1lcyhoYW1zdGVyKSA8LSBjKCJob3N0aWxlLWFncmVzc2l2ZSIsICJob3N0aWxlLW5vbi1hZ3Jlc3NpdmUiKQpjb2xuYW1lcyhoYW1zdGVyKSA8LSBjKCJmcmllbmRseS1hZ3Jlc3NpdmUiLCAiZnJpZW5kbHktbm9uLWFncmVzc2l2ZSIpCgpmIDwtIGhhbXN0ZXJbMSwgMl0KZyA8LSBoYW1zdGVyWzIsIDFdCm4gPC0gc3VtKGhhbXN0ZXIpCnJpc2tkaWZmIDwtIChmIC0gZykgLyBuCnJpc2tkaWZmCnNlIDwtIHNxcnQoZiArIGcgLSAoZiAtIGcpXjIgLyBuKSAvIG4Kc2UKY2kgPC0gcmlza2RpZmYgKyBjKC0xLCAxKSAqIHFub3JtKDAuOTc1KSAqIHNlCmNpCmBgYAoKLS0tCgpcYmVnaW57ZXF1YXRpb24qfQpcd2lkZWhhdHtcdGV4dHtBUkR9fT1cZnJhY3sxNy0xfXszNH09MC40NzEKXGVuZHtlcXVhdGlvbip9ClRoZSBhYnNvbHV0ZSByaXNrIGRpZmZlcmVuY2Ugb24gY2hvb3NpbmcgZm9yIGFuIGFncmVzc2l2ZSBtYWxlIGlzIDQ3LjElIGxhcmdlciB1cG9uIHN0YXlpbmcgaW4gYSBob3N0aWxlIGVudmlyb25tZW50IHRoYXQgd2hlbiByZXNpZGluZyBpbiBhIGdlbnRsZSBlbnZpcm9ubWVudC4KLSBUaGUgc3RhbmRhcmQgZXJyb3IKXGJlZ2lue2VxdWF0aW9uKn0KXHRleHR7U0V9X3tcd2lkZWhhdHtcdGV4dHtBUkR9fX09XGZyYWN7MX17MzR9XHNxcnR7MTcrMS1cZnJhY3soMTctMSleMn17MzR9fT0wLjA5NTIKXGVuZHtlcXVhdGlvbip9Ci0gQSA5NVwlIGNvbmZpZGVuY2UgaW50ZXJ2YWwgb24gdGhpcyBhYnNvbHV0ZSByaXNrIGRpZmZlcmVuY2UgaXMKXGJlZ2lue2VxdWF0aW9uKn0KXGxlZnRbMC40NzEtMS45Nlx0aW1lcyAwLjA5NTIsMC40NzErMS45Nlx0aW1lcyAwLjA5NTJccmlnaHRdPVswLjI4NCwwLjY1OF0KXGVuZHtlcXVhdGlvbip9CgotLS0KCiMjIE1jTmVtYXIgdGVzdApgYGB7cixlY2hvPUZBTFNFfQprbml0cjo6a2FibGUoaGFtc3RlclRvdCwgYm9va3RhYnMgPSBUUlVFKQpgYGAKCi0gQXNzZXNzIGlmIHJpc2sgb24gY2hvaWNlIGZvciBhZ3Jlc3NpdmUgbWFsZSBkaWZmZXJzIGJldHdlZW4gcmVzaWRpbmcgaW4gaG9zdGlsZSBhbmQgZnJpZW5kbHkgZW52aXJvbm1lbnQuCi0gT25seSBkaXNjb3JkYW50IHBhaXJzIGdpdmUgaW5mb3JtYXRpb24uCi0gJGY+ZyQgaW5kaWNhdGlvbiBhZ2FpbnN0ICRIXzAkOiBjaG9pY2Ugb2YgcGFydG5lciBub3QgYXNzb2NpYXRlZCB3aXRoIGVudmlyb25tZW50LgotIEV2YWx1YXRlIHByb2JhYmlsaXR5IHRoYXQgaW4gYSByYW5kb20gZGlzY29yZGFudCBwYWlyLCBhIGZlbWFsZSBjaG9vc2VzIGFuIGFncmVzc2l2ZSBtYWxlIHVwb24gYSBzdGF5IGluIGEgaG9zdGlsZSBlbnZpcm9ubWVudC4KLSBXZSBlc3RpbWF0ZSB0aGUgcHJvYmFiaWxpdHkgYXMKICAkJFxmcmFje2Z9e2YrZ30kJAoKLS0tCgogIFxiZWdpbntlcW5hcnJheSp9CiAgXHRleHR7RX1cbGVmdFtmLyhmK2cpXHJpZ2h0XSZcc3RhY2tyZWx7SF8wfXs9fSYgMC41XFwKICBmICYgXHN0YWNrcmVse0hfMH17XHNpbX0mIFx0ZXh0e0Jpbm9tfShuPWYrZyxccGk9MC41KVxcCiAgXHRleHR7U0V9X3tcZnJhY3tmfXtmK2d9fSAmIFxzdGFja3JlbHtIXzB9ez19JiBcc3FydHsoZitnKVx0aW1lcyAwLjVcdGltZXMgMC41fT1cZnJhY3tcc3FydHtmK2d9fXsyfQpcZW5ke2VxbmFycmF5Kn0KCi0tLQoKLSBBc3ltcHRvdGljYWxseSBhIG9uZS1zYW1wbGUgei10ZXN0IChiYXNlZCBvbiB0aGUgTm9ybWFsIGRpc3RyaWJ1dGlvbikKClxiZWdpbntlcXVhdGlvbip9Cno9XGZyYWN7Zi0oZitnKS8yfXtcc3FydHtmK2d9LzJ9PVxmcmFje2YtZ317XHNxcnR7ZitnfX0KXGVuZHtlcXVhdGlvbip9CgotIE5vcm1hbCBhcHByb3hpbWF0aW9uIGlzIGdvb2QgaWYgJCRmIFx0aW1lcyBnLyhmK2cpIFxnZXEgNSQkCgpUaGUgKipNYyBOZW1hciB0ZXN0KiogaXMgdGhlIGFuYWxvZ29uIG9mIHRoZSBwYWlyZWQgdC10ZXN0IGZvciBiaW5hcnkgcXVhbGl0YXRpdmUgdmFyaWFibGVzLgoKLS0tCgpJbiBSIHdlIGNhbiBjb25kdWN0IHRoZSBhbmFseXNpcyB1c2luZyB0aGUgIGBtY25lbWFyLnRlc3RgIGZ1bmN0aW9uCmBgYHtyfQptY25lbWFyLnRlc3QoaGFtc3RlcikKYGBgCgoKLSBXZSByZWplY3QgdGhlIG51bGwgaHlwb3RoZXNpcyBhdCB0aGUgNSUgc2lnbmlmaWNhbmNlIGxldmVsCi0gV2UgY29uY2x1ZGUgdGhhdCB0aGUgY2hvaWNlIG9mIHBhcnRuZXIgaXMgZXh0cmVtZWx5IHNpZ25pZmljYW50bHkgYXNzb2NpYXRlZCB3aXRoIHRoZSBlbnZpcm9ubWVudC4KCi0tLQoKLSBOb3JtYWxlIGFwcHJveGltYXRpb24gaXMgbm90IG9wdGltYWwgYW5kIHdlIGNhbiBwZXJmb3JtIGFuIGV4YWN0IHRlc3QgdXNpbmcgdGhlIGJpbm9taWFsZSB0ZXN0CgpgYGB7cn0KYmlub20udGVzdCh4ID0gZiwgbiA9IGYgKyBnLCBwID0gMC41KQpgYGAKCi0tLQoKIyMjIENvbmNsdXNpb24KCi0gV2UgY29uY2x1ZGUgdGhhdCB0aGUgcGFydG5lciBjaG9pY2UgaXMgZXh0cmVtZWx5IHNpZ25maWNhbnRseSBhc3NvY2lhdGVkIHdpdGggdGhlIGVudmlyb25tZW50ICgkcDwwLjAwMSQpLgotIFRoZSBwcm9iYWJpbGl0eSBvbiBjaG9vc2luZyBhbiBhZ3Jlc3NpdmUgbWFsZSBpcyBvbiBhdmVyYWdlIGByIGZvcm1hdChyaXNrZGlmZioxMDAsZGlnaXRzPTMpYCUgaGlnaGVyIHdoZW4gYSBmZW1hbGUgaGFtc3RlciByZXNpZGVzIGluIGEgaG9zdGlsZSBlbnZpcm9ubWVudCB0aGFuIHdoZW4gc2hlIHJlc2lkZXMgaW4gYSBmcmllbmRseSBlbnZpcm9ubWVudCAoOTUlIENJIFtgciBwYXN0ZShmb3JtYXQoY2kqMTAwLGRpZ2l0cz0zKSxjb2xsYXBzZT0iLCIpYF0lKS4KCi0tLQoKIyBVbnBhaXJlZCBvYnNlcnZhdGlvbnMKIyMgR2VuZXRpYyBhc3NvY2lhdGlvbiBzdHVkeQoKLSBBcmUgZ2VuZXRpYyBwb2x5bW9ycGhpc21zIGluIHRoZSBCUkNBMSBnZW5lIGFzc29jaWF0ZWQgd2l0aCBicmVhc3QgY2FuY2VyPwotIFJldHJvc3BlY3RpdmUgY2FzZS1jb250cm9sIHN0dWR5IHdpdGggODAwIGJyZWFzdCBjYW5jZXIgY2FzZXMgZW4gNTcyIGNvbnRyb2xzCgpgYGB7cn0KYnJjYSA8LSByZWFkX2NzdigiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0dUUEIvUFNMUzIwL21hc3Rlci9kYXRhL2JyY2EuY3N2IikKaGVhZChicmNhKQpzdW1tYXJ5KGJyY2EpCmBgYAoKLS0tCgpgYGB7ciBlY2hvPUZBTFNFfQpicmNhSGxwIDwtIGRhdGEuZnJhbWUoR2Vub3R5cGUgPSBjKCJQcm8vUHJvIiwgIlByby9MZXUiLCAiTGV1L0xldSIsICJUb3RhYWwiKSwgQ29udHJvbCA9IGMoIjI2NiAoYSkiLCAiMjUwIChiKSIsICI1NiAoYykiLCAiNTcyIChhK2IrYykiKSwgQ2FzZXMgPSBjKCIzNDIgKGQpIiwgIjM2OSAoZSkiLCAiODkgKGYpIiwgIjgwMCAoZCtlK2YpIiksIFRvdGFsID0gYygiNjA4IChhK2QpIiwgIjYxOSAoYitlKSIsICIxNDUgKGMrZikiLCAiMTM3MiAobikiKSkKa25pdHI6OmthYmxlKGJyY2FIbHAsCiAgYm9va3RhYnMgPSBUUlVFCikKYGBgCgotIEluIGNhc2UtY29udHJvbCBzdHVkeSBvbmUgY2hvb3NlcyBhIGZpeGVkIG51bWJlciBvZiBjYXNlcyBhbmQgY29udHJvbHMgYW5kIHJlZ2lzdGVycyB3aGljaCBleHBvc3VyZXMgdGhleSBoYWQgaW4gdGhlIHBhc3QuCi0gUmV0cm9zcGVjdGl2ZSBzdHVkeQotIEltcG9zc2libGUgdG8gYXNzZXNzIHJpc2tzIGFuZCByaXNrLWRpZmZlcmVuY2VzIG9uIGJyZWFzdCBjYW5jZXIgYmVjYXVzZSB0aGUgcHJvcG9ydGlvbiBvZiBjYXNlcyBhbmQgY29udHJvbHMgZG9lcyBub3QgcmVmbGVjdCB0aGF0IGluIHRoZSBwb3B1bGF0aW9uIQoKLS0tCgpgYGB7ciwgdGlkeT1GQUxTRSxlY2hvPUZBTFNFfQpicmNhSGxwPWRhdGEuZnJhbWUoR2Vub3R5cGU9YygiUHJvL1BybyIsIlByby9MZXUiLCJMZXUvTGV1IiwiVG90YWFsIiksQ29udHJvbHM9YygiMjY2IChhKSIsIjI1MCAoYikiLCI1NiAoYykiLCI1NzIgKGErYitjKSIpLENhc2VzPWMoIjM0MiAoZCkiLCIzNjkgKGUpIiwiODkgKGYpIiwiODAwIChkK2UrZikiKSxUb3RhbD1jKCI2MDggKGErZCkiLCI2MTkgKGIrZSkiLCIxNDUgKGMrZikiLCIxMzcyIChuKSIpKQprbml0cjo6a2FibGUoYnJjYUhscCwKICBib29rdGFicyA9IFRSVUUKKQpgYGAKCi0gSXMgcG9zc2libGUgdG8gYXNzZXNzIHByb2JhYmlsaXR5IG9uIGFsbGVsIExldS9MZXUKICAgIC0gY2FzZXM6ICRccGlfMT1mLyhkK2UrZik9ODkvODAwPTExLjFcJSQKICAgIC0gY29udHJvbHM6JFxwaV8wPWMvKGErYitjKT01Ni81NzI9OS44XCUkCi0gUmVsYXRpdmUgcmlzayBvbiBleHBvc3VyZSBmb3IgY2FzZXMgdmVyc3VzIGNvbnRyb2xzIGlzICQxMS4xLzkuOD0xLjE0JC4KLSBUaGUgcHJvYmFiaWxpdHkgb24gdGhlIExldS9MZXUgZ2Vub3R5cGUgaXMgMTQlIGhpZ2hlciBmb3Igd29tZW4gd2l0aCBicmVhc3QgY2FuY2VyIHRoYW4gZm9yIHdvbWVuIHdpdGhvdXQgYm9yc3RrYW5rZXIuCi0gSXQgc3VnZ2VzdHMgYW4gYXNzb2NpYXRpb24sIGJ1dCBpdCBkb2VzIG5vdCBsZXQgdXMgY29uY2x1ZGUgaG93IG11Y2ggaGlnaGVyIHRoZSByaXNrIGlzIG9uIGJyZWFzdCBjYW5jZXIgZm9yIHdvbWVuIHdpdGggdGhlIExldS9MZXUgZ2Vub3R5cGUgYXMgY29tcGFyZWQgdG8gdGhlIG90aGVyIHdvbWVuLgotIE90aGVyIHN0YXRpc3RpYz8KCi0tLQoKXGJlZ2lue2VxdWF0aW9uKn0KT2Rkcz1cZnJhY3twfXsxLXB9ClxlbmR7ZXF1YXRpb24qfQp3aXRoICRwJCB0aGUgcHJvYmFiaWxpdHkgb24gdGhlIGV2ZW50LgoKVHJhbnNmb3JtYXRpb24gb2YgcmlzayB3aXRoIGZvbGxvd2luZyBwcm9wZXJ0aWVzOgoKICAtIG9kZHMgaGFzIHZhbHVlIGJldHdlZW4gMSBhbmQgJFxpbmZ0eSQuCgogIC0gb2RkcyBvbmx5IGVxdWFscyAxIGZvciBwcm9iYWJpbGl0eSAkcD0xLzIkLgoKICAtIGRlIG9kZHMgaW5jcmVhc2VzIGlmIHByb2JhYmlsaXR5IGluY3JlYXNlcy4KCi0gcG9wdWxhciBpbiBnYW1ibGluZzogaG93IG11Y2ggbW9yZSBsaWtlbHkgaXMgaXQgdG8gd2luIHRoYW4gdG8gbG9vc2UKCi0tLQoKYGBge3IsIHRpZHk9RkFMU0UsZWNobz1GQUxTRX0KYnJjYUhscD1kYXRhLmZyYW1lKEdlbm90eXBlPWMoIlByby9Qcm8iLCJQcm8vTGV1IiwiTGV1L0xldSIsIlRvdGFhbCIpLENvbnRyb2xzPWMoIjI2NiAoYSkiLCIyNTAgKGIpIiwiNTYgKGMpIiwiNTcyIChhK2IrYykiKSxDYXNlcz1jKCIzNDIgKGQpIiwiMzY5IChlKSIsIjg5IChmKSIsIjgwMCAoZCtlK2YpIiksVG90YWw9YygiNjA4IChhK2QpIiwiNjE5IChiK2UpIiwiMTQ1IChjK2YpIiwiMTM3MiAobikiKSkKa25pdHI6OmthYmxlKGJyY2FIbHAsCiAgYm9va3RhYnMgPSBUUlVFCikKYGBgCgpPZGRzIG9uIGFsbGVsIExldS9MZXUKCi0gQ2FzZXM6ICRcbWJveHtvZGRzfV8xPVxmcmFjeyBmLyhkK2UrZil9eyhkK2UpLyhkK2UrZil9PWYvKGQrZSk9ODkvNzExPTAuMTI1JC4gVGhlIGRvdWJsZSBMZXUvTGV1IHZhcmlhbnQgaXMgOCB0aW1lcyBsZXNzIGxpa2VseSB0aGFuIG90aGVyIGFsbGVsZSBjb21iaW5hdGlvbnMgaW4gdGhlIGJyZWFzdCBjYW5jZXIgY2FzZXMKLSBDb250cm9sczogJFxtYm94e29kZHN9XzI9Yy8oYStiKT01Ni81MTY9MC4xMDkkLgoKLSBBc3NvY2lhdGlvbiBiZXR3ZWVuIGV4cG9zdXJlIGFuZCBvdXRjb21lOgokJApPUl97TGV1L0xldX09XGZyYWN7XG1ib3h7b2Rkc31fVH17XG1ib3h7b2Rkc31fQ309IFxmcmFje2YvKGQrZSl9e2MvKGErYil9PVxmcmFje2YvKGQrZSl9e2MvKGErYil9PTEuMTUKJCQKCi0tLQoKCmBgYHtyLCB0aWR5PUZBTFNFLGVjaG89RkFMU0V9CmJyY2FIbHA9ZGF0YS5mcmFtZShHZW5vdHlwZT1jKCJQcm8vUHJvIiwiUHJvL0xldSIsIkxldS9MZXUiLCJUb3RhYWwiKSxDb250cm9scz1jKCIyNjYgKGEpIiwiMjUwIChiKSIsIjU2IChjKSIsIjU3MiAoYStiK2MpIiksQ2FzZXM9YygiMzQyIChkKSIsIjM2OSAoZSkiLCI4OSAoZikiLCI4MDAgKGQrZStmKSIpLFRvdGFsPWMoIjYwOCAoYStkKSIsIjYxOSAoYitlKSIsIjE0NSAoYytmKSIsIjEzNzIgKG4pIikpCmtuaXRyOjprYWJsZShicmNhSGxwLAogIGJvb2t0YWJzID0gVFJVRQopCmBgYAoKLSBJZiB0aGUgc3R1ZHkgd291bGQgaGF2ZSBiZWVuIGEgcmFuZG9tIHNhbXBsZSBvZiB0aGUgcG9wdWxhdGlvbiAobnVtYmVyIG9mIGNhc2VzIGFuZCBjb250cm9scyBub3QgZml4ZWQgYnkgZGVzaWduKSB0aGVuIHdlIHdvdWxkIGJlIGFibGUgdG8gY2FsY3VsYXRlIHRoZSBvZGRzIHJhdGlvIG9uIGJyZWFzdCBjYW5jZXIgZm9yIHBlb3BsZSB3aXRoIGFuZCB3aXRob3V0IHRoZSBkb3VibGUgTGV1L2xldSB2YXJpYW50LgpcYmVnaW57ZXF1YXRpb24qfQpPUl97Y2FzZX09XGZyYWN7IFxmcmFjeyBmfXtjfX17IFxmcmFjeyhkK2UpfXsoYStiKX19ID0gXGZyYWN7ZihhK2IpfXtjKGQrZSl9PU9SX3tMZXUvTGV1fT0xLjE1LApcZW5ke2VxdWF0aW9uKn0KLSBPUiBpcyBhIHN5bW1ldHJpYyBzdGF0aXN0aWMhCi0gT1Igb24gYm9yc3RjYW5jZXIgY2FuIGJlIGVzdGltYXRlZCEKLSBUaGUgb2RkcyBvbiBib3JzdGNhbmNlciBpcyAxNSUgaGlnaGVyIGZvciB3b21lbiB3aXRoIHRoaXMgc3BlY2lmaWMgYWxsZWxlIGNvbWJpbmF0aW9uLgoKLS0tCgotIElzIHRoZSBkaWZmZXJlbmNlIGxhcmdlIGVub3VnaCB0byBnZW5lcmFsaXplIHRoZSBlZmZlY3QgaW4gdGhlIHNhbXBsZSB0b3dhcmRzIHRoZSBwb3B1bGF0aW9uPwoKLSBXZSB3aWxsIGZpcnN0IHJld3JpdGUgdGhlIGRhdGEgaW4gYSAyeDIgdGFibGUKCmBgYHtyIGxldTQsIHRpZHk9RkFMU0UsZWNobz1GQUxTRX0KYnJjYVRhYjIgPC0gdGFibGUoYnJjYSR2YXJpYW50MixicmNhJGNhbmNlcikKYnJjYVRhYjIgPC0gYnJjYVRhYjJbMjoxLF0KYnJjYUhscDIgPC0gZGF0YS5mcmFtZShHZW5vdHlwZT1jKCJvdGhlciIsIkxldS9MZXUiLCJUb3RhbCIpLENvbnRyb2xzPWMoIjUxNiAoYSkiLCI1NiAoYikiLCI1NzIgKGErYikiKSxDYXNlcz1jKCI3MTEgKGMpIiwiODkgKGQpIiwiODAwIChjK2QpIiksVG90YWFsPWMoIjEyMjcgKGErYykiLCIxNDUgKGIrZCkiLCIxMzcyIChuKSIpKQprbml0cjo6a2FibGUoYnJjYUhscDIsCiAgYm9va3RhYnMgPSBUUlVFCikKYGBgCgotLS0KCiMjIFBlYXJzb24gQ2hpLXNxdWFyZSB0ZXN0IGZvciBpbmRlcGVuZGVudCBzYW1wbGVzCgotIFRlc3QgYXNzb2NpYXRpb24gYmV0d2VlbiBjYXRlZ29yaWNhbCBleHBvc3VyZShlLmcuIHZhcmlhbnQsIFgpIGVuIGNhdGVnb3JpY2FsIHJlc3BvbnNlIChlLmcuIGRpc2Vhc2UsIFkpLgokJEhfMDogXHRleHR7VGhlcmUgaXMgbm8gYXNzb2NpYXRpb24gYmV0d2VlbiB9IFggXHRleHR7IGFuZCB9IFkgXHRleHR7IHZzIH0gSF8xOiBYIFx0ZXh0eyBhbmQgfSBZIFx0ZXh0eyBhcmUgYXNzb2NpYXRlZH0kJAoKLSBDb25zaWRlciByb3cgdG90YWxzICRuX1x0ZXh0e290aGVyfT1hK2MkLCAkbl9cdGV4dHtsZXUsbGV1fT1iK2QkIGFuZAotIGNvbHVtbiB0b3RhbHMgJG5fXHRleHR7Y29udHJ9PWErYiQgZW4gJG5fXHRleHR7Y2FzZX09YytkJC4KLSBUaGV5IGdpdmUgaW5mb3JtYXRpb24gb24gKm1hcmdpbmFsIGRpc3RyaWJ1dGlvbiogb2YgdGhlIGV4cG9zdXJlICh2YXJpYW50LCBYKSBhbmQgb3V0Y29tZSAoZGlzZWFzZSwgWSksCmJ1dCBub3Qgb24gdGhlIGFzc29jaWF0aW9uIGJldHdlZW4gdGhlc2UgdmFyaWFibGVzLgotIFVuZGVyICRIXzAkICRYJCBhbmQgJFkkIGFyZSBpbmRlcGVuZGVudCBhbmQgb25lIGV4cGVjdHMgIHRoYXQgJChiK2QpL24kCm9mIHRoZSAkYStiJCBjb250cm9scyBoYXZlIGEgTGV1L0xldSB2YXJpYW50LCBvciB0aGF0ICQoYStiKShiK2QpL24kIG9mIHRoZW0gaGFzIGEgTGV1L0xldSB2YXJpYW50Ci0gV2UgY2FuIGNhbGN1bGF0ZSB0aGlzIGV4cGVjdGVkIG51bWJlciAkRV97aWp9JCB1bmRlciB0aGUgbnVsbCBoeXBvdGhlc2lzIGZvciAqZWFjaCBjZWxsKiBvZiB0aGUgJDIKXHRpbWVzIDIkIHRhYmxlLgoKLS0tCgotICRFX3sxMX0kID0gRXhwZWN0ZWQgbnVtYmVyIHVuZGVyICRIXzAkIGluICAoMSwxKS1jZWxsID0gYHIgc3VtKGJyY2FUYWIyWzEsXSlgICRcdGltZXMkIGByIHN1bShicmNhVGFiMlssMV0pYC9gciBzdW0oYnJjYVRhYjIpYCA9IGByIGZvcm1hdChzdW0oYnJjYVRhYjJbMSxdKSpzdW0oYnJjYVRhYjJbLDFdKS9zdW0oYnJjYVRhYjIpLGRpZ2l0cz00KWAgOwoKLSAkRV97MTJ9JCA9IEV4cGVjdGVkIG51bWJlciB1bmRlciAkSF8wJCBpbiAgKDEsMiktY2VsbCA9IGByIHN1bShicmNhVGFiMlsxLF0pYCAkXHRpbWVzJCBgciBzdW0oYnJjYVRhYjJbLDJdKWAvYHIgc3VtKGJyY2FUYWIyKWAgPSBgciBmb3JtYXQoc3VtKGJyY2FUYWIyWzEsXSkqc3VtKGJyY2FUYWIyWywyXSkvc3VtKGJyY2FUYWIyKSxkaWdpdHM9NClgIDsKCi0gJEVfezIxfSQgPSBFeHBlY3RlZCBudW1iZXIgdW5kZXIgJEhfMCQgaW4gICgyLDEpLWNlbGwgPSBgciBzdW0oYnJjYVRhYjJbMixdKWAgJFx0aW1lcyQgYHIgc3VtKGJyY2FUYWIyWywxXSlgL2ByIHN1bShicmNhVGFiMilgID0gYHIgZm9ybWF0KHN1bShicmNhVGFiMlsyLF0pKnN1bShicmNhVGFiMlssMV0pL3N1bShicmNhVGFiMiksZGlnaXRzPTQpYCA7CgotICRFX3syMn0kID0gRXhwZWN0ZWQgbnVtYmVyIHVuZGVyICRIXzAkIGluICAoMiwyKS1jZWxsID0gYHIgc3VtKGJyY2FUYWIyWzIsXSlgICRcdGltZXMkIGByIHN1bShicmNhVGFiMlssMl0pYC9gciBzdW0oYnJjYVRhYjIpYCA9IGByIGZvcm1hdChzdW0oYnJjYVRhYjJbMixdKSpzdW0oYnJjYVRhYjJbLDJdKS9zdW0oYnJjYVRhYjIpLGRpZ2l0cz00KWAgOwoKVGVzdC1zdGF0aXN0aWM6ClxiZWdpbntlcW5hcnJheSp9ClheMiAmPSYgXGZyYWN7XGxlZnQgKHxPX3sxMX0gLSBFX3sxMX18IC0gLjUgXHJpZ2h0KV4yIH17IEVfezExfX0gKyBcZnJhY3sKXGxlZnQgKCB8T197MTJ9IC0gRV97MTJ9fCAtIC41IFxyaWdodCleMiB9e0VfezEyfSB9KyBcXAomJlxxdWFkXHF1YWQKXGZyYWN7IFxsZWZ0ICggfE9fezIxfQotIEVfezIxfXwgLSAuNSBccmlnaHQpXjIgfXtFX3syMX19KyBcZnJhY3sgXGxlZnQgKCB8T197MjJ9IC0gRV97MjJ9fCAtIC41ClxyaWdodCleMiB9e0VfezIyfSB9XFwKIFheMiAmXHN0YWNrcmVse0hfMH17XGxvbmdyaWdodGFycm93fSYgXGNoaV4yKGRmPTEpClxlbmR7ZXFuYXJyYXkqfQoKLS0tCgpgYGB7ciBlY2hvPUZBTFNFfQpncmlkIDwtIHNlcSgwLCAxMCwgLjEpCnBsb3QoZ3JpZCwgZGNoaXNxKGdyaWQsIDEpLCB0eXBlID0gImwiLCBsd2QgPSAyKQpkZnMgPC0gYygxLCAyLCA1KQpmb3IgKGkgaW4gMjozKSB7CiAgbGluZXMoZ3JpZCwgZGNoaXNxKGdyaWQsIGRmc1tpXSksIGNvbCA9IGksIGx3ZCA9IDIpCn0KbGVnZW5kKCJ0b3ByaWdodCIsIGx0eSA9IDEsIGx3ZCA9IDIsIGNvbCA9IDE6MywgbGVnZW5kID0gc2FwcGx5KGRmcywgZnVuY3Rpb24oZCkgYXMuZXhwcmVzc2lvbihzdWJzdGl0dXRlKGNoaVtkZiA9PSB2YWxdXjIsIGxpc3QodmFsID0gZCkpKSkpCmBgYAoKLS0tCgotIEEgbGFyZ2UgdmFsdWUgb2YgdGhlIHRlc3Qgc3RhdGlzdGljIGdpdmVzIGFuIGluZGljYXRpb24gdGhhdCB0aGUgbnVsbCBoeXBvdGhlc2lzIGlzIGZhbHNlLgotIFRoZSB0ZXN0IHdpbGwgcmVqZWN0ICRIXzAkIGF0IHRoZSAkXGFscGhhIDEwMFwlJApzaWduaWZpY2FuY2UgbGV2ZWwgYXMgc29vbiBhcyB0aGUgb2JzZXJ2ZWQgdGVzdC1zdGF0aXN0aWMgaXMgbGFyZ2VyIHRoYW4gdGhlICQxMDBcJSgxLVxhbHBoYSkkLXF1YW50aWxlLCAkXGNoaV4yX3sxLApcYWxwaGF9JCwgb2YgdGhlICRcY2hpXjJfMSQtZGlzdHJpYnV0aW9uLgotIE90aGVyd2lzZSB3ZSBkbyBub3QgcmVqZWN0ICRIXzAkLgotIFRoZSBwLXZhbHVlIG9mIGEgMi1zaWRlZCB0ZXN0IGlzIHRoZSBwcm9iYWJpbGl0eSB0byBvYnNlcnZlIGEgbGFyZ2VyIHRlc3Qtc3RhdGlzdGljIGluIGEgcmFuZG9tIHNhbXBsZSB1bmRlciB0aGUgbnVsbCB0aGFuIHdoYXQgd2Ugb2JzZXJ2ZWQgaW4gb3VyIHNhbXBsZS4KJCRwPVBfMFtcY2hpXjJfMSBcZ2VxIHheMl0kJC4KCi0tLQoKYGBge3J9CmV4cGVjdGVkIDwtIG1hdHJpeCgwLCBucm93ID0gMiwgbmNvbCA9IDIpCmZvciAoaSBpbiAxOjIpIHsKICBmb3IgKGogaW4gMToyKSB7CiAgICBleHBlY3RlZFtpLCBqXSA8LQogICAgICBzdW0oYnJjYVRhYjJbaSwgXSkgKiBzdW0oYnJjYVRhYjJbLCBqXSkgLyBzdW0oYnJjYVRhYjIpCiAgfQp9CmV4cGVjdGVkCngyIDwtIHN1bSgoYWJzKGJyY2FUYWIyIC0gZXhwZWN0ZWQpIC0gLjUpXjIgLyBleHBlY3RlZCkKMSAtIHBjaGlzcSh4MiwgMSkKYGBgCgotLS0KCi0gQmVjYXVzZSAkT197aWp9JCBhcmUgZGlzY3JldGUgdmFsdWVzLCB0aGUgJFheMiQgY2FuIG9ubHkgdGFrZSBkaXNjcmV0ZSB2YWx1ZXMgYW5kIHRoZSBjb250aW51b3VzcyAkXGNoaV4yXzEkLWRpc3RyaWJ1dGlvbiBpcyBvbmx5IGFuIGFwcHJveGltYXRpb24gb2YgdGhlIHJlYWwgZGlzdHJpYnV0aW9uLgotIFRvIGltcHJvdmUgdGhlIGFwcHJveGltYXRpb24gb25lIHN1YnN0cmFjdHMgMC41IGZyb20gdGhlIHZhbHVlIGluIGVhY2ggY2VsbDoKKmNvbnRpbnVpdHktY29ycmVjdGlvbioKLSBXZSByZWZlciB0byB0aGlzIHRlc3QgYXMgKlBlYXJzb24gQ2hpLXNxdWFyZWQgdGVzdCB3aXRoIFlhdGVzIGNvcnJlY3Rpb24qLgotIFdoZW4gdGhlIGNvcnJlY3Rpb24gaXMgbm90IHVzZWQgKGkuZS4gd2hlbiB0aGUgdmFsdWVzIG9mIGAwLjUnIGluIHRoZSBlc3RpbWF0b3IgJFheMiQgYXJlIHJlcGxhY2VkKSB3ZSB1c2UgdGhlICpQZWFyc29uIENoaS1zcXVhcmVkIHRlc3QqLgoKLS0tCgpJbiBSIHlvdSBjYW4gc3dpdGNoIHRoZSBjb3JyZWN0aW9uIG9uIG9yIG9mZiBieSBzZXR0aW5nIHRoZSBhcmd1bWVudCBgY29ycmVjdGAgb24gVFJVRSBvciBGQUxTRSwgcmVzcGVjdGl2ZWx5OgoKYGBge3J9CmNoaXNxLnRlc3QoYnJjYVRhYjIpCmNoaXNxLnRlc3QoYnJjYVRhYjIsIGNvcnJlY3QgPSBGQUxTRSkKYGBgCgotLS0KCi0gRXZlbiB3aXRoIHRoZSAkXGNoaV4yXzEkIGNvcnJlY3Rpb24gdGhlIGFwcHJveGltYXRpb24gaXMgb25seSB2YWxpZCBpZiBub24gb2YgdGhlIGNlbGxzIGhhcyBhbiBleHBlY3RlZCBjb3VudCBiZWxvdyA1IHVuZGVyICRIXzAkLgotIFdoZW4gdGhlICRcY2hpXjIkLWFwcHJveGltYXRpb24gaXMgaW52YWxpZCB3ZSB3aWxsIHVzZSAqRmlzaGVyJ3MgZXhhY3QgdGVzdCouCi0gIE51bGwgaHlwb3RoZXNpcyBpcyBhbHNvIHRoYXQgJFgkIGFuZCAkWSQgYXJlIGluZGVwZW5kZW50LCBhbmQsIHRoZSBhbHRlcm5hdGl2ZSBoeXBvdGhlc2lzIHRoYXQgJFgkIGFuZCAkWSQgYXJlIGRlcGVuZGVudC4KCmBgYHtyfQpmaXNoZXIudGVzdChicmNhVGFiMikKYGBgCgotLS0KCgojIyBFeHRlbnNpb24gdG8gY2F0ZWdvcmljYWwgdmFyaWFibGVzIHdpdGggbXVsdGlwbGUgbGV2ZWxzCgotIFRoZSAkXGNoaV4yJC10ZXN0IGNhbiBhbHNvIGJlIHVzZWQgaWYgb25lIG9mIHRoZSBjYXRlZ29yaWNhbCB2YXJpYWJsZXMgJFgkIGFuZCAkWSQgaGFzIG1vcmUgdGhhbiAyIGxldmVscwoKLSBBZ2FpbjogdGhlIG51bGwgaHlwb3RoZXNpcyAkSF8wJDogJFgkIGFuZCAkWSQgYXJlIGluZGVwZW5kZW50IChub3QgYXNzb2NpYXRlZCksIGFnYWluc3QgdGhlIGFsdGVybmF0aXZlICRIX0E6IFgkIGFuZCAkWSQKYXJlIGFzc29jaWF0ZWQuCgotIExldCB0aGUgdmFyaWFibGUgaW4gdGhlIHJvd3MgaGF2ZSAkciQgZGlmZmVyZW50IHBvc3NpYmxlIG91dGNvbWVzIGFuZCB0aGUgb25lIGluIHRoZSBjb2x1bW5zICRjJCBwb3NzaWJsZSBvdXRjb21lcywgdGhlbiB3ZSBvYnRhaW4gYW4gJHIgXHRpbWVzIGMkIHRhYmxlLgoKLSBBZ2FpbiB3ZSB3aWxsIGNvbXBhcmUgdGhlIG9ic2VydmVkIHZhbHVlcyBpbiAgY2VsbCAkKGksaikkLCByZWZlcnJlZCB0byBhcyAkT197aWp9JCwgd2l0aCB0aGUgZXhwZWN0ZWQgbnVtYmVyIHVuZGVyICRIXzAkLCAkRV97aWp9JAogLSBBZ2FpbiAkRV97aWp9JCBpcyB0aGUgcHJvZHVjdCBvZiB0aGUgJGleXHRleHR7dGh9JCByb3ctdG90YWwgYW5kIHRoZSAkal5cdGV4dHt0aH0kIGNvbHVtbiB0b3RhbCBkZXZpZGVkIGJ5IHRoZSBvdmVyYWxsIHRvdGFsLgoKXGJlZ2lue2VxdWF0aW9uKn0KWF4yID0gXHN1bV97aWp9IFxmcmFje1xsZWZ0IChPX3tpan0gLSBFX3tpan1ccmlnaHQpXjIgfXsgRV97aWp9fQpcZW5ke2VxdWF0aW9uKn0KCi0tLQoKLSBXZSBjYW4gc2hvdyB0aGF0IHRoZSBzdGF0aXN0aWMgZm9sbG93cyBhICRcY2hpXjIkIGRpc3RyaWJ1dGlvbiB3aXRoICQoci0xKSBcdGltZXMKKGMtMSkkIGRlZ3JlZXMgb2YgZnJlZWRvbSB1bmRlciAkSF8wJC4KLSBObyBjb250aW51aXR5IGNvcnJlY3Rpb24KLSAqKlBlYXJzb24gJFxjaGleMiQgdGVzdCoqIGlzIGFuYWxvZ29uIG9mIG9uZS13YXkgQU5PVkEgZm9yIHF1YWxpdGF0aXZlIHZhcmlhYmxlcy4KCi0tLQoKCmBgYHtyfQpicmNhVGFiIDwtIHRhYmxlKGJyY2EkdmFyaWFudCwgYnJjYSRjYW5jZXIpCmNoaXNxLnRlc3QoYnJjYVRhYikKYGBgCgotIFRvIGFzc2VzcyBpZiB0aGUgdmFyaWFudCBvZiB0aGUgQlJDQTEgZ2VuZSBpcyBhc3NvY2lhdGVkIHdpdGggYnJlYXN0IGNhbmNlciB3ZSBjb25kdWN0ZWQgYSAgUGVhcnNvbiAkXGNoaV4yJHRlc3QgZm9yIHRoZSAkMyBcdGltZXMgMiQgdGFibGUuCi0gVGhlIHN0YXRpc3RpYyBpcyBub3cgYHIgZm9ybWF0KGNoaXNxLnRlc3QoYnJjYVRhYikkc3RhdGlzdGljLGRpZ2l0cz00KWAgYW5kIGZvbGxvd3MgYSAkXGNoaV4yJCBkaXN0cmlidXRpb24gd2l0aCBgciBjaGlzcS50ZXN0KGJyY2FUYWIpJHBhcmFtZXRlcmAgZGVncmVlcyBvZiBmcmVlZG9tIHVuZGVyICRIXzAkLiBUaGUgcHJvYmFiaWxpdHkgdG8gb2J0YWluIGEgJFxjaGleMiQtdGVzdCBzdGF0aXN0aWMgaW4gYSByYW5kb20gc2FtcGxlIHVuZGVyICRIXzAkIHRoYXQgaXMgbW9yZSBleHRyZW1lIHRoYW4gYHIgZm9ybWF0KGNoaXNxLnRlc3QoYnJjYVRhYikkc3RhdGlzdGljLGRpZ2l0cz00KWAsIGlzIGByIGZvcm1hdChjaGlzcS50ZXN0KGJyY2FUYWIpJHAudmFsdWUqMTAwLGRpZ2l0cz0yKWAlLgotIE9uIHRoZSA1JSBsZXZlbCBvZiBzaWduaWZpY2FuY2Ugd2UgY29uY2x1ZGUgdGhhdCB0aGUgdmFyaWFudCBvZiB0aGUgQlJDQS1nZW5lIGlzIG5vdCBhc3NvY2lhdGVkIHdpdGggYnJlYXN0IGNhbmNlci4KCi0tLQoKIyBMb2dpc3RpYyByZWdyZXNzaW9uCgotIEZyYW1ld29yayB0byBtb2RlbCBiaW5hcnkgZGF0YSAoZS5nIGNhbmNlciB2cyBubyBjYW5jZXIpOiAqbG9naXN0aWMgcmVncmVzc2lvbiBtb2RlbCouCi0gTW9kZWwgYmluYXJ5IGRhdGEgd2l0aCBjb250aW51b3VzIGFuZC9vciBkdW1teSB2YXJpYWJsZXMuCgotIFRoZSBtb2RlbCBhc3N1bWVzIHRoYXQgb2JzZXJ2YXRpb25zIGZvciBzdWJqZWN0ICRpPTEsXGxkb3RzLG4kIGFyZSBpbmRlcGVuZGVudCBhbmQgZm9sbG93IGEgQmVybm91bGxpIGRpc3RyaWJ1dGlvbi4KLSBUaGUgbG9nYXJpdGhtIG9mIHRoZSBvZGRzIGlzIG1vZGVsbGVkIHVzaW5nIGEgbGluZWFyIG1vZGVsLCBhbHNvIHJlZmVycmVkIHRvIGFzIGxpbmVhciBwcmVkaWN0b3I6ClxiZWdpbntlcXVhdGlvbn0KXGxlZnRcewpcYmVnaW57YXJyYXl9e2NjbH0KWV9pJlxzaW0mQihccGlfaSlcXFxcClxsb2cgXGZyYWN7XHBpX2l9ezEtXHBpX2l9Jj0mXGJldGFfMCArIFxiZXRhXzFYX3tpMX0gKyBcbGRvdHMgKyBcYmV0YV9wIFhfe2lwfQpcZW5ke2FycmF5fVxyaWdodC4KXGVuZHtlcXVhdGlvbn0KCi0tLQoKIyMgQ2F0ZWdvcmljYWwgcHJlZGljdG9yCgotIGJyZWFzdCBjYW5jZXIgZXhhbXBsZTogaXMgQlJDQSAxICB2YXJpYW50IGFzc29jaWF0ZWQgd2l0aCBicmVhc3QgY2FuY2VyLgoKLSBBcyBpbiB0aGUgQW5vdmEgY29udGV4dCwgYSBmYWN0b3IgaW4gbG9naXN0aWMgcmVncmVzc2lvbiBpcyBjb2RlZCB1c2luZyBkdW1teSB2YXJpYWJsZXMuCi0gMSBkdW1teSB2YXJpYWJsZSBsZXNzIHRoYW4gdGhlIG51bWJlciBvZiBncm91cHMuCgotIEZvciBCUkNBIDEgd2UgbmVlZCB0d28gZHVtbXkgdmFyaWFibGVzIGFuZCBvYnRhaW4gdGhlIGZvbGxvd2luZyBsaW5lYXIgcHJlZGljdG9yOgoKXGJlZ2lue2VxbmFycmF5Kn0KICBcbG9nIFxmcmFje1xwaV9pfXsxLVxwaV9pfSAmPSYgXGJldGFfMCtcYmV0YV8xIHhfe2kxfSArXGJldGFfMiB4X3tpMn0KXGVuZHtlcW5hcnJheSp9CgotIHdpdGggOgokJHhfe2kxfSA9IFxsZWZ0XHsgXGJlZ2lue2FycmF5fXtsbH0KMSAmIFx0ZXh0eyBpZiBzdWJqZWN0ICRpJCBpcyBoZXRlcm96eWdvdXMsIFByby9MZXUgdmFyaWFudH0gXFwKMCAmIFx0ZXh0e2lmIHN1YmplY3QgJGkkIGlzIGhvbW96eWdvdXMsIChQcm8vUHJvIG9yIExldS9MZXUgdmFyaWFudCl9IFxlbmR7YXJyYXl9XHJpZ2h0LiAuJCQKJCR4X3tpMn0gPSBcbGVmdFx7IFxiZWdpbnthcnJheX17bGx9CjEgJiBcdGV4dHsgaWYgc3ViamVjdCAkaSQgaXMgaG9tb3p5Z291cyBpcyB0aGUgTGV1Y2luZSBtdXRhdGlvbjogTGV1L0xldSB9IFxcCjAgJiBcdGV4dHsgb2Ygc3ViamVjdCAkaSQgaXMgbm90IGhvbW96eWdvdXMgaW4gdGhlIExldS9MZXUgdmFyaWFudH0gXGVuZHthcnJheX1ccmlnaHQuIC4kJAoKLSBIb21venlnb3NpdHkgaW4gdGhlICB3aWxkIHR5cGUgYWxsZWxlIFByby9Qcm8gaXMgdGhlICAqKnJlZmVyZW5jZSBncm91cCoqLgoKLS0tCgpXZSBmaXQgdGhlIG1vZGVsIGluIFIuCgotIE5vdGUgdGhhdCB3ZSB1c2UgdGhlIGZ1bmN0aW9uIGBhcy5mYWN0b3JgIHRvIGNvbnZlcnQgdGhlIGNhbmNlciB2YXJpYWJsZSB0byBhIGZhY3RvciB2YXJpYWJsZS4gLSBXZSBmdXJ0aGVyIHVzZSB0aGUgZnVuY3Rpb24gYHJlbGV2ZWxgIHRvIHNwZWNpZnkgdGhlIGNvbnRyb2wgdHJlYXRtZW50IGFzIHRoZSByZWZlcmVuY2UgZ3JvdXAuCmBgYHtyfQpicmNhJGNhbmNlciA8LSBicmNhJGNhbmNlciAlPiUKICBhcy5mYWN0b3IoKSAlPiUKICByZWxldmVsKCJjb250cm9sIikKYnJjYSR2YXJpYW50IDwtIGJyY2EkdmFyaWFudCAlPiUKICBhcy5mYWN0b3IoKSAlPiUKICByZWxldmVsKCJwcm8vcHJvIikKYnJjYUxvZ2l0IDwtIGdsbShjYW5jZXIgfiB2YXJpYW50LCBkYXRhID0gYnJjYSwgZmFtaWx5ID0gYmlub21pYWwpCnN1bW1hcnkoYnJjYUxvZ2l0KQpgYGAKClRoZSBpbnRlcmNlcHQgaXMgdGhlIGxvZy1vZGRzIG9uIGNhbmNlciBpbiB0aGUgcmVmZXJlbmNlIGNsYXNzIChQcm8vUHJvKSBhbmQgdGhlIHNsb3BlIHRlcm1zIGFyZSAgbG9nIG9kZHMgcmF0aW9zIGJldHdlZW4gdHJlYXRtZW50IGFuZCByZWZlcmVuY2UgY2xhc3M6ClxiZWdpbntlcW5hcnJheSp9Clxsb2cgXHRleHR7T0REU31fXHRleHR7UHJvL1Byb30mPSZcYmV0YV8wXFxcXApcbG9nIFx0ZXh0e09ERFN9X1x0ZXh0e1Byby9MZXV9Jj0mXGJldGFfMCtcYmV0YV8xXFxcXApcbG9nIFx0ZXh0e09ERFN9X1x0ZXh0e0xldS9MZXV9Jj0mXGJldGFfMCtcYmV0YV8yXFxcXApcbG9nICBcZnJhY3tcdGV4dHtPRERTfV9cdGV4dHtQcm8vTGV1fX17XHRleHR7T0REU31fXHRleHR7UHJvL1Byb319Jj0mXGxvZyBcdGV4dHtPRERTfV9cdGV4dHtQcm8vTGV1fS1cbG9nIE9ERFNfe1Byby9Qcm99XFwKJj0mXGJldGFfMCtcYmV0YV8xLVxiZXRhXzA9XGJldGFfMVxcXFwKXGxvZyAgXGZyYWN7XHRleHR7T0REU31fXHRleHR7TGV1L0xldX19e1x0ZXh0e09ERFN9X1x0ZXh0e1Byby9Qcm99fSY9JlxiZXRhXzIKXGVuZHtlcW5hcnJheSp9CgotIFRoZSBhbmFseXNpcyBhbGxvd3MgdXMgdG8gaW50ZXJwcmV0IHRoZSByZXN1bHQgaW1tZWRpYXRlbHkgaW4gb2Rkc2VzIGFuZCBvZGRzIHJhdGlvcyEKCi0tLQoKYGBge3J9CmFub3ZhKGJyY2FMb2dpdCwgdGVzdCA9ICJDaGlzcSIpCmBgYAoKVGhlICRcY2hpXjIkLXRlc3Qgb24gdGhlIGxvZ3NpdGljIHJlZ3Jlc3Npb24gbW9kZWwgYWxzbyBpbmRpY2F0ZXMgdGhhdCB0aGVyZSBpcyBubyBzaWduaWZpY2FudCBhc3NvY2lhdGlvbiBiZXR3ZWVuIGNhbmNlciBzdGF0dXMgYW5kIHRoZSBnZW5ldGljIHZhcmlhbnQgb2YgdGhlIEJSQ0EgZ2VuZSAoJHA9JCBgciBmb3JtYXQoYW5vdmEoYnJjYUxvZ2l0LHRlc3Q9IkNoaXNxIilbMiwiUHIoPkNoaSkiXSxkaWdpdHM9MylgKS4KRGUgcC12YWx1ZSBpcyBhbG1vc3QgZXF1aXZhbGVudCB0byB0aGUgb25lIG9mIHRoZSAgJFxjaGleMiQtdGVzdCAoc2VlIHByZXZpb3VzIHNlY3Rpb24pLgoKLS0tCgotIFNpZ25pZmljYW50IGFzc29jaWF0aW9uPwoKICAgIC0gUG9zdC1ob2MgdGVzdHMgdG8gZXZhbHVhdGUgd2hpY2ggb2YgdGhlIG9kZHMgcmF0aW9zIGFyZSBkaWZmZXJlbnQgZnJvbSAxLgogICAgLSBGb3IgQlJDQTEgZXhhbXBsZSB3ZSBkaWQgbm90IHJlamVjdCB0aGUgb21uaWJ1cyBoeXBvdGhlc2lzIHNvIG5vIHBvc3QtaG9jIGFuYWx5c2lzCiAgICAtIEZvciB5b3VyIHJlZmVyZW5jZSB3ZSBpbmNsdWRlIHRoZSBwb3N0IGhvYyBhbmFseXNpcyBzbyB0aGF0IHlvdSB3b3VsZCBoYXZlIHRoZSBjb2RlLgoKLS0tCgpgYGB7cn0Kc3VwcHJlc3NQYWNrYWdlU3RhcnR1cE1lc3NhZ2VzKHsKICBsaWJyYXJ5KG11bHRjb21wKQp9KQpwb3N0aG9jIDwtIGdsaHQoYnJjYUxvZ2l0LCBsaW5mY3QgPSBtY3AodmFyaWFudCA9ICJUdWtleSIpKQpwb3N0aG9jVGVzdHMgPC0gc3VtbWFyeShwb3N0aG9jKQpwb3N0aG9jVGVzdHMKYGBgCgotLS0KCmBgYHtyfQpwb3N0aG9jQ0kgPC0gY29uZmludChwb3N0aG9jKQpwb3N0aG9jQ0kKYGBgCi0gV2l0aCB0aGUgYGNvbmZpbnRgIGZ1bmN0aW9uIENJIGFyZSBvYnRhaW5lZCBvbiB0aGUgbG9nLW9kZHMgcmF0aW9zIGNvcnJlY3RlZCBmb3IgbXVsdGlwbGUgdGVzdGluZy4KCi0tLQoKLSBDSSdzIGNhbiBiZSBiYWNrdHJhbnNmb3JtZWQgdG8gb2RkcyByYXRpb3M6CgpgYGB7cn0KT1IgPC0gZXhwKHBvc3Rob2NDSSRjb25maW50KQpPUgpgYGAKCi0gRGUgb2RkcyByYXRpb3MgdGhhdCB3ZSBvYnRhaW4gaXMgZXhhY3RseSBlcXVhbCB0byB0aGUgb25lIHdlIGNhbGN1bGF0ZWQgYmFzZWQgb24gdGhlIGNvbnRpbmdlbmN5IHRhYmxlOgotIGUuZyAgJFx0ZXh0e09SfV9cdGV4dHtMZXUvTGV1LVByby9Qcm99PTg5XHRpbWVzIDI2Ni8oNTZcdGltZXMgMzQyKT0kIGByIGZvcm1hdCgoODkvNTYpLygzNDIvMjY2KSxkaWdpdHM9NClgLgoKLSBOb3RlLCB0aGF0IHN0YXRpc3RpY2FsIGluZmVyZW5jZSBmb3IgbG9naXN0aWMgcmVncmVzc2lvbiByZWxpZXMgb24gYXN5bXB0b3RpYyB0aGVvcnkuCgotLS0KCiMjIENvbnRpbnVvdXMgUHJlZGljdG9yCgotIFRveGljb2xvY2FsIGVmZmVjdCBvZiBjYXJib24gZGlzdWxmaXRlIChDUyRfMiQpIG9uIGJlZXRsZXMuCi0gUmVzZWFyY2ggaHlwb3RoZXNpcyBpcyB0aGVyZSBhbiBlZmZlY3Qgb2YgdGhlICBDUyRfMiQgY29uY2VudHJhdGlvbiBvbiB0aGUgbW9ydGFsaXR5IG9mIGJlZXRsZXM/CgpEZXNpZ246CgotIDMyIGluZGVwZW5kZW50IGV4cGVyaW1lbnRzCi0gRWFjaCB0aW1lIDEgYmVhdGxlIGlzIGV4cG9zZWQgdG8gb25lIG9mIDggQ1MkXzIkIGNvbmNlbnRyYXRpb25zIChtZy9sKS4KLSBUaGUgb3V0Y29tZTogbW9ydGFsaXR5ICgkeT0xJCkgb3Igc3Vydml2YWwgKCR5PTAkKS4KCmBgYHtyfQpiZWV0bGVzIDwtIHJlYWRfY3N2KCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vR1RQQi9QU0xTMjAvbWFzdGVyL2RhdGEvYmVldGxlcy5jc3YiKQpoZWFkKGJlZXRsZXMpCnRhYmxlKGJlZXRsZXMkZG9zZSwgYmVldGxlcyRzdGF0dXMpCmBgYAoKLS0tCgpXZSBidWlsZCBhIG1vZGVsIGZvciB0aGUgbG9nIG9kZHMgaW4gZnVuY3Rpb24gb2YgdGhlIGRvc2UgJHhfaSQ6CiQkXGxvZyBcZnJhY3tccGlfaX17MS1ccGlfaX09XGJldGFfMCtcYmV0YV8xIFx0aW1lcyB4X2kuJCQKCmBgYHtyfQpiZWF0bGVNb2RlbCA8LSBnbG0oc3RhdHVzIH4gZG9zZSwgZGF0YSA9IGJlZXRsZXMsIGZhbWlseSA9IGJpbm9taWFsKQpzdW1tYXJ5KGJlYXRsZU1vZGVsKQpgYGAKCi0tLQoKLSBJbnRlcmNlcHQgaGFzIGFuIGludGVycHJldGF0aW9uIG9mIGEgbG9nIG9kZHMgb24gbW9ydGFsaXR5IHdoZW4gbm8gJFx0ZXh0e0NTfV8yJCBnYXMgaXMgYXBwbGllZC4KLSBWZXJ5IHNtYWxsIG9kZHMgb24gbW9ydGFsaXR5ICgkXHBpLygxLVxwaSk9XGV4cCgtNTMuMikkKSBzbyB0aGUgcHJvYmFiaWxpdHkgaXMgYWxtb3N0IDAuCi0gTm90ZSB0aGF0IHRoaXMgaXMgYSB2ZXJ5IGxhcmdlIGV4dHJhcG9sYXRpb246IG1pbmltdW0gZG9zZSBpbiBkYXRhc2V0IGlzIGByIG1pbihiZWV0bGVzJGRvc2UpYCBtZy9sLgoKCi0gRXN0aW1hdGVkIG9kZHMgcmF0aW8gZm9yIHRoZSBlZmZlY3Qgb2YgZG9zZSBvbiB0aGUgbW9ydGFsaXR5IHByb2JhYmlsaXR5IGlzICRcZXhwKDAuMzAxMyk9MS4zNSQuCi0gU28gYSBiZWF0bGUgZXhwb3NlZCB0byBhIENTJF8yJCBjb25jZW50cmF0aW9uIHRoYXQgaXMgMSBtZy9sIGxhcmdlciB0aGFuIGFub3RoZXIgYmVhdGxlLCB3aWxsIG9uIGF2ZXJhZ2UgaGF2ZSBhbiBvZGRzIHJhdGlvIG9uIG1vcnRhbGl0eSBvZiAkMS4zNSQuCgotLS0KCi0gV2UgY29uY2x1ZGUgdGhhdCB0aGlzIGVmZmVjdCBpcyB2ZXJ5IHNpZ25pZmljYW50ICgkcD0kIGByIHJvdW5kKHN1bW1hcnkoYmVhdGxlTW9kZWwpJGNvZWZbMiw0XSwzKWApLgotIEluY3JlYXNpbmcgdGhlIENTJF8yJCBkb3NlIGluY3JlYXNlcyB0aGUgbW9ydGFsaXR5LgoKCmBgYHtyfQoKYmVldGxlc1RhYiA8LSB0YWJsZShiZWV0bGVzKSAlPiUgZGF0YS5mcmFtZSgpCgpkYXRhLmZyYW1lKGdyaWQgPSBzZXEobWluKGJlZXRsZXMkZG9zZSksIG1heChiZWV0bGVzJGRvc2UpLCAuMSkpICU+JQogIG11dGF0ZShwaUhhdCA9IHByZWRpY3QoYmVhdGxlTW9kZWwsCiAgICBuZXdkYXRhID0gZGF0YS5mcmFtZShkb3NlID0gZ3JpZCksCiAgICB0eXBlID0gInJlc3BvbnNlIgogICkpICU+JQogIGdncGxvdChhZXMoZ3JpZCwgcGlIYXQpKSArCiAgZ2VvbV9saW5lKCkgKwogIHhsYWIoImRvc2UiKSArCiAgeWxhYigicHJvYmFiaWxpdHkgKGRlYWQpIikgKwogIGdlb21fdGV4dChhZXMoeCA9IGRvc2UgJT4lIGFzLmNoYXJhY3RlcigpICU+JSBhcy5kb3VibGUoKSwgeSA9IHN0YXR1cyAlPiUgYXMuY2hhcmFjdGVyKCkgJT4lIGFzLmRvdWJsZSgpLCBsYWJlbCA9IEZyZXEpLCBiZWV0bGVzVGFiICU+JSBmaWx0ZXIoc3RhdHVzID09IDApKSArCiAgZ2VvbV90ZXh0KGFlcyh4ID0gZG9zZSAlPiUgYXMuY2hhcmFjdGVyKCkgJT4lIGFzLmRvdWJsZSgpLCB5ID0gc3RhdHVzICU+JSBhcy5jaGFyYWN0ZXIoKSAlPiUgYXMuZG91YmxlKCksIGxhYmVsID0gRnJlcSksIGJlZXRsZXNUYWIgJT4lIGZpbHRlcihzdGF0dXMgPT0gMSkpCmBgYAo=</div>
<div class="footer">
    <hr>
    This work is licensed under the <a href= "https://creativecommons.org/licenses/by-nc-sa/4.0">
    CC BY-NC-SA 4.0</a> licence.
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("10-categoricalDataAnalysis.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
