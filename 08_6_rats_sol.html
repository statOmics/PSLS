<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Lieven Clement, Jeroen Gilis and Milan Malfait" />


<title>Exercise 8.6: Blocking on the rat diet dataset - solution</title>

<script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01-intro.html">1. Introduction</a>
    </li>
    <li>
      <a href="02-concepts.html">2. Concepts</a>
    </li>
    <li>
      <a href="03-experimentalDesign.html">3. Experimental Design I</a>
    </li>
    <li>
      <a href="04-dataExploration.html">4. Data Exploration</a>
    </li>
    <li>
      <a href="05-statisticalInference.html">5.1 Statistical Inference 1</a>
    </li>
    <li>
      <a href="05-statisticalInference-twosampleT.html">5.2 Statistical Inference 2</a>
    </li>
    <li>
      <a href="06-linearRegression.html">6. Linear Regression</a>
    </li>
    <li>
      <a href="07-Anova.html">7. Analysis of Variance</a>
    </li>
    <li>
      <a href="08-MultipleRegression.html">8. Multiple Regression</a>
    </li>
    <li>
      <a href="08-MultipleRegression-SpecificDesigns.html">8.2 Multiple Regression: Factorial Designs</a>
    </li>
    <li>
      <a href="08-experimentalDesign2.html">8.3. Experimental Design II</a>
    </li>
    <li>
      <a href="08-experimentalDesign3.html">8.4. Experimental Design III</a>
    </li>
    <li>
      <a href="09-NonparametericStatistics-WilcoxonMannWithney.html">9.1. Nonparametric Statistics 1</a>
    </li>
    <li>
      <a href="09-NonparametericStatistics-KruskalWallis.html">9.2. Nonparametric Statistics 2</a>
    </li>
    <li>
      <a href="10-categoricalDataAnalysis.html">10. Categorical Data Analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-laptop"></span>
     
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="04_exercises.html">4. Data Exploration</a>
    </li>
    <li>
      <a href="05_exercises.html">5. Statistical inference</a>
    </li>
    <li>
      <a href="06_exercises.html">6. Simple linear regression</a>
    </li>
    <li>
      <a href="07_exercises.html">7. ANOVA</a>
    </li>
    <li>
      <a href="08_exercises.html">8. Multiple linear regression</a>
    </li>
    <li>
      <a href="09_exercises.html">9. Non-parametric statistics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/statOmics/PSLS">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://statomics.github.io/">statOmics</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Exercise 8.6: Blocking on the rat diet dataset - solution</h1>
<h4 class="author">Lieven Clement, Jeroen Gilis and Milan Malfait</h4>
<h4 class="date">statOmics, Ghent University (<a href="https://statomics.github.io" class="uri">https://statomics.github.io</a>)</h4>

</div>


<div id="background" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Background</h1>
<p>Researchers are studying the impact of protein sources and protein levels in the diet on the weight of rats. They feed the rats with diets of beef, cereal and pork and use a low and high protein level for each diet type. The researchers can include 60 rats in the experiment. Prior to the experiment, the rats were divided in 10 homogeneous groups of 6 rats based on characteristics such as initial weight, appetite, etc.</p>
<p>Within each group a rat is randomly assigned to a diet. The rats are fed during a month and the weight gain in grams is recorded for each rat.</p>
</div>
<div id="experimental-design" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Experimental design</h1>
<ul>
<li><p>There are three explanatory variables in the experiment: the factor diet type with three levels (beef, cereal and pork), factor protein level with levels (low and high) and a group blocking factor with 10 levels.</p></li>
<li><p>There are 6 treatments: beef-high, cereal-high, pork-high, beef-low, cereal-low, pork-low protein.</p></li>
<li><p>The rats are the experimental and observational units.</p></li>
<li><p>The weight gain is the response variable.</p></li>
<li><p>The experiment is a randomized complete block (RCB) design</p></li>
</ul>
<p>Load libraries</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
</div>
<div id="data-import" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Data import</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>diet <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/statOmics/PSLS21/data/dietRats.txt&quot;</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">header =</span> <span class="cn">TRUE</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(diet)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["weightGain"],"name":[1],"type":["int"],"align":["right"]},{"label":["protSource"],"name":[2],"type":["chr"],"align":["left"]},{"label":["protLevel"],"name":[3],"type":["chr"],"align":["left"]},{"label":["block"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"107","2":"b","3":"h","4":"1","_rn_":"1"},{"1":"96","2":"c","3":"h","4":"1","_rn_":"2"},{"1":"112","2":"p","3":"h","4":"1","_rn_":"3"},{"1":"83","2":"b","3":"l","4":"1","_rn_":"4"},{"1":"87","2":"c","3":"l","4":"1","_rn_":"5"},{"1":"90","2":"p","3":"l","4":"1","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="tidy-data" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Tidy data</h1>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>diet <span class="ot">&lt;-</span> diet <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Convert categorical levels to factors</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">block =</span> <span class="fu">as.factor</span>(block),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">protSource =</span> <span class="fu">as.factor</span>(protSource),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">protLevel =</span> <span class="fu">as.factor</span>(protLevel)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Recode factors to make them more verbose</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">protLevel =</span> <span class="fu">fct_recode</span>(protLevel, <span class="at">high =</span> <span class="st">&quot;h&quot;</span>, <span class="at">low =</span> <span class="st">&quot;l&quot;</span>),</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">protSource =</span> <span class="fu">fct_recode</span>(protSource, <span class="at">beef =</span> <span class="st">&quot;b&quot;</span>, <span class="at">cereal =</span> <span class="st">&quot;c&quot;</span>, <span class="at">pork =</span> <span class="st">&quot;p&quot;</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Set &quot;low&quot; as the reference level for `protLevel`</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">protLevel =</span> <span class="fu">fct_relevel</span>(protLevel, <span class="st">&quot;low&quot;</span>))</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(diet)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["weightGain"],"name":[1],"type":["int"],"align":["right"]},{"label":["protSource"],"name":[2],"type":["fct"],"align":["left"]},{"label":["protLevel"],"name":[3],"type":["fct"],"align":["left"]},{"label":["block"],"name":[4],"type":["fct"],"align":["left"]}],"data":[{"1":"107","2":"beef","3":"high","4":"1","_rn_":"1"},{"1":"96","2":"cereal","3":"high","4":"1","_rn_":"2"},{"1":"112","2":"pork","3":"high","4":"1","_rn_":"3"},{"1":"83","2":"beef","3":"low","4":"1","_rn_":"4"},{"1":"87","2":"cereal","3":"low","4":"1","_rn_":"5"},{"1":"90","2":"pork","3":"low","4":"1","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="data-exploration" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Data exploration</h1>
<ul>
<li>Boxplot of the weight gain against protein source, protein level with coloring according to block</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>diet <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> protLevel, <span class="at">y =</span> weightGain)) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;RdGy&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> block)) <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Weight gain dependence on protein source&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Protein level&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Weight gain (g)&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> mean, <span class="at">geom=</span><span class="st">&quot;point&quot;</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span><span class="dv">5</span>, <span class="at">size=</span><span class="dv">3</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(protSource))</span></code></pre></div>
<p><img src="08_6_rats_sol_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<ul>
<li>Lineplot of the weight gain against protein source, protein level with coloring and grouping according to block</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>diet <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> protLevel, <span class="at">y =</span> weightGain, <span class="at">color =</span> block)) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;RdGy&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> block)) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Weight gain dependence on protein source&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Weight gain (g)&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(protSource))</span></code></pre></div>
<p><img src="08_6_rats_sol_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<ul>
<li><p>An increase in the weight of the rats seems to depend on the protein source received in the diet.</p></li>
<li><p>The increase in the weight of the rats seems to depend on the level of protein received in the diet</p></li>
<li><p>There also seems to be an interaction effect between the protein level and the protein source on the gain in weight of the rats. For the beef and the pork diets the effect of high protein levels in the data seems to be much stronger than in the cereal diet.</p></li>
<li><p>There is also a strong effect of the block. Blocking implies a randomisation restriction, hence, we will have to include the block effect anyway.</p></li>
</ul>
</div>
<div id="multivariate-linear-regression-analysis" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Multivariate linear regression analysis</h1>
<div id="assumptions" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Assumptions</h2>
<p>List assumptions:</p>
<ol style="list-style-type: decimal">
<li>The observations are independent</li>
<li>Linearity between the response and predictor variable</li>
<li>The residuals of the model must be normally distributed</li>
<li>Homoscedasticity of the data</li>
</ol>
<p>The first assumption is met if we correct for block in the model because the rats were randomized to the treatment within block. The other three assumptions can be assessed by fitting the linear model and calling the <code>plot()</code> function as follows.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weightGain <span class="sc">~</span> block <span class="sc">+</span> protSource <span class="sc">*</span> protLevel, <span class="at">data =</span> diet)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm1)</span></code></pre></div>
<p><img src="08_6_rats_sol_files/figure-html/unnamed-chunk-6-1.png" width="672" /><img src="08_6_rats_sol_files/figure-html/unnamed-chunk-6-2.png" width="672" /><img src="08_6_rats_sol_files/figure-html/unnamed-chunk-6-3.png" width="672" /><img src="08_6_rats_sol_files/figure-html/unnamed-chunk-6-4.png" width="672" /></p>
<p>All assumptions are met for this dataset.</p>
</div>
<div id="hypothesis-testing" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Hypothesis testing</h2>
<p>We here fit a linear model with a blocking factor for <code>block</code> and main and interaction effects for protein source and protein level.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weightGain ~ block + protSource * protLevel, data = diet)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -21.017  -5.183  -1.017   4.092  18.983 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                     88.3500     4.1728  21.173  &lt; 2e-16
## block2                          -9.1667     4.8183  -1.902 0.063520
## block3                          -4.8333     4.8183  -1.003 0.321166
## block4                         -20.3333     4.8183  -4.220 0.000117
## block5                          -9.3333     4.8183  -1.937 0.059031
## block6                           0.6667     4.8183   0.138 0.890572
## block7                         -31.3333     4.8183  -6.503 5.58e-08
## block8                         -10.1667     4.8183  -2.110 0.040450
## block9                         -19.8333     4.8183  -4.116 0.000162
## block10                         -0.1667     4.8183  -0.035 0.972559
## protSourcecereal                 1.1000     3.7322   0.295 0.769556
## protSourcepork                   1.3000     3.7322   0.348 0.729226
## protLevelhigh                   20.0000     3.7322   5.359 2.76e-06
## protSourcecereal:protLevelhigh -18.2000     5.2782  -3.448 0.001236
## protSourcepork:protLevelhigh    -1.7000     5.2782  -0.322 0.748883
##                                   
## (Intercept)                    ***
## block2                         .  
## block3                            
## block4                         ***
## block5                         .  
## block6                            
## block7                         ***
## block8                         *  
## block9                         ***
## block10                           
## protSourcecereal                  
## protSourcepork                    
## protLevelhigh                  ***
## protSourcecereal:protLevelhigh ** 
## protSourcepork:protLevelhigh      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8.346 on 45 degrees of freedom
## Multiple R-squared:  0.7712, Adjusted R-squared:    0.7 
## F-statistic: 10.83 on 14 and 45 DF,  p-value: 3.726e-10</code></pre>
</div>
<div id="interpretation-of-the-regression-parameters" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Interpretation of the regression parameters</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ExploreModelMatrix)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>ExploreModelMatrix<span class="sc">::</span><span class="fu">VisualizeDesign</span>(diet, <span class="sc">~</span> block <span class="sc">+</span> protSource <span class="sc">*</span> protLevel)<span class="sc">$</span>plotlist</span></code></pre></div>
<pre><code>## $`block = 1`</code></pre>
<p><img src="08_6_rats_sol_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre><code>## 
## $`block = 10`</code></pre>
<p><img src="08_6_rats_sol_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<pre><code>## 
## $`block = 2`</code></pre>
<p><img src="08_6_rats_sol_files/figure-html/unnamed-chunk-8-3.png" width="672" /></p>
<pre><code>## 
## $`block = 3`</code></pre>
<p><img src="08_6_rats_sol_files/figure-html/unnamed-chunk-8-4.png" width="672" /></p>
<pre><code>## 
## $`block = 4`</code></pre>
<p><img src="08_6_rats_sol_files/figure-html/unnamed-chunk-8-5.png" width="672" /></p>
<pre><code>## 
## $`block = 5`</code></pre>
<p><img src="08_6_rats_sol_files/figure-html/unnamed-chunk-8-6.png" width="672" /></p>
<pre><code>## 
## $`block = 6`</code></pre>
<p><img src="08_6_rats_sol_files/figure-html/unnamed-chunk-8-7.png" width="672" /></p>
<pre><code>## 
## $`block = 7`</code></pre>
<p><img src="08_6_rats_sol_files/figure-html/unnamed-chunk-8-8.png" width="672" /></p>
<pre><code>## 
## $`block = 8`</code></pre>
<p><img src="08_6_rats_sol_files/figure-html/unnamed-chunk-8-9.png" width="672" /></p>
<pre><code>## 
## $`block = 9`</code></pre>
<p><img src="08_6_rats_sol_files/figure-html/unnamed-chunk-8-10.png" width="672" /></p>
<p>There are 3 levels for protein source, 2 levels for protein level and 10 levels for the blocking variable. We will have one reference level for each respective variable: beef, low, block 1. So we need 2, 1 and 9 dummy variables to introduce the factors protein source, protein level and block in the linear model, respectively.</p>
<p>Hence, we can write down the linear model as follows:</p>
<p><span class="math inline">\(y_i=\beta_0+\beta_cx_{i,c} +\beta_px_{i,p}+\beta_hx_{i,h}+\beta_{ch}x_{i,c}x_{i,h}+\beta_{ph}x_{i,p}x_{i,h}+\beta_{b2}x_{i,b2}+\ldots+\beta_{b10}x_{i,b10}+\epsilon_{i}\)</span></p>
<p>with: <span class="math inline">\(y_i\)</span> the observed weight gain for rat i, <span class="math inline">\(x_{i,h}\)</span> a dummy variable which is 1 if rat i receives a high protein diet and is 0 otherwise, <span class="math inline">\(x_{i,c}\)</span> a dummy variable which is 1 if rat i receives a cereal diet and is 0 otherwise, <span class="math inline">\(x_{i,p}\)</span> a dummy variable which is 1 if rat i receives a pork diet and is 0 otherwise and <span class="math inline">\(x_{i,bk}\)</span> is a dummy variable which is 1 if rat i belongs to block <span class="math inline">\(bk\)</span> and is 0 otherwise, with <span class="math inline">\(k \in 2,\ldots, 10\)</span>, and <span class="math inline">\(\epsilon_i\)</span> an error term which is normally distributed with mean 0 and variance <span class="math inline">\(\sigma^2\)</span>, i.e. <span class="math inline">\(\epsilon_i \sim N(0,\sigma^2)\)</span>.</p>
<ul>
<li><p>Rats that are assigned to block <span class="math inline">\(k\)</span> and receive a beef based low protein diet have a covariate pattern <span class="math inline">\(x_{i,h}=0\)</span>, <span class="math inline">\(x_{i,c}=0\)</span>, <span class="math inline">\(x_{i,p}=0\)</span>, <span class="math inline">\(x_{i,bm}=0\)</span> with <span class="math inline">\(m\neq k\)</span> and <span class="math inline">\(x_{i,bk}=1\)</span>. Their mean weight gain is thus equal to <span class="math inline">\(\mu_{l,b,bk}=\beta_0+\beta_{bk}\)</span></p></li>
<li><p>Rats that are assigned to block <span class="math inline">\(k\)</span> and receive a beef based high protein diet have a covariate pattern <span class="math inline">\(x_{i,h}=1\)</span>, <span class="math inline">\(x_{i,c}=0\)</span>, <span class="math inline">\(x_{i,p}=0\)</span>, <span class="math inline">\(x_{i,bm}=0\)</span> with <span class="math inline">\(m\neq k\)</span> and <span class="math inline">\(x_{i,bk}=1\)</span>. Their mean weight gain is thus equal to <span class="math inline">\(\mu_{h,b,bk}=\beta_0+\beta_h+\beta_{bk}\)</span></p></li>
<li><p>Rats that are assigned to block <span class="math inline">\(k\)</span> and receive a cereal based low protein diet have a covariate pattern <span class="math inline">\(x_{i,h}=0\)</span>, <span class="math inline">\(x_{i,c}=1\)</span>, <span class="math inline">\(x_{i,p}=0\)</span>, <span class="math inline">\(x_{i,bm}=0\)</span> with <span class="math inline">\(m\neq k\)</span> and <span class="math inline">\(x_{i,bk}=1\)</span>. Their mean weight gain is thus equal to <span class="math inline">\(\mu_{h,c,bk}=\beta_0+\beta_c+\beta_{bk}\)</span></p></li>
<li><p>Rats that are assigned to block <span class="math inline">\(k\)</span> and receive a cereal based heigh protein diet have a covariate pattern <span class="math inline">\(x_{i,h}=1\)</span>, <span class="math inline">\(x_{i,c}=1\)</span>, <span class="math inline">\(x_{i,p}=0\)</span>, <span class="math inline">\(x_{i,bm}=0\)</span> with <span class="math inline">\(m\neq k\)</span> and <span class="math inline">\(x_{i,bk}=1\)</span>. Their mean weight gain is thus equal to <span class="math inline">\(\mu_{h,c,bk}=\beta_0+\beta_h+\beta_c+\beta_{ch}+\beta_{bk}\)</span></p></li>
<li><p>Rats that are assigned to block <span class="math inline">\(k\)</span> and receive a pork based low protein diet have a covariate pattern <span class="math inline">\(x_{i,h}=0\)</span>, <span class="math inline">\(x_{i,c}=0\)</span>, <span class="math inline">\(x_{i,p}=1\)</span>, <span class="math inline">\(x_{i,bm}=0\)</span> with <span class="math inline">\(m\neq k\)</span> and <span class="math inline">\(x_{i,bk}=1\)</span>. Their mean weight gain is thus equal to <span class="math inline">\(\mu_{l,p,bk}=\beta_0+\beta_p+\beta_{bk}\)</span></p></li>
<li><p>Rats that are assigned to block <span class="math inline">\(k\)</span> and receive a pork based heigh protein diet have a covariate pattern <span class="math inline">\(x_{i,h}=1\)</span>, <span class="math inline">\(x_{i,c}=0\)</span>, <span class="math inline">\(x_{i,p}=1\)</span>, <span class="math inline">\(x_{i,bm}=0\)</span> with <span class="math inline">\(m\neq k\)</span> and <span class="math inline">\(x_{i,bk}=1\)</span>. There mean weight gain is thus equal to <span class="math inline">\(\mu_{h,p,bk}=\beta_0+\beta_h+\beta_p+\beta_{ph}+\beta_{bk}\)</span></p></li>
</ul>
<p>We can now relate this to the output of the <code>lm</code> function:</p>
<ul>
<li><p>The intercept <span class="math inline">\(\beta_0\)</span> is thus the average weight increase in the low beef diet for rats in block 1.</p></li>
<li><p>The parameter <span class="math inline">\(\beta_c\)</span>: the average difference in weight gain between cereal-low and beef-low diet is 1.1g.</p></li>
<li><p>The parameter <span class="math inline">\(\beta_p\)</span>: the average difference in weight gain between pork-low and beef-low diet is 1.3g.</p></li>
<li><p>The parameter <span class="math inline">\(\beta_h\)</span>: the average difference in weight gain between beef-high and beef-Low diet is 20g.</p></li>
<li><p>The parameter <span class="math inline">\(\beta_{ch}\)</span> is the difference in the average weight gain difference due to the high protein level as compared to the low protein level for cereal diets as compared to the weight gain difference that occurs due to the protein level in the reference class (here beef diet). Here this is negative, i.e. -18.2g, thus the weight gain for the cereal protein source increases on average less between high and low protein diets than in beef based diets.</p></li>
<li><p>The parameter <span class="math inline">\(\beta_{ph}\)</span> is the difference in the average weight gain difference due to the high protein level as compared to the low protein level for pork diets as compared to the weight gain difference that occurs due to the protein level in the reference class (here beef diet). Here this is negative, i.e. -1.7g, thus the weight gain for the proc protein source increases on average less between high and low protein diets than in beef based diets.</p></li>
</ul>
</div>
<div id="testing-the-overall-combined-effect-of-diet" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Testing the overall (combined) effect of diet</h2>
<p>Because there are multiple factors with different levels in the model, we can first assess the effect of the diet (protein Level, protein source and the interaction) by using anova. With this test we will assess the null hypothesis that the average weight gain in each treatment is equal: i.e. <span class="math inline">\(H_0: \mu_{b,l}=\mu_{b,h}=\mu_{c,h}=\mu_{c,l}=\mu_{p,h}=\mu_{p,h}\)</span> versus the alternative hyptohesis <span class="math inline">\(H_1:\)</span> that at least two treatment means are different.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>lm0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weightGain <span class="sc">~</span> block, <span class="at">data =</span> diet)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm0, lm1)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"50","2":"7728.833","3":"NA","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"45","2":"3134.150","3":"5","4":"4594.683","5":"13.19406","6":"6.308133e-08","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>We can conclude that there is an extremely significant effect of the diet type (protein source and/or protein level and/or protein source-protein level interaction) on the weight gain of rats (p &lt;&lt; 0.001).</p>
</div>
<div id="assessing-the-interaction-effect-between-protein-source-and-protein-level" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Assessing the interaction effect between protein source and protein level</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(lm1, <span class="at">type =</span> <span class="st">&quot;III&quot;</span>)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Sum Sq"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"31222.890","2":"1","3":"448.297002","4":"4.955763e-25","_rn_":"(Intercept)"},{"1":"5969.350","2":"9","3":"9.523076","4":"6.083601e-08","_rn_":"block"},{"1":"9.800","2":"2","3":"0.070354","4":"9.321661e-01","_rn_":"protSource"},{"1":"2000.000","2":"1","3":"28.715920","4":"2.762595e-06","_rn_":"protLevel"},{"1":"1010.633","2":"2","3":"7.255316","4":"1.857393e-03","_rn_":"protSource:protLevel"},{"1":"3134.150","2":"45","3":"NA","4":"NA","_rn_":"Residuals"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>There is a very significant interaction between the protein source and the protein level (p = 2e-03). This indicates that the average weight increase due to the protein level differs according to the protein source. Hence, we cannot assess the effect of the protein source and/or protein level independently because there effects of the protein source vary according to the protein level.</p>
</div>
<div id="assessing-specific-contrasts" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> Assessing specific contrasts</h2>
<p>Imagine that we are interested in assessing if there is an effect of</p>
<ol style="list-style-type: decimal">
<li>protein source in the low protein diets
<ul>
<li><span class="math inline">\(\mu_{c,l}-\mu_{b,l} = \beta_c\)</span></li>
<li><span class="math inline">\(\mu_{p,l}-\mu_{b,l} = \beta_p\)</span></li>
<li><span class="math inline">\(\mu_{c,l}-\mu_{p,l}= \beta_c-\beta_p\)</span>)</li>
</ul></li>
<li>protein source in high protein diets
<ul>
<li><span class="math inline">\(\mu_{c,h}-\mu_{b,h}=\beta_c+\beta_{ch}\)</span></li>
<li><span class="math inline">\(\mu_{p,h}-\mu_{b,h}=\beta_p+\beta_{ph}\)</span></li>
<li><span class="math inline">\(\mu_{p,h}-\mu_{c,h}=(\beta_c+\beta_{ch})-(\beta_p+\beta_{ph})\)</span></li>
</ul></li>
<li>protein level for
<ul>
<li>beef diets (<span class="math inline">\(\mu_{b,h}-\mu_{b,l}=\beta_h\)</span>),</li>
<li>cereal diets (<span class="math inline">\(\mu_{c,h}-\mu_{c,l}=\beta_h+\beta_{ch}\)</span>) and</li>
<li>pork diets (<span class="math inline">\(\mu_{p,h}-\mu_{p,l}=\beta_h+\beta_{ph}\)</span>).</li>
</ul></li>
<li>If the effect of the protein level differs between
<ul>
<li>beef and cereal <span class="math inline">\((\mu_{c,h}-\mu_{c,l}) - (\mu_{b,h}-\mu_{b,l})=\beta_{ch}\)</span></li>
<li>beef and pork <span class="math inline">\((\mu_{p,h}-\mu_{p,l}) - (\mu_{c,h}-\mu_{c,l})=\beta_{ph}\)</span> and</li>
<li>cereal and pork diets <span class="math inline">\((\mu_{c,h}-\mu_{c,l}) - (\mu_{p,h}-\mu_{p,l})=\beta_{ch}-\beta_{ph}\)</span>.</li>
</ul></li>
</ol>
<p>These effects of interest are so-called <strong>contrasts, i.e. linear combinations of the parameters</strong>.</p>
<p>We can define the contrasts and assess the significance of the contrasts with the code below. The contrasts are given as input in the form of symbolic descriptions to the <code>linfct</code> argument of the <code>glht</code> function.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">75468</span>) <span class="co"># to get reproducible results (small effect if removed)</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>lm1MultComp <span class="ot">&lt;-</span> <span class="fu">glht</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> lm1,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">linfct =</span> <span class="fu">c</span>(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;protSourcecereal = 0&quot;</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;protSourcepork = 0&quot;</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;protSourcecereal- protSourcepork = 0&quot;</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;protSourcecereal + protSourcecereal:protLevelhigh = 0&quot;</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;protSourcepork + protSourcepork:protLevelhigh = 0&quot;</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;(protSourcecereal + protSourcecereal:protLevelhigh) - (protSourcepork + protSourcepork:protLevelhigh) = 0&quot;</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;protLevelhigh = 0&quot;</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;protLevelhigh +  protSourcecereal:protLevelhigh = 0&quot;</span>,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;protLevelhigh +  protSourcepork:protLevelhigh = 0&quot;</span>,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;protSourcecereal:protLevelhigh = 0&quot;</span>,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;protSourcepork:protLevelhigh = 0&quot;</span>,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;protSourcecereal:protLevelhigh - protSourcepork:protLevelhigh = 0&quot;</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm1MultComp)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Fit: lm(formula = weightGain ~ block + protSource * protLevel, data = diet)
## 
## Linear Hypotheses:
##                                                                                                            Estimate
## protSourcecereal == 0                                                                                         1.100
## protSourcepork == 0                                                                                           1.300
## protSourcecereal - protSourcepork == 0                                                                       -0.200
## protSourcecereal + protSourcecereal:protLevelhigh == 0                                                      -17.100
## protSourcepork + protSourcepork:protLevelhigh == 0                                                           -0.400
## (protSourcecereal + protSourcecereal:protLevelhigh) - (protSourcepork + protSourcepork:protLevelhigh) == 0  -16.700
## protLevelhigh == 0                                                                                           20.000
## protLevelhigh + protSourcecereal:protLevelhigh == 0                                                           1.800
## protLevelhigh + protSourcepork:protLevelhigh == 0                                                            18.300
## protSourcecereal:protLevelhigh == 0                                                                         -18.200
## protSourcepork:protLevelhigh == 0                                                                            -1.700
## protSourcecereal:protLevelhigh - protSourcepork:protLevelhigh == 0                                          -16.500
##                                                                                                            Std. Error
## protSourcecereal == 0                                                                                           3.732
## protSourcepork == 0                                                                                             3.732
## protSourcecereal - protSourcepork == 0                                                                          3.732
## protSourcecereal + protSourcecereal:protLevelhigh == 0                                                          3.732
## protSourcepork + protSourcepork:protLevelhigh == 0                                                              3.732
## (protSourcecereal + protSourcecereal:protLevelhigh) - (protSourcepork + protSourcepork:protLevelhigh) == 0      3.732
## protLevelhigh == 0                                                                                              3.732
## protLevelhigh + protSourcecereal:protLevelhigh == 0                                                             3.732
## protLevelhigh + protSourcepork:protLevelhigh == 0                                                               3.732
## protSourcecereal:protLevelhigh == 0                                                                             5.278
## protSourcepork:protLevelhigh == 0                                                                               5.278
## protSourcecereal:protLevelhigh - protSourcepork:protLevelhigh == 0                                              5.278
##                                                                                                            t value
## protSourcecereal == 0                                                                                        0.295
## protSourcepork == 0                                                                                          0.348
## protSourcecereal - protSourcepork == 0                                                                      -0.054
## protSourcecereal + protSourcecereal:protLevelhigh == 0                                                      -4.582
## protSourcepork + protSourcepork:protLevelhigh == 0                                                          -0.107
## (protSourcecereal + protSourcecereal:protLevelhigh) - (protSourcepork + protSourcepork:protLevelhigh) == 0  -4.475
## protLevelhigh == 0                                                                                           5.359
## protLevelhigh + protSourcecereal:protLevelhigh == 0                                                          0.482
## protLevelhigh + protSourcepork:protLevelhigh == 0                                                            4.903
## protSourcecereal:protLevelhigh == 0                                                                         -3.448
## protSourcepork:protLevelhigh == 0                                                                           -0.322
## protSourcecereal:protLevelhigh - protSourcepork:protLevelhigh == 0                                          -3.126
##                                                                                                            Pr(&gt;|t|)
## protSourcecereal == 0                                                                                        0.9995
## protSourcepork == 0                                                                                          0.9989
## protSourcecereal - protSourcepork == 0                                                                       1.0000
## protSourcecereal + protSourcecereal:protLevelhigh == 0                                                       &lt;0.001
## protSourcepork + protSourcepork:protLevelhigh == 0                                                           1.0000
## (protSourcecereal + protSourcecereal:protLevelhigh) - (protSourcepork + protSourcepork:protLevelhigh) == 0   &lt;0.001
## protLevelhigh == 0                                                                                           &lt;0.001
## protLevelhigh + protSourcecereal:protLevelhigh == 0                                                          0.9949
## protLevelhigh + protSourcepork:protLevelhigh == 0                                                            &lt;0.001
## protSourcecereal:protLevelhigh == 0                                                                          0.0118
## protSourcepork:protLevelhigh == 0                                                                            0.9993
## protSourcecereal:protLevelhigh - protSourcepork:protLevelhigh == 0                                           0.0265
##                                                                                                               
## protSourcecereal == 0                                                                                         
## protSourcepork == 0                                                                                           
## protSourcecereal - protSourcepork == 0                                                                        
## protSourcecereal + protSourcecereal:protLevelhigh == 0                                                     ***
## protSourcepork + protSourcepork:protLevelhigh == 0                                                            
## (protSourcecereal + protSourcecereal:protLevelhigh) - (protSourcepork + protSourcepork:protLevelhigh) == 0 ***
## protLevelhigh == 0                                                                                         ***
## protLevelhigh + protSourcecereal:protLevelhigh == 0                                                           
## protLevelhigh + protSourcepork:protLevelhigh == 0                                                          ***
## protSourcecereal:protLevelhigh == 0                                                                        *  
## protSourcepork:protLevelhigh == 0                                                                             
## protSourcecereal:protLevelhigh - protSourcepork:protLevelhigh == 0                                         *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lm1MultComp)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Confidence Intervals
## 
## Fit: lm(formula = weightGain ~ block + protSource * protLevel, data = diet)
## 
## Quantile = 2.8765
## 95% family-wise confidence level
##  
## 
## Linear Hypotheses:
##                                                                                                            Estimate
## protSourcecereal == 0                                                                                        1.1000
## protSourcepork == 0                                                                                          1.3000
## protSourcecereal - protSourcepork == 0                                                                      -0.2000
## protSourcecereal + protSourcecereal:protLevelhigh == 0                                                     -17.1000
## protSourcepork + protSourcepork:protLevelhigh == 0                                                          -0.4000
## (protSourcecereal + protSourcecereal:protLevelhigh) - (protSourcepork + protSourcepork:protLevelhigh) == 0 -16.7000
## protLevelhigh == 0                                                                                          20.0000
## protLevelhigh + protSourcecereal:protLevelhigh == 0                                                          1.8000
## protLevelhigh + protSourcepork:protLevelhigh == 0                                                           18.3000
## protSourcecereal:protLevelhigh == 0                                                                        -18.2000
## protSourcepork:protLevelhigh == 0                                                                           -1.7000
## protSourcecereal:protLevelhigh - protSourcepork:protLevelhigh == 0                                         -16.5000
##                                                                                                            lwr     
## protSourcecereal == 0                                                                                       -9.6358
## protSourcepork == 0                                                                                         -9.4358
## protSourcecereal - protSourcepork == 0                                                                     -10.9358
## protSourcecereal + protSourcecereal:protLevelhigh == 0                                                     -27.8358
## protSourcepork + protSourcepork:protLevelhigh == 0                                                         -11.1358
## (protSourcecereal + protSourcecereal:protLevelhigh) - (protSourcepork + protSourcepork:protLevelhigh) == 0 -27.4358
## protLevelhigh == 0                                                                                           9.2642
## protLevelhigh + protSourcecereal:protLevelhigh == 0                                                         -8.9358
## protLevelhigh + protSourcepork:protLevelhigh == 0                                                            7.5642
## protSourcecereal:protLevelhigh == 0                                                                        -33.3827
## protSourcepork:protLevelhigh == 0                                                                          -16.8827
## protSourcecereal:protLevelhigh - protSourcepork:protLevelhigh == 0                                         -31.6827
##                                                                                                            upr     
## protSourcecereal == 0                                                                                       11.8358
## protSourcepork == 0                                                                                         12.0358
## protSourcecereal - protSourcepork == 0                                                                      10.5358
## protSourcecereal + protSourcecereal:protLevelhigh == 0                                                      -6.3642
## protSourcepork + protSourcepork:protLevelhigh == 0                                                          10.3358
## (protSourcecereal + protSourcecereal:protLevelhigh) - (protSourcepork + protSourcepork:protLevelhigh) == 0  -5.9642
## protLevelhigh == 0                                                                                          30.7358
## protLevelhigh + protSourcecereal:protLevelhigh == 0                                                         12.5358
## protLevelhigh + protSourcepork:protLevelhigh == 0                                                           29.0358
## protSourcecereal:protLevelhigh == 0                                                                         -3.0173
## protSourcepork:protLevelhigh == 0                                                                           13.4827
## protSourcecereal:protLevelhigh - protSourcepork:protLevelhigh == 0                                          -1.3173</code></pre>
<p>Note that the p-values and the confidence intervals are automatically corrected for multiple testing.</p>
</div>
</div>
<div id="conclusion" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Conclusion</h1>
<ul>
<li><p>There is an extremely significant effect of the type of protein diet on the weight gain of rats (p&lt;&lt;1e-6). The interaction between protein type and protein source is also very significant (p=0.0019).</p></li>
<li><p>The average weight gain does not vary significantly according to protein source in the diets with low protein levels (all p&gt;0.99).</p></li>
<li><p>The weight gain in the cereal diet at high protein concentration is on average 17.1g and 16.7g g lower than in the high protein beef and pork diet, respectively (95% CI [6.4, 27.8] and [6, 27.4]) and the differences are extremely significant (p&lt;0.001). The average weight gains after meat based diets at high protein levels, however, do not differ significantly (p&gt;0.99).</p></li>
<li><p>We also discovered an extremely significant difference in weight gain according to the protein level for beef and pork based diets (p&lt;0.001). The weight gain on average increases with 20g and 18.3g in the high protein level as compared to the low protein beef and pork diet, respectively (95%CI [9.3, 30.7] and [7.6, 29]). The protein level effect is not significant for the cereal diet (p&gt;0.99).</p></li>
<li><p>Finally significant interactions between protein level and protein source were found (p&lt;0.05), i.e. the increase in weight gain due to protein level in cereal based diets was 18.2g and 16.5g lower than that of beef and pork based diets, respectively (95% CI [3g,33.4g] and [1.3g,31.7g]). The average difference in increase in weight gain due to protein level among the meat based diets was not significant (p&gt;0.99).</p></li>
</ul>
<p>All reported p-values and confidence intervals were corrected for multiple testing</p>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiRXhlcmNpc2UgOC42OiBCbG9ja2luZyBvbiB0aGUgcmF0IGRpZXQgZGF0YXNldCAtIHNvbHV0aW9uIgphdXRob3I6ICJMaWV2ZW4gQ2xlbWVudCwgSmVyb2VuIEdpbGlzIGFuZCBNaWxhbiBNYWxmYWl0IgpkYXRlOiAic3RhdE9taWNzLCBHaGVudCBVbml2ZXJzaXR5IChodHRwczovL3N0YXRvbWljcy5naXRodWIuaW8pIgotLS0KCiMgQmFja2dyb3VuZAoKUmVzZWFyY2hlcnMgYXJlIHN0dWR5aW5nIHRoZSBpbXBhY3Qgb2YgcHJvdGVpbiBzb3VyY2VzIGFuZCBwcm90ZWluIGxldmVscyBpbgp0aGUgZGlldCBvbiB0aGUgd2VpZ2h0IG9mIHJhdHMuIFRoZXkgZmVlZCB0aGUgcmF0cyB3aXRoIGRpZXRzIG9mIGJlZWYsIGNlcmVhbAphbmQgcG9yayBhbmQgdXNlIGEgbG93IGFuZCBoaWdoIHByb3RlaW4gbGV2ZWwgZm9yIGVhY2ggZGlldCB0eXBlLgpUaGUgcmVzZWFyY2hlcnMgY2FuIGluY2x1ZGUgNjAgcmF0cyBpbiB0aGUgZXhwZXJpbWVudC4gUHJpb3IgdG8gdGhlIGV4cGVyaW1lbnQsCnRoZSByYXRzIHdlcmUgZGl2aWRlZCBpbiAxMCBob21vZ2VuZW91cyBncm91cHMgb2YgNiByYXRzIGJhc2VkIG9uCmNoYXJhY3RlcmlzdGljcyBzdWNoIGFzIGluaXRpYWwgd2VpZ2h0LCBhcHBldGl0ZSwgZXRjLgoKV2l0aGluIGVhY2ggZ3JvdXAgYSByYXQgaXMgcmFuZG9tbHkgYXNzaWduZWQgdG8gYSBkaWV0LiBUaGUgcmF0cyBhcmUgZmVkIGR1cmluZwphIG1vbnRoIGFuZCB0aGUgd2VpZ2h0IGdhaW4gaW4gZ3JhbXMgaXMgcmVjb3JkZWQgZm9yIGVhY2ggcmF0LgoKIyBFeHBlcmltZW50YWwgZGVzaWduCgotIFRoZXJlIGFyZSB0aHJlZSBleHBsYW5hdG9yeSB2YXJpYWJsZXMgaW4gdGhlIGV4cGVyaW1lbnQ6IHRoZSBmYWN0b3IgZGlldCB0eXBlCndpdGggdGhyZWUgbGV2ZWxzIChiZWVmLCBjZXJlYWwgYW5kIHBvcmspLCBmYWN0b3IgcHJvdGVpbiBsZXZlbCB3aXRoIGxldmVscwoobG93IGFuZCBoaWdoKSBhbmQgYSBncm91cCBibG9ja2luZyBmYWN0b3Igd2l0aCAxMCBsZXZlbHMuCgotIFRoZXJlIGFyZSA2IHRyZWF0bWVudHM6IGJlZWYtaGlnaCwgY2VyZWFsLWhpZ2gsIHBvcmstaGlnaCwgYmVlZi1sb3csCmNlcmVhbC1sb3csIHBvcmstbG93IHByb3RlaW4uCgotIFRoZSByYXRzIGFyZSB0aGUgZXhwZXJpbWVudGFsIGFuZCBvYnNlcnZhdGlvbmFsIHVuaXRzLgoKLSBUaGUgd2VpZ2h0IGdhaW4gaXMgdGhlIHJlc3BvbnNlIHZhcmlhYmxlLgoKLSBUaGUgZXhwZXJpbWVudCBpcyBhIHJhbmRvbWl6ZWQgY29tcGxldGUgYmxvY2sgKFJDQikgZGVzaWduCgpMb2FkIGxpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9CmxpYnJhcnkodGlkeXZlcnNlKQpgYGAKCiMgRGF0YSBpbXBvcnQKCmBgYHtyfQpkaWV0IDwtIHJlYWQudGFibGUoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9zdGF0T21pY3MvUFNMUzIxL2RhdGEvZGlldFJhdHMudHh0IiwKICBoZWFkZXIgPSBUUlVFCikKaGVhZChkaWV0KQpgYGAKCiMgVGlkeSBkYXRhCgpgYGB7cn0KZGlldCA8LSBkaWV0ICU+JQogICMjIENvbnZlcnQgY2F0ZWdvcmljYWwgbGV2ZWxzIHRvIGZhY3RvcnMKICBtdXRhdGUoCiAgICBibG9jayA9IGFzLmZhY3RvcihibG9jayksCiAgICBwcm90U291cmNlID0gYXMuZmFjdG9yKHByb3RTb3VyY2UpLAogICAgcHJvdExldmVsID0gYXMuZmFjdG9yKHByb3RMZXZlbCkKICApICU+JQogICMjIFJlY29kZSBmYWN0b3JzIHRvIG1ha2UgdGhlbSBtb3JlIHZlcmJvc2UKICBtdXRhdGUoCiAgICBwcm90TGV2ZWwgPSBmY3RfcmVjb2RlKHByb3RMZXZlbCwgaGlnaCA9ICJoIiwgbG93ID0gImwiKSwKICAgIHByb3RTb3VyY2UgPSBmY3RfcmVjb2RlKHByb3RTb3VyY2UsIGJlZWYgPSAiYiIsIGNlcmVhbCA9ICJjIiwgcG9yayA9ICJwIikKICApICU+JQogICMjIFNldCAibG93IiBhcyB0aGUgcmVmZXJlbmNlIGxldmVsIGZvciBgcHJvdExldmVsYAogIG11dGF0ZShwcm90TGV2ZWwgPSBmY3RfcmVsZXZlbChwcm90TGV2ZWwsICJsb3ciKSkKCmhlYWQoZGlldCkKYGBgCgojIERhdGEgZXhwbG9yYXRpb24KCi0gQm94cGxvdCBvZiB0aGUgd2VpZ2h0IGdhaW4gYWdhaW5zdCBwcm90ZWluIHNvdXJjZSwgcHJvdGVpbiBsZXZlbCB3aXRoIGNvbG9yaW5nIGFjY29yZGluZyB0byBibG9jawoKYGBge3J9CmRpZXQgJT4lCiAgZ2dwbG90KGFlcyh4ID0gcHJvdExldmVsLCB5ID0gd2VpZ2h0R2FpbikpICsKICBzY2FsZV9maWxsX2JyZXdlcihwYWxldHRlID0gIlJkR3kiKSArCiAgdGhlbWVfYncoKSArCiAgZ2VvbV9ib3hwbG90KG91dGxpZXIuc2hhcGUgPSBOQSkgKwogIGdlb21faml0dGVyKGFlcyhjb2xvciA9IGJsb2NrKSkgKwogIGdndGl0bGUoIldlaWdodCBnYWluIGRlcGVuZGVuY2Ugb24gcHJvdGVpbiBzb3VyY2UiKSArCiAgbGFicyh4ID0gIlByb3RlaW4gbGV2ZWwiLCB5ID0gIldlaWdodCBnYWluIChnKSIpICsKICBzdGF0X3N1bW1hcnkoCiAgICBmdW4gPSBtZWFuLCBnZW9tPSJwb2ludCIsCiAgICBzaGFwZT01LCBzaXplPTMsIGNvbG9yPSJibGFjayIKICApICsKICBmYWNldF93cmFwKHZhcnMocHJvdFNvdXJjZSkpCmBgYAoKLSBMaW5lcGxvdCBvZiB0aGUgd2VpZ2h0IGdhaW4gYWdhaW5zdCBwcm90ZWluIHNvdXJjZSwgcHJvdGVpbiBsZXZlbCB3aXRoIGNvbG9yaW5nIGFuZCBncm91cGluZyBhY2NvcmRpbmcgdG8gYmxvY2sKCmBgYHtyfQpkaWV0ICU+JQogIGdncGxvdChhZXMoeCA9IHByb3RMZXZlbCwgeSA9IHdlaWdodEdhaW4sIGNvbG9yID0gYmxvY2spKSArCiAgc2NhbGVfZmlsbF9icmV3ZXIocGFsZXR0ZSA9ICJSZEd5IikgKwogIHRoZW1lX2J3KCkgKwogIGdlb21fbGluZShhZXMoZ3JvdXAgPSBibG9jaykpICsKICBnZW9tX3BvaW50KCkgKwogIGdndGl0bGUoIldlaWdodCBnYWluIGRlcGVuZGVuY2Ugb24gcHJvdGVpbiBzb3VyY2UiKSArCiAgeWxhYigiV2VpZ2h0IGdhaW4gKGcpIikgKwogIGZhY2V0X3dyYXAodmFycyhwcm90U291cmNlKSkKYGBgCgotIEFuIGluY3JlYXNlIGluIHRoZSB3ZWlnaHQgb2YgdGhlIHJhdHMgc2VlbXMgdG8gZGVwZW5kIG9uIHRoZSBwcm90ZWluIHNvdXJjZQpyZWNlaXZlZCBpbiB0aGUgZGlldC4KCi0gVGhlIGluY3JlYXNlIGluIHRoZSB3ZWlnaHQgb2YgdGhlIHJhdHMgc2VlbXMgdG8gZGVwZW5kIG9uIHRoZSBsZXZlbCBvZiBwcm90ZWluCnJlY2VpdmVkIGluIHRoZSBkaWV0CgotIFRoZXJlIGFsc28gc2VlbXMgdG8gYmUgYW4gaW50ZXJhY3Rpb24gZWZmZWN0IGJldHdlZW4gdGhlIHByb3RlaW4gbGV2ZWwgYW5kIHRoZQpwcm90ZWluIHNvdXJjZSBvbiB0aGUgZ2FpbiBpbiB3ZWlnaHQgb2YgdGhlIHJhdHMuIEZvciB0aGUgYmVlZiBhbmQgdGhlIHBvcmsKZGlldHMgdGhlIGVmZmVjdCBvZiBoaWdoIHByb3RlaW4gbGV2ZWxzIGluIHRoZSBkYXRhIHNlZW1zIHRvIGJlIG11Y2ggc3Ryb25nZXIKdGhhbiBpbiB0aGUgY2VyZWFsIGRpZXQuCgotIFRoZXJlIGlzIGFsc28gYSBzdHJvbmcgZWZmZWN0IG9mIHRoZSBibG9jay4gQmxvY2tpbmcgaW1wbGllcyBhIHJhbmRvbWlzYXRpb24KcmVzdHJpY3Rpb24sIGhlbmNlLCB3ZSB3aWxsIGhhdmUgdG8gaW5jbHVkZSB0aGUgYmxvY2sgZWZmZWN0IGFueXdheS4KCiMgTXVsdGl2YXJpYXRlIGxpbmVhciByZWdyZXNzaW9uIGFuYWx5c2lzCgojIyBBc3N1bXB0aW9ucwoKTGlzdCBhc3N1bXB0aW9uczoKCjEuIFRoZSBvYnNlcnZhdGlvbnMgYXJlIGluZGVwZW5kZW50CjIuIExpbmVhcml0eSBiZXR3ZWVuIHRoZSByZXNwb25zZSBhbmQgcHJlZGljdG9yIHZhcmlhYmxlCjMuIFRoZSByZXNpZHVhbHMgb2YgdGhlIG1vZGVsIG11c3QgYmUgbm9ybWFsbHkgZGlzdHJpYnV0ZWQKNC4gSG9tb3NjZWRhc3RpY2l0eSBvZiB0aGUgZGF0YQoKVGhlIGZpcnN0IGFzc3VtcHRpb24gaXMgbWV0IGlmIHdlIGNvcnJlY3QgZm9yIGJsb2NrIGluIHRoZSBtb2RlbCBiZWNhdXNlIHRoZSByYXRzIHdlcmUgcmFuZG9taXplZCB0byB0aGUgdHJlYXRtZW50IHdpdGhpbiBibG9jay4gVGhlIG90aGVyIHRocmVlIGFzc3VtcHRpb25zIGNhbiBiZSBhc3Nlc3NlZCBieQpmaXR0aW5nIHRoZSBsaW5lYXIgbW9kZWwgYW5kIGNhbGxpbmcgdGhlIGBwbG90KClgIGZ1bmN0aW9uIGFzIGZvbGxvd3MuCgpgYGB7cn0KbG0xIDwtIGxtKHdlaWdodEdhaW4gfiBibG9jayArIHByb3RTb3VyY2UgKiBwcm90TGV2ZWwsIGRhdGEgPSBkaWV0KQpwbG90KGxtMSkKYGBgCgpBbGwgYXNzdW1wdGlvbnMgYXJlIG1ldCBmb3IgdGhpcyBkYXRhc2V0LgoKIyMgSHlwb3RoZXNpcyB0ZXN0aW5nCgpXZSBoZXJlIGZpdCBhIGxpbmVhciBtb2RlbCB3aXRoIGEgYmxvY2tpbmcgZmFjdG9yIGZvciBgYmxvY2tgIGFuZCBtYWluIGFuZAppbnRlcmFjdGlvbiBlZmZlY3RzIGZvciBwcm90ZWluIHNvdXJjZSBhbmQgcHJvdGVpbiBsZXZlbC4KCmBgYHtyfQpzdW1tYXJ5KGxtMSkKYGBgCgojIyBJbnRlcnByZXRhdGlvbiBvZiB0aGUgcmVncmVzc2lvbiBwYXJhbWV0ZXJzCgpgYGB7cn0KbGlicmFyeShFeHBsb3JlTW9kZWxNYXRyaXgpCkV4cGxvcmVNb2RlbE1hdHJpeDo6VmlzdWFsaXplRGVzaWduKGRpZXQsIH4gYmxvY2sgKyBwcm90U291cmNlICogcHJvdExldmVsKSRwbG90bGlzdApgYGAKClRoZXJlIGFyZSAzIGxldmVscyBmb3IgcHJvdGVpbiBzb3VyY2UsIDIgbGV2ZWxzIGZvciBwcm90ZWluIGxldmVsIGFuZCAxMCBsZXZlbHMKZm9yIHRoZSBibG9ja2luZyB2YXJpYWJsZS4gV2Ugd2lsbCBoYXZlIG9uZSByZWZlcmVuY2UgbGV2ZWwgZm9yIGVhY2ggcmVzcGVjdGl2ZQp2YXJpYWJsZTogYmVlZiwgbG93LCBibG9jayAxLiBTbyB3ZSBuZWVkIDIsIDEgYW5kIDkgZHVtbXkgdmFyaWFibGVzIHRvIGludHJvZHVjZQp0aGUgZmFjdG9ycyBwcm90ZWluIHNvdXJjZSwgcHJvdGVpbiBsZXZlbCBhbmQgYmxvY2sgaW4gdGhlIGxpbmVhciBtb2RlbCwKcmVzcGVjdGl2ZWx5LgoKSGVuY2UsIHdlIGNhbiB3cml0ZSBkb3duIHRoZSBsaW5lYXIgbW9kZWwgYXMgZm9sbG93czoKCiR5X2k9XGJldGFfMCtcYmV0YV9jeF97aSxjfSArXGJldGFfcHhfe2kscH0rXGJldGFfaHhfe2ksaH0rXGJldGFfe2NofXhfe2ksY314X3tpLGh9K1xiZXRhX3twaH14X3tpLHB9eF97aSxofStcYmV0YV97YjJ9eF97aSxiMn0rXGxkb3RzK1xiZXRhX3tiMTB9eF97aSxiMTB9K1xlcHNpbG9uX3tpfSQKCndpdGg6CiR5X2kkIHRoZSBvYnNlcnZlZCB3ZWlnaHQgZ2FpbiBmb3IgcmF0IGksCiR4X3tpLGh9JCBhIGR1bW15IHZhcmlhYmxlIHdoaWNoIGlzIDEgaWYgcmF0IGkgcmVjZWl2ZXMgYSBoaWdoIHByb3RlaW4gZGlldAphbmQgaXMgMCBvdGhlcndpc2UsCiR4X3tpLGN9JCBhIGR1bW15IHZhcmlhYmxlIHdoaWNoIGlzIDEgaWYgcmF0IGkgcmVjZWl2ZXMgYSBjZXJlYWwgZGlldAphbmQgaXMgMCBvdGhlcndpc2UsCiR4X3tpLHB9JCBhIGR1bW15IHZhcmlhYmxlIHdoaWNoIGlzIDEgaWYgcmF0IGkgcmVjZWl2ZXMgYSBwb3JrIGRpZXQKYW5kIGlzIDAgb3RoZXJ3aXNlIGFuZAokeF97aSxia30kIGlzIGEgZHVtbXkgdmFyaWFibGUgd2hpY2ggaXMgMSBpZiByYXQgaSBiZWxvbmdzIHRvIGJsb2NrICRiayQKYW5kIGlzIDAgb3RoZXJ3aXNlLCB3aXRoICRrIFxpbiAyLFxsZG90cywgMTAkLAphbmQgJFxlcHNpbG9uX2kkIGFuIGVycm9yIHRlcm0gd2hpY2ggaXMgbm9ybWFsbHkgZGlzdHJpYnV0ZWQgd2l0aCBtZWFuIDAgYW5kCnZhcmlhbmNlICRcc2lnbWFeMiQsIGkuZS4gJFxlcHNpbG9uX2kgXHNpbSBOKDAsXHNpZ21hXjIpJC4KCi0gUmF0cyB0aGF0IGFyZSBhc3NpZ25lZCB0byBibG9jayAkayQgYW5kIHJlY2VpdmUgYSBiZWVmIGJhc2VkIGxvdyBwcm90ZWluIGRpZXQgaGF2ZQoJYSBjb3ZhcmlhdGUgcGF0dGVybiAkeF97aSxofT0wJCwgJHhfe2ksY309MCQsICR4X3tpLHB9PTAkLCAkeF97aSxibX09MCQgd2l0aCAkbVxuZXEgayQgYW5kICR4X3tpLGJrfT0xJC4KCVRoZWlyIG1lYW4gd2VpZ2h0IGdhaW4gaXMgdGh1cyBlcXVhbCB0byAkXG11X3tsLGIsYmt9PVxiZXRhXzArXGJldGFfe2JrfSQKCi0gUmF0cyB0aGF0IGFyZSBhc3NpZ25lZCB0byBibG9jayAkayQgYW5kIHJlY2VpdmUgYSBiZWVmIGJhc2VkIGhpZ2ggcHJvdGVpbiBkaWV0IGhhdmUKCWEgY292YXJpYXRlIHBhdHRlcm4gJHhfe2ksaH09MSQsICR4X3tpLGN9PTAkLCAkeF97aSxwfT0wJCwgJHhfe2ksYm19PTAkIHdpdGggJG1cbmVxIGskIGFuZCAkeF97aSxia309MSQuCglUaGVpciBtZWFuIHdlaWdodCBnYWluIGlzIHRodXMgZXF1YWwgdG8gJFxtdV97aCxiLGJrfT1cYmV0YV8wK1xiZXRhX2grXGJldGFfe2JrfSQKCi0gUmF0cyB0aGF0IGFyZSBhc3NpZ25lZCB0byBibG9jayAkayQgYW5kIHJlY2VpdmUgYSBjZXJlYWwgYmFzZWQgbG93IHByb3RlaW4gZGlldCBoYXZlCglhIGNvdmFyaWF0ZSBwYXR0ZXJuICR4X3tpLGh9PTAkLCAkeF97aSxjfT0xJCwgJHhfe2kscH09MCQsICR4X3tpLGJtfT0wJCB3aXRoICRtXG5lcSBrJCBhbmQgJHhfe2ksYmt9PTEkLgoJVGhlaXIgbWVhbiB3ZWlnaHQgZ2FpbiBpcyB0aHVzIGVxdWFsIHRvICRcbXVfe2gsYyxia309XGJldGFfMCtcYmV0YV9jK1xiZXRhX3tia30kCgotIFJhdHMgdGhhdCBhcmUgYXNzaWduZWQgdG8gYmxvY2sgJGskIGFuZCByZWNlaXZlIGEgY2VyZWFsIGJhc2VkIGhlaWdoIHByb3RlaW4gZGlldCBoYXZlCglhIGNvdmFyaWF0ZSBwYXR0ZXJuICR4X3tpLGh9PTEkLCAkeF97aSxjfT0xJCwgJHhfe2kscH09MCQsICR4X3tpLGJtfT0wJCB3aXRoICRtXG5lcSBrJCBhbmQgJHhfe2ksYmt9PTEkLgoJVGhlaXIgbWVhbiB3ZWlnaHQgZ2FpbiBpcyB0aHVzIGVxdWFsIHRvICRcbXVfe2gsYyxia309XGJldGFfMCtcYmV0YV9oK1xiZXRhX2MrXGJldGFfe2NofStcYmV0YV97Ymt9JAoKLSBSYXRzIHRoYXQgYXJlIGFzc2lnbmVkIHRvIGJsb2NrICRrJCBhbmQgcmVjZWl2ZSBhIHBvcmsgYmFzZWQgbG93IHByb3RlaW4gZGlldCBoYXZlCglhIGNvdmFyaWF0ZSBwYXR0ZXJuICR4X3tpLGh9PTAkLCAgJHhfe2ksY309MCQsICR4X3tpLHB9PTEkLCAkeF97aSxibX09MCQgd2l0aCAkbVxuZXEgayQgYW5kICR4X3tpLGJrfT0xJC4KCVRoZWlyIG1lYW4gd2VpZ2h0IGdhaW4gaXMgdGh1cyBlcXVhbCB0byAkXG11X3tsLHAsYmt9PVxiZXRhXzArXGJldGFfcCtcYmV0YV97Ymt9JAoKLSBSYXRzIHRoYXQgYXJlIGFzc2lnbmVkIHRvIGJsb2NrICRrJCBhbmQgcmVjZWl2ZSBhIHBvcmsgYmFzZWQgaGVpZ2ggcHJvdGVpbiBkaWV0IGhhdmUKCWEgY292YXJpYXRlIHBhdHRlcm4gJHhfe2ksaH09MSQsICR4X3tpLGN9PTAkLCAkeF97aSxwfT0xJCwgJHhfe2ksYm19PTAkIHdpdGggJG1cbmVxIGskIGFuZCAkeF97aSxia309MSQuCglUaGVyZSBtZWFuIHdlaWdodCBnYWluIGlzIHRodXMgZXF1YWwgdG8gJFxtdV97aCxwLGJrfT1cYmV0YV8wK1xiZXRhX2grXGJldGFfcCtcYmV0YV97cGh9K1xiZXRhX3tia30kCgpXZSBjYW4gbm93IHJlbGF0ZSB0aGlzIHRvIHRoZSBvdXRwdXQgb2YgdGhlIGBsbWAgZnVuY3Rpb246CgotIFRoZSBpbnRlcmNlcHQgJFxiZXRhXzAkIGlzIHRodXMgdGhlIGF2ZXJhZ2Ugd2VpZ2h0IGluY3JlYXNlIGluIHRoZSBsb3cgYmVlZgpkaWV0IGZvciByYXRzIGluIGJsb2NrIDEuCgotIFRoZSBwYXJhbWV0ZXIgJFxiZXRhX2MkOiB0aGUgYXZlcmFnZSBkaWZmZXJlbmNlIGluIHdlaWdodCBnYWluIGJldHdlZW4gY2VyZWFsLWxvdyBhbmQKYmVlZi1sb3cgZGlldCBpcyBgciBsbTEkY29lZlsicHJvdFNvdXJjZWNlcmVhbCJdYGcuCgotIFRoZSBwYXJhbWV0ZXIgJFxiZXRhX3AkOiB0aGUgYXZlcmFnZSBkaWZmZXJlbmNlIGluIHdlaWdodCBnYWluIGJldHdlZW4gcG9yay1sb3cgYW5kCmJlZWYtbG93IGRpZXQgaXMgYHIgbG0xJGNvZWZbInByb3RTb3VyY2Vwb3JrIl1gZy4KCi0gVGhlIHBhcmFtZXRlciAkXGJldGFfaCQ6IHRoZSBhdmVyYWdlIGRpZmZlcmVuY2UgaW4gd2VpZ2h0IGdhaW4gYmV0d2VlbiBiZWVmLWhpZ2ggYW5kCmJlZWYtTG93IGRpZXQgaXMgYHIgbG0xJGNvZWZbInByb3RMZXZlbGhpZ2giXWBnLgoKLSBUaGUgcGFyYW1ldGVyICRcYmV0YV97Y2h9JCBpcyB0aGUgZGlmZmVyZW5jZSBpbiB0aGUgYXZlcmFnZSB3ZWlnaHQgZ2FpbiBkaWZmZXJlbmNlCmR1ZSB0byB0aGUgaGlnaCBwcm90ZWluIGxldmVsIGFzIGNvbXBhcmVkIHRvIHRoZSBsb3cgcHJvdGVpbiBsZXZlbCBmb3IgY2VyZWFsIGRpZXRzCmFzIGNvbXBhcmVkIHRvIHRoZSB3ZWlnaHQgZ2FpbiBkaWZmZXJlbmNlIHRoYXQgb2NjdXJzIGR1ZSB0byB0aGUgcHJvdGVpbiBsZXZlbAppbiB0aGUgcmVmZXJlbmNlIGNsYXNzIChoZXJlIGJlZWYgZGlldCkuIEhlcmUgdGhpcyBpcyBuZWdhdGl2ZSwKaS5lLiBgciBsbTEkY29lZlsicHJvdFNvdXJjZWNlcmVhbDpwcm90TGV2ZWxoaWdoIl1gZywgdGh1cyB0aGUgd2VpZ2h0IGdhaW4KZm9yIHRoZSBjZXJlYWwgcHJvdGVpbiBzb3VyY2UgaW5jcmVhc2VzIG9uIGF2ZXJhZ2UgbGVzcyBiZXR3ZWVuIGhpZ2ggYW5kIGxvdyBwcm90ZWluIGRpZXRzCnRoYW4gaW4gYmVlZiBiYXNlZCBkaWV0cy4KCi0gVGhlIHBhcmFtZXRlciAkXGJldGFfe3BofSQgaXMgdGhlIGRpZmZlcmVuY2UgaW4gdGhlIGF2ZXJhZ2Ugd2VpZ2h0IGdhaW4gZGlmZmVyZW5jZQpkdWUgdG8gdGhlIGhpZ2ggcHJvdGVpbiBsZXZlbCBhcyBjb21wYXJlZCB0byB0aGUgbG93IHByb3RlaW4gbGV2ZWwgZm9yIHBvcmsgZGlldHMKYXMgY29tcGFyZWQgdG8gdGhlIHdlaWdodCBnYWluIGRpZmZlcmVuY2UgdGhhdCBvY2N1cnMgZHVlIHRvIHRoZSBwcm90ZWluIGxldmVsCmluIHRoZSByZWZlcmVuY2UgY2xhc3MgKGhlcmUgYmVlZiBkaWV0KS4gSGVyZSB0aGlzIGlzIG5lZ2F0aXZlLAppLmUuIGByIGxtMSRjb2VmWyJwcm90U291cmNlcG9yazpwcm90TGV2ZWxoaWdoIl1gZywgdGh1cyB0aGUgd2VpZ2h0IGdhaW4KZm9yIHRoZSBwcm9jIHByb3RlaW4gc291cmNlIGluY3JlYXNlcyBvbiBhdmVyYWdlIGxlc3MgYmV0d2VlbiBoaWdoIGFuZCBsb3cgcHJvdGVpbiBkaWV0cwp0aGFuIGluIGJlZWYgYmFzZWQgZGlldHMuCgojIyBUZXN0aW5nIHRoZSBvdmVyYWxsIChjb21iaW5lZCkgZWZmZWN0IG9mIGRpZXQKCkJlY2F1c2UgdGhlcmUgYXJlIG11bHRpcGxlIGZhY3RvcnMgd2l0aCBkaWZmZXJlbnQgbGV2ZWxzIGluIHRoZSBtb2RlbCwKd2UgY2FuIGZpcnN0IGFzc2VzcyB0aGUgZWZmZWN0IG9mIHRoZSBkaWV0IChwcm90ZWluIExldmVsLCBwcm90ZWluIHNvdXJjZQphbmQgdGhlIGludGVyYWN0aW9uKSBieSB1c2luZyBhbm92YS4gV2l0aCB0aGlzIHRlc3Qgd2Ugd2lsbCBhc3Nlc3MgdGhlIG51bGwKaHlwb3RoZXNpcyB0aGF0IHRoZSBhdmVyYWdlIHdlaWdodCBnYWluIGluIGVhY2ggdHJlYXRtZW50IGlzIGVxdWFsOiBpLmUuICRIXzA6IFxtdV97YixsfT1cbXVfe2IsaH09XG11X3tjLGh9PVxtdV97YyxsfT1cbXVfe3AsaH09XG11X3twLGh9JCB2ZXJzdXMKdGhlIGFsdGVybmF0aXZlIGh5cHRvaGVzaXMgJEhfMTokIHRoYXQgYXQgbGVhc3QgdHdvIHRyZWF0bWVudCBtZWFucyBhcmUKZGlmZmVyZW50LgoKYGBge3J9CmxtMCA8LSBsbSh3ZWlnaHRHYWluIH4gYmxvY2ssIGRhdGEgPSBkaWV0KQphbm92YShsbTAsIGxtMSkKYGBgCgpXZSBjYW4gY29uY2x1ZGUgdGhhdCB0aGVyZSBpcyBhbiBleHRyZW1lbHkgc2lnbmlmaWNhbnQgZWZmZWN0IG9mIHRoZSBkaWV0IHR5cGUKKHByb3RlaW4gc291cmNlIGFuZC9vciBwcm90ZWluIGxldmVsIGFuZC9vciBwcm90ZWluIHNvdXJjZS1wcm90ZWluIGxldmVsCmludGVyYWN0aW9uKSBvbiB0aGUgd2VpZ2h0IGdhaW4gb2YgcmF0cyAocCA8PCAwLjAwMSkuCgojIyBBc3Nlc3NpbmcgdGhlIGludGVyYWN0aW9uIGVmZmVjdCBiZXR3ZWVuIHByb3RlaW4gc291cmNlIGFuZCBwcm90ZWluIGxldmVsCgpgYGB7ciwgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRX0KbGlicmFyeShjYXIpCkFub3ZhKGxtMSwgdHlwZSA9ICJJSUkiKQpgYGAKClRoZXJlIGlzIGEgdmVyeSBzaWduaWZpY2FudCBpbnRlcmFjdGlvbiBiZXR3ZWVuIHRoZSBwcm90ZWluIHNvdXJjZSBhbmQKdGhlIHByb3RlaW4gbGV2ZWwgKHAgPSBgciBmb3JtYXQoQW5vdmEobG0xLCB0eXBlPTMpJCJQcig+RikiLGRpZ2l0cz0xKVs1XWApLiBUaGlzIGluZGljYXRlcyB0aGF0IHRoZSBhdmVyYWdlIHdlaWdodCBpbmNyZWFzZSBkdWUgdG8KdGhlIHByb3RlaW4gbGV2ZWwgZGlmZmVycyBhY2NvcmRpbmcgdG8gdGhlIHByb3RlaW4gc291cmNlLgpIZW5jZSwgd2UgY2Fubm90IGFzc2VzcyB0aGUgZWZmZWN0IG9mIHRoZSBwcm90ZWluIHNvdXJjZSBhbmQvb3IgcHJvdGVpbiBsZXZlbAppbmRlcGVuZGVudGx5IGJlY2F1c2UgdGhlcmUgZWZmZWN0cyBvZiB0aGUgcHJvdGVpbiBzb3VyY2UgdmFyeSBhY2NvcmRpbmcgdG8KdGhlIHByb3RlaW4gbGV2ZWwuCgojIyBBc3Nlc3Npbmcgc3BlY2lmaWMgY29udHJhc3RzCgpJbWFnaW5lIHRoYXQgd2UgYXJlIGludGVyZXN0ZWQgaW4gYXNzZXNzaW5nIGlmIHRoZXJlIGlzIGFuIGVmZmVjdCBvZgoKMS4gcHJvdGVpbiBzb3VyY2UgaW4gdGhlIGxvdyBwcm90ZWluIGRpZXRzCgktICRcbXVfe2MsbH0tXG11X3tiLGx9ID0gXGJldGFfYyQKCS0gJFxtdV97cCxsfS1cbXVfe2IsbH0gPSBcYmV0YV9wJAoJLSAkXG11X3tjLGx9LVxtdV97cCxsfT0gXGJldGFfYy1cYmV0YV9wJCkKCgoyLiBwcm90ZWluIHNvdXJjZSBpbiBoaWdoIHByb3RlaW4gZGlldHMKCS0gJFxtdV97YyxofS1cbXVfe2IsaH09XGJldGFfYytcYmV0YV97Y2h9JAoJLSAkXG11X3twLGh9LVxtdV97YixofT1cYmV0YV9wK1xiZXRhX3twaH0kCgktICRcbXVfe3AsaH0tXG11X3tjLGh9PShcYmV0YV9jK1xiZXRhX3tjaH0pLShcYmV0YV9wK1xiZXRhX3twaH0pJAoKCjMuIHByb3RlaW4gbGV2ZWwgZm9yCgktIGJlZWYgZGlldHMgKCRcbXVfe2IsaH0tXG11X3tiLGx9PVxiZXRhX2gkKSwKCS0gY2VyZWFsIGRpZXRzICAoJFxtdV97YyxofS1cbXVfe2MsbH09XGJldGFfaCtcYmV0YV97Y2h9JCkgYW5kCgktIHBvcmsgZGlldHMgICgkXG11X3twLGh9LVxtdV97cCxsfT1cYmV0YV9oK1xiZXRhX3twaH0kKS4KCgo0LiBJZiB0aGUgZWZmZWN0IG9mIHRoZSBwcm90ZWluIGxldmVsIGRpZmZlcnMgYmV0d2VlbgoJLSBiZWVmIGFuZCBjZXJlYWwgICQoXG11X3tjLGh9LVxtdV97YyxsfSkgLSAoXG11X3tiLGh9LVxtdV97YixsfSk9XGJldGFfe2NofSQKCS0gYmVlZiBhbmQgcG9yayAkKFxtdV97cCxofS1cbXVfe3AsbH0pIC0gKFxtdV97YyxofS1cbXVfe2MsbH0pPVxiZXRhX3twaH0kIGFuZAoJLSBjZXJlYWwgYW5kIHBvcmsgZGlldHMgJChcbXVfe2MsaH0tXG11X3tjLGx9KSAtIChcbXVfe3AsaH0tXG11X3twLGx9KT1cYmV0YV97Y2h9LVxiZXRhX3twaH0kLgoKVGhlc2UgZWZmZWN0cyBvZiBpbnRlcmVzdCBhcmUgc28tY2FsbGVkCioqY29udHJhc3RzLCBpLmUuIGxpbmVhciBjb21iaW5hdGlvbnMgb2YgdGhlIHBhcmFtZXRlcnMqKi4KCldlIGNhbiBkZWZpbmUgdGhlIGNvbnRyYXN0cyBhbmQgYXNzZXNzIHRoZSBzaWduaWZpY2FuY2Ugb2YgdGhlIGNvbnRyYXN0cyB3aXRoCnRoZSBjb2RlIGJlbG93LiBUaGUgY29udHJhc3RzIGFyZSBnaXZlbiBhcyBpbnB1dCBpbiB0aGUgZm9ybSBvZiBzeW1ib2xpYwpkZXNjcmlwdGlvbnMgdG8gdGhlIGBsaW5mY3RgIGFyZ3VtZW50IG9mIHRoZSBgZ2xodGAgZnVuY3Rpb24uCgpgYGB7cixtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQpsaWJyYXJ5KG11bHRjb21wKQpzZXQuc2VlZCg3NTQ2OCkgIyB0byBnZXQgcmVwcm9kdWNpYmxlIHJlc3VsdHMgKHNtYWxsIGVmZmVjdCBpZiByZW1vdmVkKQpsbTFNdWx0Q29tcCA8LSBnbGh0KAogIG1vZGVsID0gbG0xLAogIGxpbmZjdCA9IGMoCiAgICAicHJvdFNvdXJjZWNlcmVhbCA9IDAiLAogICAgInByb3RTb3VyY2Vwb3JrID0gMCIsCiAgICAicHJvdFNvdXJjZWNlcmVhbC0gcHJvdFNvdXJjZXBvcmsgPSAwIiwKICAgICJwcm90U291cmNlY2VyZWFsICsgcHJvdFNvdXJjZWNlcmVhbDpwcm90TGV2ZWxoaWdoID0gMCIsCiAgICAicHJvdFNvdXJjZXBvcmsgKyBwcm90U291cmNlcG9yazpwcm90TGV2ZWxoaWdoID0gMCIsCiAgICAiKHByb3RTb3VyY2VjZXJlYWwgKyBwcm90U291cmNlY2VyZWFsOnByb3RMZXZlbGhpZ2gpIC0gKHByb3RTb3VyY2Vwb3JrICsgcHJvdFNvdXJjZXBvcms6cHJvdExldmVsaGlnaCkgPSAwIiwKICAgICJwcm90TGV2ZWxoaWdoID0gMCIsCiAgICAicHJvdExldmVsaGlnaCArICBwcm90U291cmNlY2VyZWFsOnByb3RMZXZlbGhpZ2ggPSAwIiwKICAgICJwcm90TGV2ZWxoaWdoICsgIHByb3RTb3VyY2Vwb3JrOnByb3RMZXZlbGhpZ2ggPSAwIiwKICAgICJwcm90U291cmNlY2VyZWFsOnByb3RMZXZlbGhpZ2ggPSAwIiwKICAgICJwcm90U291cmNlcG9yazpwcm90TGV2ZWxoaWdoID0gMCIsCiAgICAicHJvdFNvdXJjZWNlcmVhbDpwcm90TGV2ZWxoaWdoIC0gcHJvdFNvdXJjZXBvcms6cHJvdExldmVsaGlnaCA9IDAiCiAgKQopCmBgYAoKYGBge3J9CnN1bW1hcnkobG0xTXVsdENvbXApCmBgYAoKYGBge3J9CmNvbmZpbnQobG0xTXVsdENvbXApCmBgYAoKTm90ZSB0aGF0IHRoZSBwLXZhbHVlcyBhbmQgdGhlIGNvbmZpZGVuY2UgaW50ZXJ2YWxzIGFyZSBhdXRvbWF0aWNhbGx5IGNvcnJlY3RlZApmb3IgbXVsdGlwbGUgdGVzdGluZy4KCiMgQ29uY2x1c2lvbgoKLSBUaGVyZSBpcyBhbiBleHRyZW1lbHkgc2lnbmlmaWNhbnQgZWZmZWN0IG9mIHRoZSB0eXBlIG9mIHByb3RlaW4gZGlldCBvbiB0aGUKd2VpZ2h0IGdhaW4gb2YgcmF0cyAgKHA8PDFlLTYpLiBUaGUgaW50ZXJhY3Rpb24gYmV0d2VlbiBwcm90ZWluIHR5cGUgYW5kIHByb3RlaW4Kc291cmNlIGlzIGFsc28gdmVyeSBzaWduaWZpY2FudCAocD1gciByb3VuZChBbm92YShsbTEsdHlwZT0zKSRQcls1XSw0KWApLgoKLSBUaGUgYXZlcmFnZSB3ZWlnaHQgZ2FpbiBkb2VzIG5vdCB2YXJ5IHNpZ25pZmljYW50bHkgYWNjb3JkaW5nIHRvIHByb3RlaW4Kc291cmNlIGluIHRoZSBkaWV0cyB3aXRoIGxvdyBwcm90ZWluIGxldmVscyAoYWxsIHA+MC45OSkuCgotIFRoZSB3ZWlnaHQgZ2FpbiBpbiB0aGUgY2VyZWFsIGRpZXQgYXQgaGlnaCBwcm90ZWluIGNvbmNlbnRyYXRpb24gaXMgb24KYXZlcmFnZSBgciBjb25maW50KGxtMU11bHRDb21wKSRjb25maW50WyJwcm90U291cmNlY2VyZWFsICsgcHJvdFNvdXJjZWNlcmVhbDpwcm90TGV2ZWxoaWdoIiwxXSAlPiUgYWJzICU+JSByb3VuZCguLDEpYGcgYW5kIGByIGNvbmZpbnQobG0xTXVsdENvbXApJGNvbmZpbnRbIihwcm90U291cmNlY2VyZWFsICsgcHJvdFNvdXJjZWNlcmVhbDpwcm90TGV2ZWxoaWdoKSAtIChwcm90U291cmNlcG9yayArIHByb3RTb3VyY2Vwb3JrOnByb3RMZXZlbGhpZ2gpIiwxXSAlPiUgYWJzICU+JSByb3VuZCguLDEpYGcgZyBsb3dlciB0aGFuIGluIHRoZSBoaWdoIHByb3RlaW4gYmVlZiBhbmQgcG9yayBkaWV0LApyZXNwZWN0aXZlbHkgKDk1JSBDSSBbYHIgY29uZmludChsbTFNdWx0Q29tcCkkY29uZmludFsicHJvdFNvdXJjZWNlcmVhbCArIHByb3RTb3VyY2VjZXJlYWw6cHJvdExldmVsaGlnaCIsLTFdICU+JSBhYnMgJT4lIHJvdW5kKC4sMSkgJT4lIHNvcnRgXSBhbmQgW2ByIGNvbmZpbnQobG0xTXVsdENvbXApJGNvbmZpbnRbIihwcm90U291cmNlY2VyZWFsICsgcHJvdFNvdXJjZWNlcmVhbDpwcm90TGV2ZWxoaWdoKSAtIChwcm90U291cmNlcG9yayArIHByb3RTb3VyY2Vwb3JrOnByb3RMZXZlbGhpZ2gpIiwtMV0gJT4lIGFicyAlPiUgcm91bmQoLiwxKSAlPiUgc29ydGBdKSBhbmQgdGhlIGRpZmZlcmVuY2VzIGFyZQpleHRyZW1lbHkgc2lnbmlmaWNhbnQgKHA8MC4wMDEpLiBUaGUgYXZlcmFnZSB3ZWlnaHQgZ2FpbnMgYWZ0ZXIgbWVhdCBiYXNlZApkaWV0cyBhdCBoaWdoIHByb3RlaW4gbGV2ZWxzLCBob3dldmVyLCBkbyBub3QgZGlmZmVyIHNpZ25pZmljYW50bHkKKHA+MC45OSkuCgotIFdlIGFsc28gZGlzY292ZXJlZCBhbiBleHRyZW1lbHkgc2lnbmlmaWNhbnQgZGlmZmVyZW5jZSBpbiB3ZWlnaHQgZ2FpbgphY2NvcmRpbmcgdG8gdGhlIHByb3RlaW4gbGV2ZWwgZm9yIGJlZWYgYW5kIHBvcmsgYmFzZWQgZGlldHMgKHA8MC4wMDEpLgpUaGUgd2VpZ2h0IGdhaW4gb24gYXZlcmFnZSBpbmNyZWFzZXMgd2l0aCBgciByb3VuZChjb25maW50KGxtMU11bHRDb21wKSRjb25maW50WyJwcm90TGV2ZWxoaWdoIiwxXSwxKWBnIGFuZCBgciByb3VuZChjb25maW50KGxtMU11bHRDb21wKSRjb25maW50WyJwcm90TGV2ZWxoaWdoICsgcHJvdFNvdXJjZXBvcms6cHJvdExldmVsaGlnaCIsMV0sMSlgZyBpbiB0aGUgaGlnaCBwcm90ZWluCmxldmVsIGFzIGNvbXBhcmVkIHRvIHRoZSBsb3cgcHJvdGVpbiBiZWVmIGFuZCBwb3JrIGRpZXQsIHJlc3BlY3RpdmVseQooOTUlQ0kgW2ByIHJvdW5kKGNvbmZpbnQobG0xTXVsdENvbXApJGNvbmZpbnRbInByb3RMZXZlbGhpZ2giLC0xXSwxKWBdIGFuZCBbYHIgcm91bmQoY29uZmludChsbTFNdWx0Q29tcCkkY29uZmludFsicHJvdExldmVsaGlnaCArIHByb3RTb3VyY2Vwb3JrOnByb3RMZXZlbGhpZ2giLC0xXSwxKWBdKS4gVGhlIHByb3RlaW4gbGV2ZWwgZWZmZWN0IGlzIG5vdCBzaWduaWZpY2FudApmb3IgdGhlIGNlcmVhbCBkaWV0IChwPjAuOTkpLgoKLSBGaW5hbGx5IHNpZ25pZmljYW50IGludGVyYWN0aW9ucyBiZXR3ZWVuIHByb3RlaW4gbGV2ZWwgYW5kIHByb3RlaW4gc291cmNlIHdlcmUKZm91bmQgKHA8MC4wNSksIGkuZS4gdGhlIGluY3JlYXNlIGluIHdlaWdodCBnYWluIGR1ZSB0byBwcm90ZWluIGxldmVsIGluIGNlcmVhbApiYXNlZCBkaWV0cyB3YXMgMTguMmcgYW5kIDE2LjVnIGxvd2VyIHRoYW4gdGhhdCBvZiBiZWVmIGFuZCBwb3JrIGJhc2VkIGRpZXRzLApyZXNwZWN0aXZlbHkgKDk1JSBDSSBbM2csMzMuNGddIGFuZCBbMS4zZywzMS43Z10pLiBUaGUgYXZlcmFnZSBkaWZmZXJlbmNlIGluCmluY3JlYXNlIGluIHdlaWdodCBnYWluIGR1ZSB0byBwcm90ZWluIGxldmVsIGFtb25nIHRoZSBtZWF0IGJhc2VkIGRpZXRzIHdhcyBub3QKc2lnbmlmaWNhbnQgKHA+MC45OSkuCgpBbGwgcmVwb3J0ZWQgcC12YWx1ZXMgYW5kIGNvbmZpZGVuY2UgaW50ZXJ2YWxzIHdlcmUgY29ycmVjdGVkIGZvciBtdWx0aXBsZQp0ZXN0aW5nCg==</div>
<div class="footer">
    <hr>
    This work is licensed under the <a href= "https://creativecommons.org/licenses/by-nc-sa/4.0">
    CC BY-NC-SA 4.0</a> licence.
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("08_6_rats_sol.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
