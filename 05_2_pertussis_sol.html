<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Lieven Clement, and Milan Malfait" />


<title>Exercise 5.2: Hypothesis testing on the pertussis example - solution</title>

<script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01-intro.html">1. Introduction</a>
    </li>
    <li>
      <a href="02-concepts.html">2. Concepts</a>
    </li>
    <li>
      <a href="03-experimentalDesign.html">3. Experimental Design I</a>
    </li>
    <li>
      <a href="04-dataExploration.html">4. Data Exploration</a>
    </li>
    <li>
      <a href="05-statisticalInference.html">5.1 Statistical Inference 1</a>
    </li>
    <li>
      <a href="05-statisticalInference-twosampleT.html">5.2 Statistical Inference 2</a>
    </li>
    <li>
      <a href="06-linearRegression.html">6. Linear Regression</a>
    </li>
    <li>
      <a href="07-Anova.html">7. Analysis of Variance</a>
    </li>
    <li>
      <a href="08-MultipleRegression.html">8. Multiple Regression</a>
    </li>
    <li>
      <a href="08-MultipleRegression-SpecificDesigns.html">8.2 Multiple Regression: Factorial Designs</a>
    </li>
    <li>
      <a href="08-experimentalDesignII.html">8.3. Experimental Design II</a>
    </li>
    <li>
      <a href="08-experimentalDesignIII.html">8.4. Experimental Design III</a>
    </li>
    <li>
      <a href="09-NonparametericStatistics-WilcoxonMannWithney.html">9.1. Nonparametric Statistics 1</a>
    </li>
    <li>
      <a href="09-NonparametericStatistics-KruskalWallis.html">9.2. Nonparametric Statistics 2</a>
    </li>
    <li>
      <a href="10-categoricalDataAnalysis.html">10. Categorical Data Analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-laptop"></span>
     
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="04_exercises.html">4. Data Exploration</a>
    </li>
    <li>
      <a href="05_exercises.html">5. Statistical inference</a>
    </li>
    <li>
      <a href="06_exercises.html">6. Simple linear regression</a>
    </li>
    <li>
      <a href="07_exercises.html">7. ANOVA</a>
    </li>
    <li>
      <a href="08_exercises.html">8. Multiple linear regression</a>
    </li>
    <li>
      <a href="09_exercises.html">9. Non-parametric statistics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/statOmics/PSLS">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://statomics.github.io/">statOmics</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Exercise 5.2: Hypothesis testing on the pertussis example - solution</h1>
<h4 class="author">Lieven Clement, and Milan Malfait</h4>
<h4 class="date">statOmics, Ghent University (<a href="https://statomics.github.io" class="uri">https://statomics.github.io</a>)</h4>

</div>


<div id="aim-of-this-tutorial" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Aim of this tutorial</h1>
<p>Upon this exercise you can</p>
<ol style="list-style-type: decimal">
<li>conduct a statistical hypothesis test for a two group comparison in R and to interpret the results.</li>
<li>critically evaluate the assumptions for a two sample t-test</li>
<li>use simulations to assist you when evaluating the assumptions of a two group comparison</li>
<li>select the correct test based on the data exploration.</li>
</ol>
</div>
<div id="background" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Background</h1>
<p>Researchers wanted to study the immune response on pertussis. They have set up an experiments with 40 rats. 16 rats were infected with pertussis and 24 rats received a control treatment. Researchers measured the white blood cell concentration (WBC) in each rat (count per mm<span class="math inline">\(^3\)</span>).</p>
<p>De data consists of two variables:</p>
<ul>
<li><p>WBC: white blood cell count (counts/mm<span class="math inline">\(^3\)</span>).</p></li>
<li><p>trt: treatment</p>
<ul>
<li>control: rat recieved control treatment</li>
<li>pertussis: rat was infected with pertussis</li>
</ul></li>
</ul>
</div>
<div id="import-the-dataset" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Import the dataset</h1>
<p>Load the libraries</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>Data path:</p>
<p><code>https://raw.githubusercontent.com/statOmics/PSLS21/data/wbcon.csv</code></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>wbcon <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/statOmics/PSLS21/data/wbcon.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 40 Columns: 2
## ── Column specification ──────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (1): trt
## dbl (1): WBC
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(wbcon)</span></code></pre></div>
<pre><code>## Rows: 40
## Columns: 2
## $ WBC &lt;dbl&gt; 10252, 10467, 10601, 10638, 10901, 11071, 11092, 11371, …
## $ trt &lt;chr&gt; &quot;control&quot;, &quot;control&quot;, &quot;control&quot;, &quot;control&quot;, &quot;control&quot;, &quot;…</code></pre>
<div id="aim-of-the-study" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Aim of the study</h2>
<p>The overarching goal of this study was to assess if the white blood cell count changes upon pertussis infection. To this end, researchers randomized 40 rats to two treatments: A control treatment and a treatment in which the rat was infected with pertussis.</p>
</div>
</div>
<div id="data-exploration" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Data exploration</h1>
<p>A crucial first step in a data analysis is to visualize and to explore the raw data.</p>
<p>This will allow us to gain insight in the data.</p>
<p>A secondary goal of the data exploration is to check the assumptions of the test that we will perform.</p>
<div id="which-test-will-you-perform-to-compare-the-white-blood-cell-count-between-infected-and-control-rats" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Which test will you perform to compare the white blood cell count between infected and control rats?</h2>
<p>40 different rats are assigned at random to a control treatment or a treatment where they are infected with pertussis. The white blood cells of the rats are measured on different animals and we can assume that the data between rats are independent. Note, that this will not be the case if multiple rats are housed in the same cages!</p>
<p>We will therefore perform a two-sample t-test to assess if the average white blood cell count differs between infected rats and rats that received the control treatment.</p>
</div>
<div id="what-are-the-assumptions-of-this-test" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> What are the assumptions of this test?</h2>
<ol style="list-style-type: decimal">
<li>The data are independent</li>
<li>The data in both groups have the same variance</li>
<li>The data in both groups are normally distributed.</li>
</ol>
</div>
<div id="boxplots" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Boxplots</h2>
<p>We can assess the second assumption using boxplots.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>wbcon <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> WBC, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">&quot;jitter&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;WBC (count/mm3)&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;treatment&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">5</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="05_2_pertussis_sol_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>What do you observe?</p>
<p>Both the mean and variance of the data seems to differ between control rats and rats infected with pertussis. So the second assumption is not valid. If the data are normally distributed we can compare the groups using a Welch modified t-test, which is valid if the data in both groups are exhibiting a different variance.</p>
</div>
<div id="qq-plots" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> QQ-plots</h2>
<p>To assess the assumption that the data are normally distributed in each treatment group, we will use QQ plots.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>wbcon <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> WBC)) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(trt))</span></code></pre></div>
<p><img src="05_2_pertussis_sol_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>What do you observe?</p>
<p>The white blood cell counts appear to be normally distributed in both treatment groups.</p>
</div>
</div>
<div id="assess-the-research-question-with-the-appropriate-t-test" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Assess the research question with the appropriate t-test</h1>
<div id="analysis" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Analysis</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">t.test</span>(WBC <span class="sc">~</span> trt, <span class="at">data =</span> wbcon, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>output</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  WBC by trt
## t = -5.7114, df = 15.132, p-value = 3.984e-05
## alternative hypothesis: true difference in means between group control and group pertussis is not equal to 0
## 95 percent confidence interval:
##  -32311.32 -14758.47
## sample estimates:
##   mean in group control mean in group pertussis 
##                12215.92                35750.81</code></pre>
</div>
<div id="conclusion" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Conclusion</h2>
<p>The average white blood cell count is extremely different between rats that are infected with pertussis and rads that received a control treatment (p &lt;&lt; 0.001).</p>
<p>The white blood cell count is on average 23535 blood cells/mm<span class="math inline">\(^3\)</span> higher for rats with pertussis than for rats that received a control treatment (95% CI [14758, 32311]).</p>
</div>
</div>
<div id="addendum-train-yourself-in-checking-the-assumptions" class="section level1" number="6">
<h1><span class="header-section-number">6</span> ADDENDUM: Train yourself in checking the assumptions</h1>
<p>In order for the learners to get more proficient in evaluating the assumptions we will simulate 8 dataset with sample sizes similar to our data for which the assumptions of normality and equal variance do hold. For the QQ-plots we will only plot the one from one of the groups.</p>
<div id="simulate-data" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Simulate data</h2>
<p>We simulate 8 datasets with the same sample sizes, means and pooled variance as in the sample.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">21532</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>nSim <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="do">## descriptive statistics</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>wbcSum <span class="ot">&lt;-</span> wbcon <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trt) <span class="sc">%&gt;%</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean =</span> <span class="fu">mean</span>(WBC, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd =</span> <span class="fu">sd</span>(WBC, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">se =</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(wbcSum<span class="sc">$</span>sd<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (wbcSum<span class="sc">$</span>n <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">/</span> (<span class="fu">sum</span>(wbcSum<span class="sc">$</span>n) <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>normSim <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    wbcon<span class="sc">$</span>WBC,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="fu">sum</span>(wbcSum<span class="sc">$</span>n) <span class="sc">*</span> nSim,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean =</span> <span class="fu">c</span>(</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rep</span>(wbcSum<span class="sc">$</span>mean[<span class="dv">1</span>], wbcSum<span class="sc">$</span>n[<span class="dv">1</span>]),</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rep</span>(wbcSum<span class="sc">$</span>mean[<span class="dv">2</span>], wbcSum<span class="sc">$</span>n[<span class="dv">2</span>])</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">sd =</span> sigma)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="fu">sum</span>(wbcSum<span class="sc">$</span>n)) <span class="sc">%&gt;%</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> wbcon<span class="sc">$</span>trt)</span></code></pre></div>
</div>
<div id="comparisons-of-variances" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Comparisons of variances</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(normSim)[<span class="dv">1</span><span class="sc">:</span>(nSim<span class="sc">+</span><span class="dv">1</span>)] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;orig&quot;</span>,<span class="fu">paste0</span>(<span class="st">&quot;sim&quot;</span>,<span class="dv">1</span><span class="sc">:</span>nSim))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>normSim <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(samp, data, <span class="sc">-</span>trt) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> data)) <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>samp)</span></code></pre></div>
<p><img src="05_2_pertussis_sol_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>We observe that the difference in variability of the original observations (top left plot) is larger than in the each simulations. Indicating that there is indeed evidence that the variances in each group differ.</p>
</div>
<div id="evaluation-of-normality" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Evaluation of normality</h2>
<div id="control-group" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Control group</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>normSim <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(samp, data, <span class="sc">-</span>trt) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trt <span class="sc">==</span> <span class="st">&quot;control&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> data)) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>samp)</span></code></pre></div>
<p><img src="05_2_pertussis_sol_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="pertussis-group" class="section level3" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Pertussis group</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>normSim <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(samp, data, <span class="sc">-</span>trt) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trt <span class="sc">==</span> <span class="st">&quot;pertussis&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> data)) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>samp)</span></code></pre></div>
<p><img src="05_2_pertussis_sol_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>The data in each group does not show larger deviations from normality than what we observe in each of the eight datasets that were simulated under the model assumptions.</p>
</div>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiRXhlcmNpc2UgNS4yOiBIeXBvdGhlc2lzIHRlc3Rpbmcgb24gdGhlIHBlcnR1c3NpcyBleGFtcGxlIC0gc29sdXRpb24iCmF1dGhvcjogIkxpZXZlbiBDbGVtZW50LCBhbmQgTWlsYW4gTWFsZmFpdCIKZGF0ZTogInN0YXRPbWljcywgR2hlbnQgVW5pdmVyc2l0eSAoaHR0cHM6Ly9zdGF0b21pY3MuZ2l0aHViLmlvKSIKLS0tCgojIEFpbSBvZiB0aGlzIHR1dG9yaWFsCgpVcG9uIHRoaXMgZXhlcmNpc2UgeW91IGNhbgoKMS4gY29uZHVjdCBhIHN0YXRpc3RpY2FsIGh5cG90aGVzaXMgdGVzdCBmb3IgYSB0d28gZ3JvdXAgY29tcGFyaXNvbiBpbiBSIGFuZCB0byBpbnRlcnByZXQgdGhlIHJlc3VsdHMuCjIuIGNyaXRpY2FsbHkgZXZhbHVhdGUgdGhlIGFzc3VtcHRpb25zIGZvciBhIHR3byBzYW1wbGUgdC10ZXN0CjMuIHVzZSBzaW11bGF0aW9ucyB0byBhc3Npc3QgeW91IHdoZW4gZXZhbHVhdGluZyB0aGUgYXNzdW1wdGlvbnMgb2YgYSB0d28gZ3JvdXAgY29tcGFyaXNvbgo0LiBzZWxlY3QgdGhlIGNvcnJlY3QgdGVzdCBiYXNlZCBvbiB0aGUgZGF0YSBleHBsb3JhdGlvbi4KCiMgQmFja2dyb3VuZAoKUmVzZWFyY2hlcnMgd2FudGVkIHRvIHN0dWR5IHRoZSBpbW11bmUgcmVzcG9uc2Ugb24gcGVydHVzc2lzLgpUaGV5IGhhdmUgc2V0IHVwIGFuIGV4cGVyaW1lbnRzIHdpdGggNDAgcmF0cy4KMTYgcmF0cyB3ZXJlIGluZmVjdGVkIHdpdGggcGVydHVzc2lzIGFuZCAyNCByYXRzIHJlY2VpdmVkIGEgY29udHJvbCB0cmVhdG1lbnQuClJlc2VhcmNoZXJzIG1lYXN1cmVkIHRoZSB3aGl0ZSBibG9vZCBjZWxsIGNvbmNlbnRyYXRpb24gKFdCQykgaW4gZWFjaCByYXQgKGNvdW50IHBlciBtbSReMyQpLgoKRGUgZGF0YSBjb25zaXN0cyBvZiB0d28gdmFyaWFibGVzOgoKLSBXQkM6IHdoaXRlIGJsb29kIGNlbGwgY291bnQgKGNvdW50cy9tbSReMyQpLgotIHRydDogdHJlYXRtZW50CgogICAgLSBjb250cm9sOiByYXQgcmVjaWV2ZWQgY29udHJvbCB0cmVhdG1lbnQKICAgIC0gcGVydHVzc2lzOiByYXQgd2FzIGluZmVjdGVkIHdpdGggcGVydHVzc2lzCgoKIyBJbXBvcnQgdGhlIGRhdGFzZXQKCkxvYWQgdGhlIGxpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9CmxpYnJhcnkodGlkeXZlcnNlKQpgYGAKCkRhdGEgcGF0aDoKCiAgYGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9zdGF0T21pY3MvUFNMUzIxL2RhdGEvd2Jjb24uY3N2YAoKCmBgYHtyfQp3YmNvbiA8LSByZWFkX2NzdigiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3N0YXRPbWljcy9QU0xTMjEvZGF0YS93YmNvbi5jc3YiKQpgYGAKCmBgYHtyfQpnbGltcHNlKHdiY29uKQpgYGAKCiMjIEFpbSBvZiB0aGUgc3R1ZHkKClRoZSBvdmVyYXJjaGluZyBnb2FsIG9mIHRoaXMgc3R1ZHkgd2FzIHRvIGFzc2VzcyBpZiB0aGUgd2hpdGUgYmxvb2QgY2VsbCBjb3VudCBjaGFuZ2VzIHVwb24gcGVydHVzc2lzIGluZmVjdGlvbi4gVG8gdGhpcyBlbmQsIHJlc2VhcmNoZXJzIHJhbmRvbWl6ZWQgNDAgcmF0cwp0byB0d28gdHJlYXRtZW50czogQSBjb250cm9sIHRyZWF0bWVudCBhbmQgYSB0cmVhdG1lbnQgaW4gd2hpY2ggdGhlIHJhdCB3YXMgaW5mZWN0ZWQgd2l0aCBwZXJ0dXNzaXMuCgojIERhdGEgZXhwbG9yYXRpb24KCkEgY3J1Y2lhbCBmaXJzdCBzdGVwIGluIGEgZGF0YSBhbmFseXNpcyBpcyB0byB2aXN1YWxpemUgYW5kIHRvIGV4cGxvcmUgdGhlIHJhdyBkYXRhLgoKVGhpcyB3aWxsIGFsbG93IHVzIHRvIGdhaW4gaW5zaWdodCBpbiB0aGUgZGF0YS4KCkEgc2Vjb25kYXJ5IGdvYWwgb2YgdGhlIGRhdGEgZXhwbG9yYXRpb24gaXMgdG8gY2hlY2sgdGhlIGFzc3VtcHRpb25zIG9mIHRoZSB0ZXN0IHRoYXQgd2Ugd2lsbCBwZXJmb3JtLgoKIyMgV2hpY2ggdGVzdCB3aWxsIHlvdSBwZXJmb3JtIHRvIGNvbXBhcmUgdGhlIHdoaXRlIGJsb29kIGNlbGwgY291bnQgYmV0d2VlbiBpbmZlY3RlZCBhbmQgY29udHJvbCByYXRzPwoKNDAgZGlmZmVyZW50IHJhdHMgYXJlIGFzc2lnbmVkIGF0IHJhbmRvbSB0byBhIGNvbnRyb2wgdHJlYXRtZW50IG9yIGEgdHJlYXRtZW50IHdoZXJlIHRoZXkgYXJlIGluZmVjdGVkIHdpdGggcGVydHVzc2lzLgpUaGUgd2hpdGUgYmxvb2QgY2VsbHMgb2YgdGhlIHJhdHMgYXJlIG1lYXN1cmVkIG9uIGRpZmZlcmVudCBhbmltYWxzIGFuZCB3ZSBjYW4gYXNzdW1lIHRoYXQgdGhlIGRhdGEgYmV0d2VlbiByYXRzIGFyZSBpbmRlcGVuZGVudC4KTm90ZSwgdGhhdCB0aGlzIHdpbGwgbm90IGJlIHRoZSBjYXNlIGlmIG11bHRpcGxlIHJhdHMgYXJlIGhvdXNlZCBpbiB0aGUgc2FtZSBjYWdlcyEKCldlIHdpbGwgdGhlcmVmb3JlIHBlcmZvcm0gYSB0d28tc2FtcGxlIHQtdGVzdCB0byBhc3Nlc3MgaWYgdGhlIGF2ZXJhZ2Ugd2hpdGUgYmxvb2QgY2VsbCBjb3VudCBkaWZmZXJzIGJldHdlZW4gaW5mZWN0ZWQgcmF0cyBhbmQgcmF0cyB0aGF0IHJlY2VpdmVkIHRoZSBjb250cm9sIHRyZWF0bWVudC4KCiMjIFdoYXQgYXJlIHRoZSBhc3N1bXB0aW9ucyBvZiB0aGlzIHRlc3Q/CgoxLiBUaGUgZGF0YSBhcmUgaW5kZXBlbmRlbnQKMi4gVGhlIGRhdGEgaW4gYm90aCBncm91cHMgaGF2ZSB0aGUgc2FtZSB2YXJpYW5jZQozLiBUaGUgZGF0YSBpbiBib3RoIGdyb3VwcyBhcmUgbm9ybWFsbHkgZGlzdHJpYnV0ZWQuCgojIyBCb3hwbG90cwoKV2UgY2FuIGFzc2VzcyB0aGUgc2Vjb25kIGFzc3VtcHRpb24gdXNpbmcgYm94cGxvdHMuCgpgYGB7cn0Kd2Jjb24gJT4lIGdncGxvdChhZXMoeCA9IHRydCwgeSA9IFdCQywgZmlsbCA9IHRydCkpICsKICBnZW9tX2JveHBsb3Qob3V0bGllci5zaGFwZSA9IE5BKSArCiAgZ2VvbV9wb2ludChwb3NpdGlvbiA9ICJqaXR0ZXIiKSArCiAgeWxhYigiV0JDIChjb3VudC9tbTMpIikgKwogIHhsYWIoInRyZWF0bWVudCIpICsKICBzdGF0X3N1bW1hcnkoCiAgICBmdW4gPSBtZWFuLCBnZW9tID0gInBvaW50IiwKICAgIHNoYXBlID0gNSwgc2l6ZSA9IDMsIGNvbG9yID0gImJsYWNrIgogICkKYGBgCgpXaGF0IGRvIHlvdSBvYnNlcnZlPwoKQm90aCB0aGUgbWVhbiBhbmQgdmFyaWFuY2Ugb2YgdGhlIGRhdGEgc2VlbXMgdG8gZGlmZmVyIGJldHdlZW4gY29udHJvbCByYXRzIGFuZCByYXRzIGluZmVjdGVkIHdpdGggcGVydHVzc2lzLgpTbyB0aGUgc2Vjb25kIGFzc3VtcHRpb24gaXMgbm90IHZhbGlkLgpJZiB0aGUgZGF0YSBhcmUgbm9ybWFsbHkgZGlzdHJpYnV0ZWQgd2UgY2FuIGNvbXBhcmUgdGhlIGdyb3VwcyB1c2luZyBhIFdlbGNoIG1vZGlmaWVkIHQtdGVzdCwgd2hpY2ggaXMgdmFsaWQgaWYgdGhlIGRhdGEgaW4gYm90aCBncm91cHMgYXJlIGV4aGliaXRpbmcgYSBkaWZmZXJlbnQgdmFyaWFuY2UuCgojIyBRUS1wbG90cwoKVG8gYXNzZXNzIHRoZSBhc3N1bXB0aW9uIHRoYXQgdGhlIGRhdGEgYXJlIG5vcm1hbGx5IGRpc3RyaWJ1dGVkIGluIGVhY2ggdHJlYXRtZW50IGdyb3VwLCB3ZSB3aWxsIHVzZSBRUSBwbG90cy4KCmBgYHtyfQp3YmNvbiAlPiUKICBnZ3Bsb3QoYWVzKHNhbXBsZSA9IFdCQykpICsKICBnZW9tX3FxKCkgKwogIGdlb21fcXFfbGluZSgpICsKICBmYWNldF9ncmlkKGNvbHMgPSB2YXJzKHRydCkpCmBgYAoKV2hhdCBkbyB5b3Ugb2JzZXJ2ZT8KClRoZSB3aGl0ZSBibG9vZCBjZWxsIGNvdW50cyBhcHBlYXIgdG8gYmUgbm9ybWFsbHkgZGlzdHJpYnV0ZWQgaW4gYm90aCB0cmVhdG1lbnQgZ3JvdXBzLgoKCiMgQXNzZXNzIHRoZSByZXNlYXJjaCBxdWVzdGlvbiB3aXRoIHRoZSBhcHByb3ByaWF0ZSB0LXRlc3QKCiMjIEFuYWx5c2lzCgpgYGB7cn0Kb3V0cHV0IDwtIHQudGVzdChXQkMgfiB0cnQsIGRhdGEgPSB3YmNvbiwgdmFyLmVxdWFsID0gRkFMU0UpCm91dHB1dApgYGAKCiMjIENvbmNsdXNpb24KClRoZSBhdmVyYWdlIHdoaXRlIGJsb29kIGNlbGwgY291bnQgaXMgZXh0cmVtZWx5IGRpZmZlcmVudCBiZXR3ZWVuIHJhdHMgdGhhdCBhcmUgaW5mZWN0ZWQgd2l0aCBwZXJ0dXNzaXMgYW5kIHJhZHMgdGhhdCByZWNlaXZlZCBhIGNvbnRyb2wgdHJlYXRtZW50ICAocCA8PCAwLjAwMSkuCgpUaGUgd2hpdGUgYmxvb2QgY2VsbCBjb3VudCBpcyBvbiBhdmVyYWdlIGByIG91dHB1dCRlc3RpbWF0ZSAlPiUgZGlmZiAlPiUgYWJzICU+JSBmb3JtYXQoLixkaWdpdHMgPSA1KWAgYmxvb2QgY2VsbHMvbW0kXjMkIGhpZ2hlciBmb3IgcmF0cyB3aXRoIHBlcnR1c3NpcyB0aGFuIGZvciByYXRzIHRoYXQgcmVjZWl2ZWQgYSBjb250cm9sIHRyZWF0bWVudCAoOTUlIENJIFtgciBvdXRwdXQkY29uZi5pbnQgJT4lIGFicyAlPiUgc29ydCAlPiUgZm9ybWF0KC4sZGlnaXRzID0gNSlgXSkuCgoKIyBBRERFTkRVTTogVHJhaW4geW91cnNlbGYgaW4gY2hlY2tpbmcgdGhlIGFzc3VtcHRpb25zCgpJbiBvcmRlciBmb3IgdGhlIGxlYXJuZXJzIHRvIGdldCBtb3JlIHByb2ZpY2llbnQgaW4gZXZhbHVhdGluZyB0aGUgYXNzdW1wdGlvbnMgd2Ugd2lsbCBzaW11bGF0ZSA4IGRhdGFzZXQgd2l0aCBzYW1wbGUgc2l6ZXMgc2ltaWxhciB0byBvdXIgZGF0YSBmb3Igd2hpY2ggdGhlIGFzc3VtcHRpb25zIG9mIG5vcm1hbGl0eSBhbmQgZXF1YWwgdmFyaWFuY2UgZG8gaG9sZC4gRm9yIHRoZSBRUS1wbG90cyB3ZSB3aWxsIG9ubHkgcGxvdCB0aGUgb25lIGZyb20gb25lIG9mIHRoZSBncm91cHMuCgojIyBTaW11bGF0ZSBkYXRhCgpXZSBzaW11bGF0ZSA4IGRhdGFzZXRzIHdpdGggdGhlIHNhbWUgc2FtcGxlIHNpemVzLCBtZWFucyBhbmQgcG9vbGVkIHZhcmlhbmNlIGFzIGluIHRoZSBzYW1wbGUuCgpgYGB7cn0Kc2V0LnNlZWQoMjE1MzIpCm5TaW0gPC0gOAojIyBkZXNjcmlwdGl2ZSBzdGF0aXN0aWNzCndiY1N1bSA8LSB3YmNvbiAlPiUKICBncm91cF9ieSh0cnQpICU+JQogIHN1bW1hcml6ZSgKICAgICAgbWVhbiA9IG1lYW4oV0JDLCBuYS5ybSA9IFRSVUUpLAogICAgICBzZCA9IHNkKFdCQywgbmEucm0gPSBUUlVFKSwKICAgICAgbiA9IG4oKQogICkgJT4lCiAgbXV0YXRlKHNlID0gc2QgLyBzcXJ0KG4pKQoKc2lnbWEgPC0gc3FydChzdW0od2JjU3VtJHNkXjIgKiAod2JjU3VtJG4gLSAxKSkgLyAoc3VtKHdiY1N1bSRuKSAtIDIpKQoKbm9ybVNpbSA8LSBtYXRyaXgoCiAgYygKICAgIHdiY29uJFdCQywKICAgIHJub3JtKHN1bSh3YmNTdW0kbikgKiBuU2ltLAogICAgICAgICAgbWVhbiA9IGMoCiAgICAgICAgICAgIHJlcCh3YmNTdW0kbWVhblsxXSwgd2JjU3VtJG5bMV0pLAogICAgICAgICAgICByZXAod2JjU3VtJG1lYW5bMl0sIHdiY1N1bSRuWzJdKQogICAgICAgICAgICApLAogICAgICAgICAgc2QgPSBzaWdtYSkKICAgICksCiAgbnJvdyA9IHN1bSh3YmNTdW0kbikpICU+JQogIGFzLmRhdGEuZnJhbWUoKSAlPiUKICBtdXRhdGUodHJ0ID0gd2Jjb24kdHJ0KQpgYGAKCiMjIENvbXBhcmlzb25zIG9mIHZhcmlhbmNlcwoKYGBge3J9Cm5hbWVzKG5vcm1TaW0pWzE6KG5TaW0rMSldIDwtIGMoIm9yaWciLHBhc3RlMCgic2ltIiwxOm5TaW0pKQpub3JtU2ltICU+JQogIGdhdGhlcihzYW1wLCBkYXRhLCAtdHJ0KSAlPiUKICBnZ3Bsb3QoYWVzKHggPSB0cnQsIHkgPSBkYXRhKSkgKwogIGdlb21fYm94cGxvdCgpICsKICBmYWNldF93cmFwKH5zYW1wKQpgYGAKCldlIG9ic2VydmUgdGhhdCB0aGUgZGlmZmVyZW5jZSBpbiB2YXJpYWJpbGl0eSBvZiB0aGUgb3JpZ2luYWwgb2JzZXJ2YXRpb25zICh0b3AgbGVmdCBwbG90KSBpcyBsYXJnZXIgdGhhbiBpbiB0aGUgZWFjaCBzaW11bGF0aW9ucy4gSW5kaWNhdGluZyB0aGF0IHRoZXJlIGlzIGluZGVlZCBldmlkZW5jZSB0aGF0IHRoZSB2YXJpYW5jZXMgaW4gZWFjaCBncm91cCBkaWZmZXIuCgojIyBFdmFsdWF0aW9uIG9mIG5vcm1hbGl0eQoKIyMjIENvbnRyb2wgZ3JvdXAKCmBgYHtyfQpub3JtU2ltICU+JQogIGdhdGhlcihzYW1wLCBkYXRhLCAtdHJ0KSAlPiUKICBmaWx0ZXIodHJ0ID09ICJjb250cm9sIikgJT4lCiAgZ2dwbG90KGFlcyhzYW1wbGUgPSBkYXRhKSkgKwogIGdlb21fcXEoKSArCiAgZ2VvbV9xcV9saW5lKCkgKwogIGZhY2V0X3dyYXAofnNhbXApCmBgYAoKIyMjIFBlcnR1c3NpcyBncm91cAoKYGBge3J9Cm5vcm1TaW0gJT4lCiAgZ2F0aGVyKHNhbXAsIGRhdGEsIC10cnQpICU+JQogIGZpbHRlcih0cnQgPT0gInBlcnR1c3NpcyIpICU+JQogIGdncGxvdChhZXMoc2FtcGxlID0gZGF0YSkpICsKICBnZW9tX3FxKCkgKwogIGdlb21fcXFfbGluZSgpICsKICBmYWNldF93cmFwKH5zYW1wKQpgYGAKClRoZSBkYXRhIGluIGVhY2ggZ3JvdXAgZG9lcyBub3Qgc2hvdyBsYXJnZXIgZGV2aWF0aW9ucyBmcm9tIG5vcm1hbGl0eSB0aGFuIHdoYXQgd2Ugb2JzZXJ2ZSBpbiBlYWNoIG9mIHRoZSBlaWdodCBkYXRhc2V0cyB0aGF0IHdlcmUgc2ltdWxhdGVkIHVuZGVyIHRoZSBtb2RlbCBhc3N1bXB0aW9ucy4K</div>
<div class="footer">
    <hr>
    This work is licensed under the <a href= "https://creativecommons.org/licenses/by-nc-sa/4.0">
    CC BY-NC-SA 4.0</a> licence.
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("05_2_pertussis_sol.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
