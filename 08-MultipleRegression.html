<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Lieven Clement" />


<title>8. Multiple regression</title>

<script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">PSLS</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01-intro.html">1. Introduction</a>
    </li>
    <li>
      <a href="02-concepts.html">2. Concepts</a>
    </li>
    <li>
      <a href="03-experimentalDesign.html">3. Experimental Design I</a>
    </li>
    <li>
      <a href="04-dataExploration.html">4. Data Exploration</a>
    </li>
    <li>
      <a href="05-statisticalInference.html">5.1 Statistical Inference 1</a>
    </li>
    <li>
      <a href="05-statisticalInference-twosampleT.html">5.2 Statistical Inference 2</a>
    </li>
    <li>
      <a href="06-linearRegression.html">6. Linear Regression</a>
    </li>
    <li>
      <a href="07-Anova.html">7. Analysis of Variance</a>
    </li>
    <li>
      <a href="08-MultipleRegression.html">8. Multiple Regression</a>
    </li>
    <li>
      <a href="08-MultipleRegression-SpecificDesigns.html">8.2 Multiple Regression: Factorial Designs</a>
    </li>
    <li>
      <a href="08-experimentalDesignII.html">8.3. Experimental Design II</a>
    </li>
    <li>
      <a href="08-experimentalDesignIII.html">8.4. Experimental Design II</a>
    </li>
    <li>
      <a href="09-NonparametericStatistics-WilcoxonMannWithney.html">9.1. Nonparametric Statistics 1</a>
    </li>
    <li>
      <a href="09-NonparametericStatistics-KruskalWallis.html">9.2. Nonparametric Statistics 2</a>
    </li>
    <li>
      <a href="10-categoricalDataAnalysis.html">10. Categorical Data Analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-laptop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="04_exercises.html">4. Data Exploration</a>
    </li>
    <li>
      <a href="05_exercises.html">5. Statistical inference</a>
    </li>
    <li>
      <a href="06_exercises.html">6. Simple linear regression</a>
    </li>
    <li>
      <a href="07_exercises.html">7. ANOVA</a>
    </li>
    <li>
      <a href="08_exercises.html">8. Multiple linear regression</a>
    </li>
    <li>
      <a href="09_exercises.html">9. Non-parametric statistics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/statOmics/PSLS">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://statomics.github.io/">statOmics</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">8. Multiple regression</h1>
<h4 class="author">Lieven Clement</h4>
<h4 class="date">statOmics, Ghent University (<a href="https://statomics.github.io" class="uri">https://statomics.github.io</a>)</h4>

</div>


<p><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a></p>
<div id="intro" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Intro</h1>
<ul>
<li>Until now: one outcome <span class="math inline">\(Y\)</span> and a single predictor <span class="math inline">\(X\)</span>.</li>
<li>Often useful to use multiple predictors to model the response. e.g</li>
</ul>
<ol style="list-style-type: decimal">
<li>Association between X and Y is affected by confounder: Smoking and age by youngsters are confounded and they both affect the lung capacity</li>
<li>Which group of variables is associated with a given outcome. E.g Habitat and human activity on the biodiversity of the rain forest. (Size, age, height of the wood <span class="math inline">\(\rightarrow\)</span> assess all effects simultaneously.</li>
<li>Prediction of outcome for individuals: use as many predictive information simultaneously. E.g prediction of risk on mortality is used on a daily basis in intensive care units to prioritise patient care.</li>
</ol>
<p><span class="math inline">\(\rightarrow\)</span> Extend simple linear regression to multiple predictors.</p>
<hr />
<div id="prostate-cancer-example" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Prostate cancer example</h2>
<ul>
<li><p>Prostate specific antigen (PSA) and a number of clinical variables for 97 males with radical prostatectomy.</p></li>
<li><p>Association of PSA by</p>
<ul>
<li>tumor volume (lcavol)</li>
<li>prostate weight (lweight)</li>
<li>age</li>
<li>benign prostate hypertrophy (lbph)</li>
<li>seminal vesicle invasion (svi)</li>
<li>capsular penetration (lcp)</li>
<li>Gleason score (gleason)</li>
<li>precentage gleason score 4/5 (pgg45)</li>
</ul></li>
</ul>
<hr />
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>prostate <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/GTPB/PSLS20/master/data/prostate.csv&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>prostate</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["lcavol"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["lweight"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["lbph"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["svi"],"name":[5],"type":["chr"],"align":["left"]},{"label":["lcp"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["gleason"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["pgg45"],"name":[8],"type":["chr"],"align":["left"]},{"label":["lpsa"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"-0.579818495","2":"2.769459","3":"50","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"-0.4307829"},{"1":"-0.994252273","2":"3.319626","3":"58","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"-0.1625189"},{"1":"-0.510825624","2":"2.691243","3":"74","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"7","8":"20","9":"-0.1625189"},{"1":"-1.203972804","2":"3.282789","3":"58","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"-0.1625189"},{"1":"0.751416089","2":"3.432373","3":"62","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"0.3715636"},{"1":"-1.049822124","2":"3.228826","3":"50","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"0.7654678"},{"1":"0.737164066","2":"3.473518","3":"64","4":"0.61518564","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"0.7654678"},{"1":"0.693147181","2":"3.539509","3":"58","4":"1.53686722","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"0.8544153"},{"1":"-0.776528789","2":"3.539509","3":"47","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"1.0473190"},{"1":"0.223143551","2":"3.244544","3":"63","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"1.0473190"},{"1":"0.254642218","2":"3.604138","3":"65","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"1.2669476"},{"1":"-1.347073648","2":"3.598681","3":"63","4":"1.26694760","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"1.2669476"},{"1":"1.613429934","2":"3.022861","3":"63","4":"-1.38629436","5":"healthy","6":"-0.59783700","7":"7","8":"30","9":"1.2669476"},{"1":"1.477048724","2":"2.998229","3":"67","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"7","8":"5","9":"1.3480731"},{"1":"1.205970807","2":"3.442019","3":"57","4":"-1.38629436","5":"healthy","6":"-0.43078292","7":"7","8":"5","9":"1.3987169"},{"1":"1.541159072","2":"3.061052","3":"66","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"1.4469190"},{"1":"-0.415515444","2":"3.516013","3":"70","4":"1.24415459","5":"healthy","6":"-0.59783700","7":"7","8":"30","9":"1.4701758"},{"1":"2.288486169","2":"3.649359","3":"66","4":"-1.38629436","5":"healthy","6":"0.37156356","7":"6","8":"healthy","9":"1.4929041"},{"1":"-0.562118918","2":"3.267666","3":"41","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"1.5581446"},{"1":"0.182321557","2":"3.825375","3":"70","4":"1.65822808","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"1.5993876"},{"1":"1.147402453","2":"3.419365","3":"59","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"1.6389967"},{"1":"2.059238834","2":"3.501043","3":"60","4":"1.47476301","5":"healthy","6":"1.34807315","7":"7","8":"20","9":"1.6582281"},{"1":"-0.544727175","2":"3.375880","3":"59","4":"-0.79850770","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"1.6956156"},{"1":"1.781709133","2":"3.451574","3":"63","4":"0.43825493","5":"healthy","6":"1.17865500","7":"7","8":"60","9":"1.7137979"},{"1":"0.385262401","2":"3.667400","3":"69","4":"1.59938758","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"1.7316555"},{"1":"1.446918983","2":"3.124565","3":"68","4":"0.30010459","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"1.7664417"},{"1":"0.512823626","2":"3.719651","3":"65","4":"-1.38629436","5":"healthy","6":"-0.79850770","7":"7","8":"70","9":"1.8000583"},{"1":"-0.400477567","2":"3.865979","3":"67","4":"1.81645208","5":"healthy","6":"-1.38629436","7":"7","8":"20","9":"1.8164521"},{"1":"1.040276712","2":"3.128951","3":"67","4":"0.22314355","5":"healthy","6":"0.04879016","7":"7","8":"80","9":"1.8484548"},{"1":"2.409644165","2":"3.375880","3":"65","4":"-1.38629436","5":"healthy","6":"1.61938824","7":"6","8":"healthy","9":"1.8946169"},{"1":"0.285178942","2":"4.090169","3":"65","4":"1.96290772","5":"healthy","6":"-0.79850770","7":"6","8":"healthy","9":"1.9242487"},{"1":"0.182321557","2":"6.107580","3":"65","4":"1.70474809","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"2.0082140"},{"1":"1.275362800","2":"3.037354","3":"71","4":"1.26694760","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"2.0082140"},{"1":"0.009950331","2":"3.267666","3":"54","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"2.0215476"},{"1":"-0.010050336","2":"3.216874","3":"63","4":"-1.38629436","5":"healthy","6":"-0.79850770","7":"6","8":"healthy","9":"2.0476928"},{"1":"1.308332820","2":"4.119850","3":"64","4":"2.17133681","5":"healthy","6":"-1.38629436","7":"7","8":"5","9":"2.0856721"},{"1":"1.423108334","2":"3.657131","3":"73","4":"-0.57981850","5":"healthy","6":"1.65822808","7":"8","8":"15","9":"2.1575593"},{"1":"0.457424847","2":"2.374906","3":"64","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"7","8":"15","9":"2.1916535"},{"1":"2.660958594","2":"4.085136","3":"68","4":"1.37371558","5":"invasion","6":"1.83258146","7":"7","8":"35","9":"2.2137539"},{"1":"0.797507196","2":"3.013081","3":"56","4":"0.93609336","5":"healthy","6":"-0.16251893","7":"7","8":"5","9":"2.2772673"},{"1":"0.620576488","2":"3.141995","3":"60","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"9","8":"80","9":"2.2975726"},{"1":"1.442201993","2":"3.682610","3":"68","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"7","8":"10","9":"2.3075726"},{"1":"0.582215620","2":"3.865979","3":"62","4":"1.71379793","5":"healthy","6":"-0.43078292","7":"6","8":"healthy","9":"2.3272777"},{"1":"1.771556762","2":"3.896909","3":"61","4":"-1.38629436","5":"healthy","6":"0.81093022","7":"7","8":"6","9":"2.3749058"},{"1":"1.486139696","2":"3.409496","3":"66","4":"1.74919986","5":"healthy","6":"-0.43078292","7":"7","8":"20","9":"2.5217206"},{"1":"1.663926098","2":"3.392829","3":"61","4":"0.61518564","5":"healthy","6":"-1.38629436","7":"7","8":"15","9":"2.5533438"},{"1":"2.727852828","2":"3.995445","3":"79","4":"1.87946505","5":"invasion","6":"2.65675691","7":"9","8":"100","9":"2.5687881"},{"1":"1.163150810","2":"4.035125","3":"68","4":"1.71379793","5":"healthy","6":"-0.43078292","7":"7","8":"40","9":"2.5687881"},{"1":"1.745715531","2":"3.498022","3":"43","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"2.5915164"},{"1":"1.220829921","2":"3.568123","3":"70","4":"1.37371558","5":"healthy","6":"-0.79850770","7":"6","8":"healthy","9":"2.5915164"},{"1":"1.091923301","2":"3.993603","3":"68","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"7","8":"50","9":"2.6567569"},{"1":"1.660131027","2":"4.234831","3":"64","4":"2.07317193","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"2.6775910"},{"1":"0.512823626","2":"3.633631","3":"64","4":"1.49290410","5":"healthy","6":"0.04879016","7":"7","8":"70","9":"2.6844403"},{"1":"2.127040520","2":"4.121473","3":"68","4":"1.76644166","5":"healthy","6":"1.44691898","7":"7","8":"40","9":"2.6912431"},{"1":"3.153590358","2":"3.516013","3":"59","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"7","8":"5","9":"2.7047113"},{"1":"1.266947603","2":"4.280132","3":"66","4":"2.12226154","5":"healthy","6":"-1.38629436","7":"7","8":"15","9":"2.7180005"},{"1":"0.974559640","2":"2.865054","3":"47","4":"-1.38629436","5":"healthy","6":"0.50077529","7":"7","8":"4","9":"2.7880929"},{"1":"0.463734016","2":"3.764682","3":"49","4":"1.42310833","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"2.7942279"},{"1":"0.542324291","2":"4.178226","3":"70","4":"0.43825493","5":"healthy","6":"-1.38629436","7":"7","8":"20","9":"2.8063861"},{"1":"1.061256502","2":"3.851211","3":"61","4":"1.29472717","5":"healthy","6":"-1.38629436","7":"7","8":"40","9":"2.8124102"},{"1":"0.457424847","2":"4.524502","3":"73","4":"2.32630162","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"2.8419982"},{"1":"1.997417706","2":"3.719651","3":"63","4":"1.61938824","5":"invasion","6":"1.90954250","7":"7","8":"40","9":"2.8535925"},{"1":"2.775708850","2":"3.524889","3":"72","4":"-1.38629436","5":"healthy","6":"1.55814462","7":"9","8":"95","9":"2.8535925"},{"1":"2.034705648","2":"3.917011","3":"66","4":"2.00821403","5":"invasion","6":"2.11021320","7":"7","8":"60","9":"2.8820035"},{"1":"2.073171929","2":"3.623007","3":"64","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"2.8820035"},{"1":"1.458615023","2":"3.836221","3":"61","4":"1.32175584","5":"healthy","6":"-0.43078292","7":"7","8":"20","9":"2.8875901"},{"1":"2.022871190","2":"3.878466","3":"68","4":"1.78339122","5":"healthy","6":"1.32175584","7":"7","8":"70","9":"2.9204698"},{"1":"2.198335072","2":"4.050915","3":"72","4":"2.30757264","5":"healthy","6":"-0.43078292","7":"7","8":"10","9":"2.9626924"},{"1":"-0.446287103","2":"4.408547","3":"69","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"2.9626924"},{"1":"1.193922468","2":"4.780383","3":"72","4":"2.32630162","5":"healthy","6":"-0.79850770","7":"7","8":"5","9":"2.9729753"},{"1":"1.864080131","2":"3.593194","3":"60","4":"-1.38629436","5":"invasion","6":"1.32175584","7":"7","8":"60","9":"3.0130809"},{"1":"1.160020917","2":"3.341093","3":"77","4":"1.74919986","5":"healthy","6":"-1.38629436","7":"7","8":"25","9":"3.0373539"},{"1":"1.214912744","2":"3.825375","3":"69","4":"-1.38629436","5":"invasion","6":"0.22314355","7":"7","8":"20","9":"3.0563569"},{"1":"1.838961071","2":"3.236716","3":"60","4":"0.43825493","5":"invasion","6":"1.17865500","7":"9","8":"90","9":"3.0750055"},{"1":"2.999226163","2":"3.849083","3":"69","4":"-1.38629436","5":"invasion","6":"1.90954250","7":"7","8":"20","9":"3.2752562"},{"1":"3.141130476","2":"3.263849","3":"68","4":"-0.05129329","5":"invasion","6":"2.42036813","7":"7","8":"50","9":"3.3375474"},{"1":"2.010894999","2":"4.433789","3":"72","4":"2.12226154","5":"healthy","6":"0.50077529","7":"7","8":"60","9":"3.3928291"},{"1":"2.537657215","2":"4.354784","3":"78","4":"2.32630162","5":"healthy","6":"-1.38629436","7":"7","8":"10","9":"3.4355988"},{"1":"2.648300197","2":"3.582129","3":"69","4":"-1.38629436","5":"invasion","6":"2.58399755","7":"7","8":"70","9":"3.4578927"},{"1":"2.779440197","2":"3.823192","3":"63","4":"-1.38629436","5":"healthy","6":"0.37156356","7":"7","8":"50","9":"3.5130369"},{"1":"1.467874348","2":"3.070376","3":"66","4":"0.55961579","5":"healthy","6":"0.22314355","7":"7","8":"40","9":"3.5160131"},{"1":"2.513656063","2":"3.473518","3":"57","4":"0.43825493","5":"healthy","6":"2.32727771","7":"7","8":"60","9":"3.5307626"},{"1":"2.613006652","2":"3.888754","3":"77","4":"-0.52763274","5":"invasion","6":"0.55961579","7":"7","8":"30","9":"3.5652984"},{"1":"2.677590994","2":"3.838376","3":"65","4":"1.11514159","5":"healthy","6":"1.74919986","7":"9","8":"70","9":"3.5709402"},{"1":"1.562346305","2":"3.709907","3":"60","4":"1.69561561","5":"healthy","6":"0.81093022","7":"7","8":"30","9":"3.5876769"},{"1":"3.302849259","2":"3.518980","3":"64","4":"-1.38629436","5":"invasion","6":"2.32727771","7":"7","8":"60","9":"3.6309855"},{"1":"2.024193067","2":"3.731699","3":"58","4":"1.63899671","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"3.6800909"},{"1":"1.731655545","2":"3.369018","3":"62","4":"-1.38629436","5":"invasion","6":"0.30010459","7":"7","8":"30","9":"3.7123518"},{"1":"2.807593831","2":"4.718052","3":"65","4":"-1.38629436","5":"invasion","6":"2.46385324","7":"7","8":"60","9":"3.9843437"},{"1":"1.562346305","2":"3.695110","3":"76","4":"0.93609336","5":"invasion","6":"0.81093022","7":"7","8":"75","9":"3.9936030"},{"1":"3.246490992","2":"4.101817","3":"68","4":"-1.38629436","5":"healthy","6":"-1.38629436","7":"6","8":"healthy","9":"4.0298060"},{"1":"2.532902848","2":"3.677566","3":"61","4":"1.34807315","5":"invasion","6":"-1.38629436","7":"7","8":"15","9":"4.1295508"},{"1":"2.830267834","2":"3.876396","3":"68","4":"-1.38629436","5":"invasion","6":"1.32175584","7":"7","8":"60","9":"4.3851468"},{"1":"3.821003607","2":"3.896909","3":"44","4":"-1.38629436","5":"invasion","6":"2.16905370","7":"7","8":"40","9":"4.6844434"},{"1":"2.907447359","2":"3.396185","3":"52","4":"-1.38629436","5":"invasion","6":"2.46385324","7":"7","8":"10","9":"5.1431245"},{"1":"2.882563575","2":"3.773910","3":"68","4":"1.55814462","5":"invasion","6":"1.55814462","7":"7","8":"80","9":"5.4775090"},{"1":"3.471966453","2":"3.974998","3":"68","4":"0.43825493","5":"invasion","6":"2.90416508","7":"7","8":"20","9":"5.5829322"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>prostate<span class="sc">$</span>svi <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(prostate<span class="sc">$</span>svi)</span></code></pre></div>
<hr />
<p><img src="08-MultipleRegression_files/figure-html/unnamed-chunk-2-1.png" width="100%" style="display: block; margin: auto;" /></p>
<hr />
</div>
</div>
<div id="additive-multiple-linair-model" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Additive multiple linair model</h1>
<p>Separate simple linair models, like</p>
<p><span class="math display">\[E(Y|X_v)=\alpha+\beta_v X_v\]</span></p>
<ul>
<li>Association between lpsa en 1 variabele e.g lcavol.</li>
<li>More accurate predictions by simultaneously accounting for multiple predictors</li>
<li>Estimate for parameter <span class="math inline">\(\beta_v\)</span> does not only capture the effect of tumor volume.</li>
<li><span class="math inline">\(\beta_v\)</span> average difference for log-psa for patients that differ in 1 unit of the log tumor volume.</li>
<li>Even if lcavol is not associated with lpsa then patients with a higher tumor volume can have a higher lpsa because their semen vesicles are affected (svi status 1). <span class="math inline">\(\rightarrow\)</span> confounding.</li>
<li>Compare patients with same svi status</li>
<li>Is posible in multiple linear model</li>
</ul>
<hr />
<div id="statistical-model" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Statistical model</h2>
<ul>
<li><span class="math inline">\(p-1\)</span> predictors <span class="math inline">\(X_1,...,X_{p-1}\)</span> and outcome <span class="math inline">\(Y\)</span> for <span class="math inline">\(n\)</span> subjecten.</li>
</ul>
<p><span class="math display">\[\begin{equation}
Y_i =\beta_0 + \beta_1 X_{i1} + ... +\beta_{p-1} X_{ip-1} + \epsilon_i
\end{equation}\]</span></p>
<ul>
<li><span class="math inline">\(\beta_0,\beta_1,...,\beta_{p-1}\)</span> unknown parameters</li>
<li><span class="math inline">\(\epsilon_i\)</span> residuals that cannot be explained by predictors</li>
<li>Estimation by <em>least squares method</em></li>
</ul>
<hr />
<p>Model allows to</p>
<ol style="list-style-type: decimal">
<li>predict the expected outcome for subjects given their values <span class="math inline">\(x_1,...,x_{p-1}\)</span> for the predictor variables. <span class="math inline">\(E[Y\vert X_1=x_1, \ldots X_{p-1}=x_{p-1}]=\hat{\beta}_0+\hat{\beta}_1x_1+...+\hat{\beta}_{p-1}x_{p-1}\)</span>.</li>
<li>Does the average outcome differ between two groups of patients that differ by <span class="math inline">\(\delta\)</span> units in predictor <span class="math inline">\(X_j\)</span> but have the same value for the remaining variables <span class="math inline">\(\{X_k,k=1,...,p,k\ne j\}\)</span>. <span class="math display">\[
\begin{array}{l}
E(Y|X_1=x_1,...,X_j=x_j+\delta,...,X_{p-1}=x_{p-1}) \\
\quad\quad - E(Y|X_1=x_1,...,X_j=x_j,...,X_{p-1}=x_{p-1}) \\\\
\quad =\beta_0 + \beta_1 x_1 + ... + \beta_j(x_j+\delta)+...+\beta_{p-1} x_{p-1}\\
\quad\quad- \beta_0 - \beta_1 x_1 - ... - \beta_jx_j-...-\beta_{p-1} x_{p-1} \\\\
\quad= \beta_j\delta
\end{array}
\]</span></li>
</ol>
<p>Interpretation <span class="math inline">\(\beta_j\)</span>:</p>
<ul>
<li>difference in mean outcome between subjects that differ in one unit of <span class="math inline">\(X_j\)</span>, but have the same value for the remaining predictors in the model.</li>
</ul>
<p>or</p>
<ul>
<li>Effect of predictor j corrected for the remaining predictors. e.g. effect of cancer volume correct for prostate weight and the svi status.</li>
</ul>
<hr />
<div id="prostate-example" class="section level3" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Prostate example</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>lmV <span class="ot">&lt;-</span> <span class="fu">lm</span>(lpsa <span class="sc">~</span> lcavol, prostate)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmV)</span></code></pre></div>
<pre><code>
Call:
lm(formula = lpsa ~ lcavol, data = prostate)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.67624 -0.41648  0.09859  0.50709  1.89672 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.50730    0.12194   12.36   &lt;2e-16 ***
lcavol       0.71932    0.06819   10.55   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.7875 on 95 degrees of freedom
Multiple R-squared:  0.5394,    Adjusted R-squared:  0.5346 
F-statistic: 111.3 on 1 and 95 DF,  p-value: &lt; 2.2e-16</code></pre>
<hr />
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>lmVWS <span class="ot">&lt;-</span> <span class="fu">lm</span>(lpsa <span class="sc">~</span> lcavol <span class="sc">+</span> lweight <span class="sc">+</span> svi, prostate)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmVWS)</span></code></pre></div>
<pre><code>
Call:
lm(formula = lpsa ~ lcavol + lweight + svi, data = prostate)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.72966 -0.45767  0.02814  0.46404  1.57012 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.26807    0.54350  -0.493  0.62301    
lcavol       0.55164    0.07467   7.388  6.3e-11 ***
lweight      0.50854    0.15017   3.386  0.00104 ** 
sviinvasion  0.66616    0.20978   3.176  0.00203 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.7168 on 93 degrees of freedom
Multiple R-squared:  0.6264,    Adjusted R-squared:  0.6144 
F-statistic: 51.99 on 3 and 93 DF,  p-value: &lt; 2.2e-16</code></pre>
<hr />
<p><img src="08-MultipleRegression_files/figure-html/unnamed-chunk-5-1.png" width="80%" style="display: block; margin: auto;" /></p>
<hr />
</div>
</div>
</div>
<div id="inference-in-multiple-linear-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Inference in multiple linear models</h1>
<p>If data are representative than the least squares estimators for the intercept and slopes are unbiased. <span class="math display">\[E[\hat \beta_j]=\beta_j,\quad j=0,\ldots,p-1.\]</span></p>
<ul>
<li><p>Gain insight in the distribution of the parameter estimators so as to generalize the effect in the sample to the population.</p></li>
<li><p>Additional assumptions are needed for inference.</p></li>
</ul>
<ol style="list-style-type: decimal">
<li><p><em>Linearity</em></p></li>
<li><p><em>Independence</em></p></li>
<li><p><em>Homoscedasticity</em> of <em>equal variance</em></p></li>
<li><p><em>Normality</em>: residuals <span class="math inline">\(\epsilon_i\)</span> are normally distributed.</p></li>
</ol>
<p>Under these assumptions: <span class="math display">\[\epsilon_i \sim N(0,\sigma^2).\]</span> en <span class="math display">\[Y_i\sim N(\beta_0+\beta_1 X_{i1}+\ldots+\beta_{p-1} X_{ip-1},\sigma^2)\]</span></p>
<hr />
<ul>
<li><p>Slopes are again more precise if the predictor values have a larger range.</p></li>
<li><p>Conditional variance (<span class="math inline">\(\sigma^2\)</span>) can again be estimated based on the <em>mean squared error</em> (MSE):</p></li>
</ul>
<p><span class="math display">\[\hat\sigma^2=MSE=\frac{\sum\limits_{i=1}^n \left(y_i-\hat\beta_0-\hat\beta_1 X_{i1}-\ldots-\hat\beta_{p-1} X_{ip-1}\right)^2}{n-p}=\frac{\sum\limits_{i=1}^n e^2_i}{n-p}.\]</span></p>
<p>Again hypothesis tests and confidence intervals by <span class="math display">\[T_k=\frac{\hat{\beta}_k-\beta_k}{SE(\hat{\beta}_k)} \text{ met } k=0, \ldots, p-1.\]</span></p>
<p>If all assumptions are satisfied than the statistics <span class="math inline">\(T_k\)</span> t-distributed with <span class="math inline">\(n-p\)</span> degrees of freedom.</p>
<hr />
<p>When normality thus not hold, but lineariteit, independence and homoscedasticity are valid we can again adopt the CLT that states that statistic <span class="math inline">\(T_k\)</span> is approximately normally distributed in large samples.</p>
<hr />
<p>We can build confidence intervals on the slopes by: <span class="math display">\[[\hat\beta_j - t_{n-p,\alpha/2} \text{SE}_{\hat\beta_j},\hat\beta_j + t_{n-p,\alpha/2} \text{SE}_{\hat\beta_j}]\]</span>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lmVWS)</span></code></pre></div>
<pre><code>                 2.5 %    97.5 %
(Intercept) -1.3473509 0.8112061
lcavol       0.4033628 0.6999144
lweight      0.2103288 0.8067430
sviinvasion  0.2495824 1.0827342</code></pre>
<hr />
<p>Formal hypothesis tests: <span class="math display">\[H_0: \beta_j=0\]</span> <span class="math display">\[H_1: \beta_j\neq0\]</span></p>
<p>With test statistic <span class="math display">\[T=\frac{\hat{\beta}_j-0}{SE(\hat{\beta}_j)}\]</span> which follows a t-distribution with <span class="math inline">\(n-p\)</span> degrees of freedom under <span class="math inline">\(H_0\)</span></p>
<hr />
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmVWS)</span></code></pre></div>
<pre><code>
Call:
lm(formula = lpsa ~ lcavol + lweight + svi, data = prostate)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.72966 -0.45767  0.02814  0.46404  1.57012 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.26807    0.54350  -0.493  0.62301    
lcavol       0.55164    0.07467   7.388  6.3e-11 ***
lweight      0.50854    0.15017   3.386  0.00104 ** 
sviinvasion  0.66616    0.20978   3.176  0.00203 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.7168 on 93 degrees of freedom
Multiple R-squared:  0.6264,    Adjusted R-squared:  0.6144 
F-statistic: 51.99 on 3 and 93 DF,  p-value: &lt; 2.2e-16</code></pre>
<hr />
<div id="assess-the-model-assumptions" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Assess the model assumptions</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lmVWS)</span></code></pre></div>
<p><img src="08-MultipleRegression_files/figure-html/unnamed-chunk-8-1.png" width="672" /><img src="08-MultipleRegression_files/figure-html/unnamed-chunk-8-2.png" width="672" /><img src="08-MultipleRegression_files/figure-html/unnamed-chunk-8-3.png" width="672" /><img src="08-MultipleRegression_files/figure-html/unnamed-chunk-8-4.png" width="672" /></p>
<hr />
</div>
<div id="the-non-additive-multiple-linear-model" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> The non additive multiple linear model</h2>
<div id="interaction-between-two-continuous-variables" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Interaction between two continuous variables</h3>
<p>The previous model is additive because the contribution of the cancer volume on lpsa does not depend on the height of the prostate weight and the svi status.</p>
<p>The slope for lcavol does not depend on log prostate weight and svi.</p>
<p><span class="math display">\[
\beta_0 + \beta_v (x_{v}+\delta_v) + \beta_w x_{w} +\beta_s x_{s} - \beta_0 - \beta_v x_{v} - \beta_w x_{w} -\beta_s x_s = \beta_v \delta_v
\]</span></p>
<p>The svi status and the log-prostategewicht (<span class="math inline">\(x_w\)</span>) do not influence the contribution of the log-tumor volume (<span class="math inline">\(x_v\)</span>) to the average log-PSA and vice versa.</p>
<hr />
<ul>
<li>It is however possible that the association of lpsa and lcavol depends on the prostate weight.</li>
<li>The average difference in lpsa for patients that differ in one unit of the log-tumor volume can for instance can be higher for patients wiht a high tumor weight then for those with a low tumor weight.</li>
<li>The effect of the tumor volume on the PSA depends on the prostate weight.</li>
</ul>
<p>To model this <strong>interactie</strong> or <strong>effect modification</strong> we can add a product term of both variables to the model</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_v x_{iv} + \beta_w x_{iw} +\beta_s x_{is} + \beta_{vw} x_{iv}x_{iw} +\epsilon_i
\]</span></p>
<p>This term quantifies the <em>interactie-effect</em> of predictors <span class="math inline">\(x_v\)</span> en <span class="math inline">\(x_w\)</span> on the mean outcome.</p>
<p>Terms <span class="math inline">\(\beta_vx_{iv}\)</span> and <span class="math inline">\(\beta_wx_{iw}\)</span> are referred to as <em>main effects</em> of predictors <span class="math inline">\(x_v\)</span> and <span class="math inline">\(x_w\)</span>.</p>
<hr />
<p>The difference in lpsa for patients that differ 1 unit in <span class="math inline">\(X_v\)</span> and have an equal log prostate weight and the same svi status now becomes:</p>
<p><span class="math display">\[
\begin{array}{l}
E(Y | X_v=x_v +1, X_w=x_w, X_s=x_s) - E(Y | X_v=x_v, X_w=x_w, X_s=x_s) \\
\quad = \beta_0 + \beta_v (x_{v}+1) + \beta_w x_w +\beta_s x_{s} + \beta_{vw} (x_{v}+1) x_w - \beta_0 - \beta_v x_{v} - \beta_w x_w -\beta_s x_{s} - \beta_{vw} (x_{v}) x_w \\
\quad = \beta_v +  \beta_{vw} x_w
 \end{array}
 \]</span></p>
<hr />
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>lmVWS_IntVW <span class="ot">&lt;-</span> <span class="fu">lm</span>(lpsa <span class="sc">~</span> lcavol <span class="sc">+</span> lweight <span class="sc">+</span> svi <span class="sc">+</span> lcavol<span class="sc">:</span>lweight, prostate)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmVWS_IntVW)</span></code></pre></div>
<pre><code>
Call:
lm(formula = lpsa ~ lcavol + lweight + svi + lcavol:lweight, 
    data = prostate)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.65886 -0.44673  0.02082  0.50244  1.57457 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)     -0.6430     0.7030  -0.915  0.36278   
lcavol           1.0046     0.5427   1.851  0.06734 . 
lweight          0.6146     0.1961   3.134  0.00232 **
sviinvasion      0.6859     0.2114   3.244  0.00164 **
lcavol:lweight  -0.1246     0.1478  -0.843  0.40156   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.7179 on 92 degrees of freedom
Multiple R-squared:  0.6293,    Adjusted R-squared:  0.6132 
F-statistic: 39.05 on 4 and 92 DF,  p-value: &lt; 2.2e-16</code></pre>
<hr />
<p><img src="08-MultipleRegression_files/figure-html/unnamed-chunk-10-1.png" width="100%" style="display: block; margin: auto;" /></p>
<hr />
<ul>
<li>Note that the interaction effect that is observed is not statistically significant (p=0.4).</li>
<li>The main effects that are involved in the interaction cannot be interpreted separately from one another.</li>
<li>We will therefore remove non-significant interaction terms from the model.</li>
<li>Upon removal of non-significant interaction terms the main effects can be interpreted.</li>
</ul>
<hr />
</div>
</div>
<div id="interaction-between-a-continuous-variable-and-a-factor-variable" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Interaction between a continuous variable and a factor variable</h2>
<p>Interaction between lcavol <span class="math inline">\(\leftrightarrow\)</span> svi and lweight <span class="math inline">\(\leftrightarrow\)</span> svi.</p>
<p>The model becomes</p>
<p><span class="math display">\[Y=\beta_0+\beta_vX_v+\beta_wX_w+\beta_sX_s+\beta_{vs}X_vX_s + \beta_{ws}X_wX_s +\epsilon\]</span></p>
<hr />
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>lmVWS_IntVS_WS <span class="ot">&lt;-</span> <span class="fu">lm</span>(lpsa <span class="sc">~</span> lcavol <span class="sc">+</span> lweight <span class="sc">+</span> svi <span class="sc">+</span> svi<span class="sc">:</span>lcavol <span class="sc">+</span> svi<span class="sc">:</span>lweight, <span class="at">data =</span> prostate)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmVWS_IntVS_WS)</span></code></pre></div>
<pre><code>
Call:
lm(formula = lpsa ~ lcavol + lweight + svi + svi:lcavol + svi:lweight, 
    data = prostate)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.50902 -0.44807  0.06455  0.45657  1.54354 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         -0.52642    0.56793  -0.927 0.356422    
lcavol               0.54060    0.07821   6.912 6.38e-10 ***
lweight              0.58292    0.15699   3.713 0.000353 ***
sviinvasion          3.43653    1.93954   1.772 0.079771 .  
lcavol:sviinvasion   0.13467    0.25550   0.527 0.599410    
lweight:sviinvasion -0.82740    0.52224  -1.584 0.116592    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.7147 on 91 degrees of freedom
Multiple R-squared:  0.6367,    Adjusted R-squared:  0.6167 
F-statistic: 31.89 on 5 and 91 DF,  p-value: &lt; 2.2e-16</code></pre>
<hr />
<p>Because <span class="math inline">\(X_S\)</span> is a dummy variabele we obtain to distinct regression planes:</p>
<ol style="list-style-type: decimal">
<li>Model for <span class="math inline">\(X_s=0\)</span>: <span class="math display">\[Y=\beta_0+\beta_vX_v+\beta_wX_w + \epsilon\]</span> where the main effects are the slope for lcavol and lweight</li>
<li>and model for <span class="math inline">\(X_s=1\)</span>: <span class="math display">\[\begin{array}{lcl}
Y&amp;=&amp;\beta_0+\beta_vX_v+\beta_s+\beta_wX_w+\beta_{vs}X_v + \beta_{ws}X_w +\epsilon\\
  &amp;=&amp; (\beta_0+\beta_s)+(\beta_v+\beta_{vs})X_v+(\beta_w+\beta_{ws})X_w+\epsilon
  \end{array}\]</span> with intercept <span class="math inline">\(\beta_0+\beta_s\)</span> and slopes <span class="math inline">\(\beta_v+\beta_{vs}\)</span> and <span class="math inline">\(\beta_w+\beta_{ws}\)</span></li>
</ol>
<hr />
<p><img src="08-MultipleRegression_files/figure-html/unnamed-chunk-12-1.png" width="100%" style="display: block; margin: auto;" /></p>
<hr />
</div>
</div>
<div id="anova-tabel" class="section level1" number="4">
<h1><span class="header-section-number">4</span> ANOVA Tabel</h1>
<p>The total SSTot is again</p>
<p><span class="math display">\[
  \text{SSTot} = \sum_{i=1}^n (Y_i - \bar{Y})^2.
\]</span></p>
<p>The residual sum of squares remains similar <span class="math display">\[
  \text{SSE} = \sum_{i=1}^n (Y_i-\hat{Y}_i)^2.
\]</span></p>
<p>Again the total sum of squares can be decomposed in , <span class="math display">\[
  \text{SSTot} = \text{SSR} + \text{SSE} ,
\]</span> with <span class="math display">\[
  \text{SSR} = \sum_{i=1}^n (\hat{Y}_i-\bar{Y})^2.
\]</span></p>
<hr />
<p>We have following degrees of freedom and mean sum of squares:</p>
<ul>
<li>SSTot has <span class="math inline">\(n-1\)</span> degrees of freedom and <span class="math inline">\(\text{SSTot}/(n-1)\)</span> is an estimator for the total variance in <span class="math inline">\(Y\)</span> (marginal distribution of <span class="math inline">\(Y\)</span>).</li>
<li>SSE has <span class="math inline">\(n-p\)</span> degrees of freedom and <span class="math inline">\(\text{MSE}=\text{SSE}/(n-p)\)</span> is an schatter for the residual variance of <span class="math inline">\(Y\)</span> given the predictores (i.e. an estimator for the residual variance <span class="math inline">\(\sigma^2\)</span> of the error term <span class="math inline">\(\epsilon\)</span>).</li>
<li>SSR has <span class="math inline">\(p-1\)</span> degrees of freedom and <span class="math inline">\(\text{MSR}=\text{SSR}/(p-1)\)</span> is the mean sum of squares of the regression.</li>
</ul>
<p>The determination coefficients remains as before, i.e. <span class="math display">\[
  R^2 = 1-\frac{\text{SSE}}{\text{SSTot}} = \frac{\text{SSR}}{\text{SSTot}}
\]</span> and is the fraction of the total variability that can be explained by the regression model.</p>
<p>Teststatistic <span class="math inline">\(F=\text{MSR}/\text{MSE}\)</span> is under <span class="math inline">\(H_0:\beta_1=\ldots=\beta_{p-1}=0\)</span> distributed by an F distribution: <span class="math inline">\(F_{p-1;n-p}\)</span>.</p>
<hr />
<pre><code>
Call:
lm(formula = lpsa ~ lcavol + lweight + svi, data = prostate)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.72966 -0.45767  0.02814  0.46404  1.57012 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.26807    0.54350  -0.493  0.62301    
lcavol       0.55164    0.07467   7.388  6.3e-11 ***
lweight      0.50854    0.15017   3.386  0.00104 ** 
sviinvasion  0.66616    0.20978   3.176  0.00203 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.7168 on 93 degrees of freedom
Multiple R-squared:  0.6264,    Adjusted R-squared:  0.6144 
F-statistic: 51.99 on 3 and 93 DF,  p-value: &lt; 2.2e-16</code></pre>
<hr />
<div id="additional-sums-of-squares" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Additional sums of squares</h2>
<p>Consider 2 models for the predictors <span class="math inline">\(x_1\)</span> en <span class="math inline">\(x_2\)</span>: <span class="math display">\[
  Y_i = \beta_0+\beta_1 x_{i1} + \epsilon_i,
\]</span> with <span class="math inline">\(\epsilon_i\text{ iid } N(0,\sigma_1^{2})\)</span>, and <span class="math display">\[
Y_i = \beta_0+\beta_1 x_{i1}+\beta_2 x_{i2} + \epsilon_i,
\]</span> with <span class="math inline">\(\epsilon_i\text{ iid } N(0,\sigma_2^{2})\)</span>.</p>
<p>for the first (gereduceerde) model we have decomposition <span class="math display">\[
  \text{SSTot} = \text{SSR}_1 + \text{SSE}_1
\]</span> en for the second non-reduced model we have <span class="math display">\[
  \text{SSTot} = \text{SSR}_2 + \text{SSE}_2
\]</span> (SSTot is of course the same because it only depends on the response and not of the models).</p>
<hr />
<p><strong>Definition of additional sum of squares</strong> The <em>additional sum of squares</em> of predictor <span class="math inline">\(x_2\)</span> as compared to the model with only <span class="math inline">\(x_1\)</span> as predictor is given by <span class="math display">\[
  \text{SSR}_{2\mid 1} = \text{SSE}_1-\text{SSE}_2=\text{SSR}_2-\text{SSR}_1.
\]</span></p>
<p>Note that, <span class="math inline">\(\text{SSE}_1-\text{SSE}_2=\text{SSR}_2-\text{SSR}_1\)</span> is triviaal is because of the decomposition of the total sum of squares.</p>
<p>The additional sum of squares <span class="math inline">\(\text{SSR}_{2\mid 1}\)</span> can simply be interpreted as the additional variability that can be explained by adding predictor <span class="math inline">\(x_2\)</span> to the model with predictor <span class="math inline">\(x_1\)</span>.</p>
<p>With this sum of squares we can further decompose the total sum of squares <span class="math display">\[
  \text{SSTot} = \text{SSR}_1+ \text{SSR}_{2\mid 1} + \text{SSE}.
\]</span> which follows directly from the definition <span class="math inline">\(\text{SSR}_{2\mid 1}\)</span>.</p>
<hr />
<p>Extension: (<span class="math inline">\(s&lt;p-1\)</span>) <span class="math display">\[
Y_i = \beta_0 + \beta_1 x_{i1} + \cdots + \beta_{s} x_{is} + \epsilon_i
\]</span> with <span class="math inline">\(\epsilon_i\text{ iid }N(0,\sigma_1^{2})\)</span>, and (<span class="math inline">\(s&lt; q\leq p-1\)</span>) <span class="math display">\[
Y_i = \beta_0 + \beta_1 x_{i1} + \cdots + \beta_{s} x_{is} + \beta_{s+1} x_{is+1} + \cdots \beta_{q}x_{iq}+ \epsilon_i
\]</span> with <span class="math inline">\(\epsilon_i\text{ iid } N(0,\sigma_2^{2})\)</span>.</p>
<p>The <strong>additional sum of squares</strong> of predictor <span class="math inline">\(x_{s+1}, \ldots, x_q\)</span> compared to a model with only predictors <span class="math inline">\(x_1,\ldots, x_{s}\)</span> is given by</p>
<p><span class="math display">\[
  \text{SSR}_{s+1, \ldots, q\mid 1,\ldots, s} = \text{SSE}_1-\text{SSE}_2=\text{SSR}_2-\text{SSR}_1.
\]</span></p>
<hr />
<div id="type-i-sums-of-squares" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Type I Sums of Squares</h3>
<p>Suppose that <span class="math inline">\(p-1\)</span> predictors are considered, and suppose the following sequence of models (<span class="math inline">\(s=2,\ldots, p-1\)</span>) <span class="math display">\[
Y_i = \beta_0 + \sum_{j=1}^{s} \beta_j x_{ij} + \epsilon_i
\]</span> wuth <span class="math inline">\(\epsilon_i\text{ iid } N(0,\sigma^{2})\)</span>.</p>
<ul>
<li>The corresponding sum of squares are denoted as <span class="math inline">\(\text{SSR}_{s}\)</span> and <span class="math inline">\(\text{SSE}_{s}\)</span>.</li>
<li>The sequence of models gives rise to the following sums of squares: <span class="math inline">\(\text{SSR}_{s\mid 1,\ldots, s-1}\)</span>.</li>
<li>The latter sum of squares is referred to as type I sums of squares. Note that they depend on the order in which the models were added to the model.</li>
</ul>
<hr />
<p>We can show for model Model with <span class="math inline">\(s=p-1\)</span> that <span class="math display">\[
 \text{SSTot} = \text{SSR}_1 + \text{SSR}_{2\mid 1} + \text{SSR}_{3\mid 1,2} + \cdots + \text{SSR}_{p-1\mid 1,\ldots, p-2} + \text{SSE},
\]</span> with <span class="math inline">\(\text{SSE}\)</span> the residual sum of squares of the model with all <span class="math inline">\(p-1\)</span> predictors <span class="math display">\[
  \text{SSR}_1 + \text{SSR}_{2\mid 1} + \text{SSR}_{3\mid 1,2} + \cdots + \text{SSR}_{p-1\mid 1,\ldots, p-2} = \text{SSR}
\]</span> with <span class="math inline">\(\text{SSR}\)</span> the sum of squares of all <span class="math inline">\(p-1\)</span> predictors.</p>
<ul>
<li>The interpretation of each term depends on the order of the sequence of the regression models.</li>
</ul>
<hr />
<ul>
<li>Each type I SSR involves 1 predictor and has 1 degree of freedom (note that multiple dummies for a factor are typically removed together).</li>
<li>For each type I SSR term the mean sum of squares is defined by <span class="math inline">\(\text{MSR}_{j\mid 1,\ldots, j-1}=\text{SSR}_{j\mid 1,\ldots, j-1}/1\)</span>.</li>
<li>And teststatistic <span class="math inline">\(F=\text{MSR}_{j\mid 1,\ldots, j-1}/\text{MSE}\)</span> follows a <span class="math inline">\(F_{1;n-(j+1)}\)</span> distribution under <span class="math inline">\(H_0:\beta_j=0\)</span> with <span class="math inline">\(s=j\)</span>.</li>
<li>These sums of squares are the default sum of squares in the anova function of R.</li>
</ul>
<hr />
</div>
<div id="type-iii-sums-of-squares" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Type III Sums of squares</h3>
<p>Type III sum of squares for predictor <span class="math inline">\(x_j\)</span> are given by the additional sum of squares <span class="math display">\[
  \text{SSR}_{j \mid 1,\ldots, j-1,j+1,\ldots, p-1} = \text{SSE}_1-\text{SSE}_2
\]</span></p>
<ul>
<li><span class="math inline">\(\text{SSE}_2\)</span> the sum of squares of the residuals of the model with all <span class="math inline">\(p-1\)</span> predictors.</li>
<li><span class="math inline">\(\text{SSE}_1\)</span> sum of squares of the residuals with all <span class="math inline">\(p-1\)</span> predictors, except for predictor <span class="math inline">\(x_j\)</span>.</li>
</ul>
<p>The type III sum of squares <span class="math inline">\(\text{SSR}_{j \mid 1,\ldots, j-1,j+1,\ldots, p-1}\)</span> quantify the contribution in the total variance of the outcome explained by <span class="math inline">\(x_j\)</span> that cannot be explained by the remaining <span class="math inline">\(p-2\)</span> predictors.</p>
<hr />
<p>The type III sum of squares has 1 degree of freedom because it involves 1 <span class="math inline">\(\beta\)</span>-parameter.</p>
<p>For each type III SSR term the mean sum of squares is defined by <span class="math inline">\(\text{MSR}_{j \mid 1,\ldots, j-1,j+1,\ldots, p-1}=\text{SSR}_{j \mid 1,\ldots, j-1,j+1,\ldots, p-1}/1\)</span>.</p>
<p>Teststatistiek <span class="math inline">\(F=\text{MSR}_{j \mid 1,\ldots, j-1,j+1,\ldots, p-1}/\text{MSE}\)</span> is <span class="math inline">\(F_{1;n-p}\)</span> distributed under <span class="math inline">\(H_0:\beta_j=0\)</span>.</p>
</div>
</div>
<div id="we-can-obtain-these-sums-of-squares-using-the-anova-function-from-the-car-package." class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> We can obtain these sums of squares using the <code>Anova</code> function from the <code>car</code> package.</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(lmVWS, <span class="at">type =</span> <span class="dv">3</span>)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Sum Sq"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.1250021","2":"1","3":"0.2432815","4":"6.230088e-01","_rn_":"(Intercept)"},{"1":"28.0445759","2":"1","3":"54.5808864","4":"6.303883e-11","_rn_":"lcavol"},{"1":"5.8923334","2":"1","3":"11.4677711","4":"1.039115e-03","_rn_":"lweight"},{"1":"5.1813959","2":"1","3":"10.0841312","4":"2.029035e-03","_rn_":"svi"},{"1":"47.7849616","2":"93","3":"NA","4":"NA","_rn_":"Residuals"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The p-values are identical to those of two-sided t-tests</p>
<p>Note, however, that all dummies for factors with multiple levels will be taken out of the model at once. So then the type III sum of squares will have as many degrees of freedom as the number of dummies and an omnibus test is performed for the effect of the factor.</p>
<hr />
</div>
</div>
<div id="diagnostics" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Diagnostics</h1>
<div id="multicollineariteit" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Multicollineariteit</h2>
<pre><code>
Call:
lm(formula = lpsa ~ lcavol + lweight + svi, data = prostate)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.72966 -0.45767  0.02814  0.46404  1.57012 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.26807    0.54350  -0.493  0.62301    
lcavol       0.55164    0.07467   7.388  6.3e-11 ***
lweight      0.50854    0.15017   3.386  0.00104 ** 
sviinvasion  0.66616    0.20978   3.176  0.00203 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.7168 on 93 degrees of freedom
Multiple R-squared:  0.6264,    Adjusted R-squared:  0.6144 
F-statistic: 51.99 on 3 and 93 DF,  p-value: &lt; 2.2e-16</code></pre>
<hr />
<pre><code>
Call:
lm(formula = lpsa ~ lcavol + lweight + svi + lcavol:lweight, 
    data = prostate)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.65886 -0.44673  0.02082  0.50244  1.57457 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)     -0.6430     0.7030  -0.915  0.36278   
lcavol           1.0046     0.5427   1.851  0.06734 . 
lweight          0.6146     0.1961   3.134  0.00232 **
sviinvasion      0.6859     0.2114   3.244  0.00164 **
lcavol:lweight  -0.1246     0.1478  -0.843  0.40156   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.7179 on 92 degrees of freedom
Multiple R-squared:  0.6293,    Adjusted R-squared:  0.6132 
F-statistic: 39.05 on 4 and 92 DF,  p-value: &lt; 2.2e-16</code></pre>
<hr />
<ul>
<li><p>Estimates are different from those in the additive model and the standard errors are much higher!</p></li>
<li><p>This is caused by the multicollinearity problem.</p></li>
<li><p>If 2 predictors are strongly correlated than they share a lot of information.</p></li>
<li><p>It is therefore difficult to estimate the individual contribution of each predictor on the outcome.</p></li>
<li><p>Least squares estimators become instable.</p></li>
<li><p>Standard errors become inflated.</p></li>
<li><p>As long as we only do predictions on the basis of the regression model without extrapolating beyond the range of the predictors observed in the sample multicolinearity is not problematic.</p></li>
<li><p>But for inference it is problematic.</p></li>
</ul>
<hr />
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(<span class="fu">cbind</span>(prostate<span class="sc">$</span>lcavol, prostate<span class="sc">$</span>lweight, prostate<span class="sc">$</span>lcavol <span class="sc">*</span> prostate<span class="sc">$</span>lweight))</span></code></pre></div>
<pre><code>          [,1]      [,2]      [,3]
[1,] 1.0000000 0.1941283 0.9893127
[2,] 0.1941283 1.0000000 0.2835608
[3,] 0.9893127 0.2835608 1.0000000</code></pre>
<ul>
<li>High correlation between log-tumor volume and interaction.</li>
<li>It is a known problem for higher order terms (interactions and quadratic terms)</li>
</ul>
<hr />
<ul>
<li>Detect multicollineariteit based on the correlation matrix or scatterplot matrix is suboptimal.</li>
<li>In models with 3 or more predictors, say X1, X2, X3 we can have high multicollinearity while alle pairswise correlations between the predictors are low.</li>
<li>We also have multicollinearity if there is a high correlation between X1 and a linair combination of X2 and X3.</li>
</ul>
<hr />
<div id="variance-inflation-factor-vif" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Variance inflation factor (VIF)</h3>
<p>For parameter <span class="math inline">\(j\)</span> in de regression model <span class="math display">\[\textrm{VIF}_j=\left(1-R_j^2\right)^{-1}\]</span></p>
<ul>
<li>In this expression <span class="math inline">\(R_j^2\)</span> is the multiple determination coefficient of the linear regression of predictor j on the remaining predictors in the model.</li>
<li>VIF is 1 if predictor j is not linear associated with the remaining predictors in the model.</li>
<li>VIF is larger than 1 in all andere cases.</li>
<li>VIF is the factor with which the observed variance inflates as compared to a model for which all predictoren would be independend.</li>
<li>VIF &gt; 10 <span class="math inline">\(\rightarrow\)</span> strong multicollinearity.</li>
</ul>
<hr />
</div>
<div id="body-fat-example" class="section level3" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Body fat example</h3>
<p><img src="08-MultipleRegression_files/figure-html/unnamed-chunk-18-1.png" width="90%" style="display: block; margin: auto;" /></p>
<hr />
<pre><code>
Call:
lm(formula = Body_fat ~ Triceps + Thigh + Midarm, data = bodyfat)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.7263 -1.6111  0.3923  1.4656  4.1277 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  117.085     99.782   1.173    0.258
Triceps        4.334      3.016   1.437    0.170
Thigh         -2.857      2.582  -1.106    0.285
Midarm        -2.186      1.595  -1.370    0.190

Residual standard error: 2.48 on 16 degrees of freedom
Multiple R-squared:  0.8014,    Adjusted R-squared:  0.7641 
F-statistic: 21.52 on 3 and 16 DF,  p-value: 7.343e-06</code></pre>
<hr />
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(lmFat)</span></code></pre></div>
<pre><code> Triceps    Thigh   Midarm 
708.8429 564.3434 104.6060 </code></pre>
<hr />
<pre><code>
Call:
lm(formula = Midarm ~ Triceps + Thigh, data = bodyfat)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.58200 -0.30625  0.02592  0.29526  0.56102 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 62.33083    1.23934   50.29   &lt;2e-16 ***
Triceps      1.88089    0.04498   41.82   &lt;2e-16 ***
Thigh       -1.60850    0.04316  -37.26   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.377 on 17 degrees of freedom
Multiple R-squared:  0.9904,    Adjusted R-squared:  0.9893 
F-statistic: 880.7 on 2 and 17 DF,  p-value: &lt; 2.2e-16</code></pre>
<hr />
<p>We evaluate the VIF in the prostate cancer example for the additive model and the model with interactie.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(lmVWS)</span></code></pre></div>
<pre><code>  lcavol  lweight      svi 
1.447048 1.039188 1.409189 </code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(lmVWS_IntVW)</span></code></pre></div>
<pre><code>        lcavol        lweight            svi lcavol:lweight 
     76.193815       1.767121       1.426646      80.611657 </code></pre>
<ul>
<li>Inflation in interaction terms often caused because main effect get another interpretation.</li>
</ul>
<hr />
</div>
</div>
<div id="influencial-observaties" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Influencial Observaties</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">112358</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>nobs <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>sdy <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length =</span> nobs)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(nobs, <span class="at">sd =</span> sdy)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">c</span>(x, <span class="fl">0.5</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">c</span>(y, <span class="dv">10</span> <span class="sc">+</span> <span class="dv">5</span> <span class="sc">*</span> <span class="fl">1.5</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">sd =</span> sdy))</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">c</span>(x, <span class="fl">1.5</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">c</span>(y, y1[<span class="dv">21</span>])</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">c</span>(x, <span class="fl">1.5</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">c</span>(y, <span class="dv">11</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">xlim =</span> <span class="fu">range</span>(<span class="fu">c</span>(x1, x2, x3)), <span class="at">ylim =</span> <span class="fu">range</span>(<span class="fu">c</span>(y1, y2, y3)))</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">c</span>(x1[<span class="dv">21</span>], x2[<span class="dv">21</span>], x3[<span class="dv">21</span>]), <span class="fu">c</span>(y1[<span class="dv">21</span>], y2[<span class="dv">21</span>], y3[<span class="dv">21</span>]), <span class="at">pch =</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>), <span class="at">col =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y1 <span class="sc">~</span> x1), <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y2 <span class="sc">~</span> x2), <span class="at">col =</span> <span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y3 <span class="sc">~</span> x3), <span class="at">col =</span> <span class="dv">4</span>, <span class="at">lty =</span> <span class="dv">4</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">legend =</span> <span class="fu">paste</span>(<span class="st">&quot;lm&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;&quot;</span>, <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>))), <span class="at">text.col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="08-MultipleRegression_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<hr />
<ul>
<li><p>It is not desirable that a single observation largely influences the result of a linear regression analysis</p></li>
<li><p>Diagnostics allow us to detect extreme observations.</p></li>
<li><p><em>Studentized residuals</em> to spot outliers</p></li>
<li><p><em>Leverage</em> to spot observations with extreem covariate pattern</p></li>
</ul>
<hr />
<div id="cooks-distance" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Cook’s distance</h3>
<ul>
<li><p>A statistics to assess the influence the effect of a single observation on the regression analysis</p></li>
<li><p>Cook’s distance for observation i is diagnostic measure for this particular observation on all all predictions or on <em>all</em> estimated parameters. <span class="math display">\[D_i=\frac{\sum_{j=1}^n(\hat{Y}_j-\hat{Y}_{j(i)})^2}{p\textrm{MSE}}\]</span></p></li>
<li><p>Observation <span class="math inline">\(i\)</span> has a large influence on the regression parameters and predictions if the Cook’s distance <span class="math inline">\(D_i\)</span> is large.</p></li>
<li><p>Extreme Cook’s distance if it is larger than the 50% quantile of an <span class="math inline">\(F_{p+1,n-(p+1)}\)</span>-distribution.</p></li>
</ul>
<hr />
<p><img src="08-MultipleRegression_files/figure-html/unnamed-chunk-24-1.png" width="100%" style="display: block; margin: auto;" /></p>
<hr />
<ul>
<li>Once we established that an observation is influential we can use <em>DFBETAS</em> to find the parameters for which the estimates are largely affected by the observation</li>
<li>DFBETAS of observatie i is a diagnostic measure for <em>each model parameter separately</em>. <span class="math display">\[\textrm{DFBETAS}_{j(i)}=\frac{\hat{\beta}_{j}-\hat{\beta}_{j(i)}}{\textrm{SD}(\hat{\beta}_{j})}\]</span></li>
<li>DFBETAS is extreme when it is larger than 1 in small to moderate datasets or exceeds <span class="math inline">\(2/\sqrt{n}\)</span> in large datasets.</li>
</ul>
<hr />
<p><img src="08-MultipleRegression_files/figure-html/unnamed-chunk-25-1.png" width="90%" style="display: block; margin: auto;" /></p>
<hr />
<p><img src="08-MultipleRegression_files/figure-html/unnamed-chunk-26-1.png" width="90%" style="display: block; margin: auto;" /></p>
<hr />
<p><img src="08-MultipleRegression_files/figure-html/unnamed-chunk-27-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="constrasts" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Constrasts</h1>
<ul>
<li>In more complex designs that are modelled using general linear models one often has to assess multiple hypotheses.</li>
<li>Moreover these hypotheses can typically not always be translated into a test on one parameter, but in a linear combination of model parameters.</li>
<li>A linear combination of model parameters is also referred to as a contrast.</li>
</ul>
<div id="nhanes-example" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> NHANES example</h2>
<ul>
<li><p>Suppose that researchers want to assess the association between age and bloodpressure.</p></li>
<li><p>Possibly this association will differ for females and males.</p></li>
<li><p>They want to assess following hypotheses:</p>
<ul>
<li>Is there an association between age and blood pressure for females?</li>
<li>Is there an association between age and blood pressure for males?</li>
<li>Is the association between age and blood pressure different for females and males?</li>
</ul></li>
</ul>
</div>
<div id="model" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Model</h2>
<p>We fit a model for the average systolic blood pressure (<code>BPSysAve</code>) using age, gender and the interaction between age and gender for adult caucasians from the NHANES study.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NHANES)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>bpData <span class="ot">&lt;-</span> NHANES <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    Race1 <span class="sc">==</span> <span class="st">&quot;White&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>      Age <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span><span class="fu">is.na</span>(BPSysAve)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>mBp1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(BPSysAve <span class="sc">~</span> Age <span class="sc">*</span> Gender, bpData)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mBp1)</span></code></pre></div>
<p><img src="08-MultipleRegression_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<ul>
<li><p>Assumptions are not fullfilled!</p>
<ul>
<li>lineariteit is ok</li>
<li>heteroscedasticity</li>
<li>No normality: distribution is skewed to the right .</li>
<li>Large dataset so we can adopt the CLT</li>
</ul></li>
</ul>
<div id="transformation" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Transformation</h3>
<p>We fit a model using log2 transformed average systolic blood pressure (<code>BPSysAve</code>).</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>mBp2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(BPSysAve <span class="sc">%&gt;%</span> <span class="fu">log2</span>() <span class="sc">~</span> Age <span class="sc">*</span> Gender, bpData)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mBp2)</span></code></pre></div>
<p><img src="08-MultipleRegression_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<ul>
<li>Residuals are still heteroscedastic.</li>
</ul>
</div>
<div id="remediate-for-heteroscedasticity" class="section level3" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Remediate for heteroscedasticity</h3>
<ul>
<li><p>If the residual plot shows a cone we can get to valid inference for large samples by modeling the variance explicitly in function of the fitted response.</p></li>
<li><p>The inverse variance for each observation can than be used as a weight in the lm function.</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>Model standard deviation in function of mean response.</li>
<li>Do this by modeling absolute values of residuals in function of fitted values of model.</li>
<li>We can than estimate the variance of Y for each observation by squaring the predictions for all observations using the model for the standard deviation.</li>
<li>Inference remains valid asymptotically.</li>
</ol>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>mSd <span class="ot">&lt;-</span> <span class="fu">lm</span>(mBp1<span class="sc">$</span>res <span class="sc">%&gt;%</span> <span class="fu">abs</span>() <span class="sc">~</span> mBp2<span class="sc">$</span>fitted)</span></code></pre></div>
<p>We estimate the model again:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>mBp3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(BPSysAve <span class="sc">~</span> Age <span class="sc">*</span> Gender, bpData, <span class="at">w =</span> <span class="dv">1</span> <span class="sc">/</span> mSd<span class="sc">$</span>fitted<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<p>Residuals are still heteroscedastic.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">residuals =</span> mBp3<span class="sc">$</span>residuals, <span class="at">fit =</span> mBp3<span class="sc">$</span>fitted) <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(fit, residuals)) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="08-MultipleRegression_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>But we accounted for that using weights! Note that if we rescale the residuals using the standard deviation (multiplying them with the square root of the weight) we obtain rescaled residuals that are homoscedastic.</p>
<p>The model parameters are estimated using weighted least squares:</p>
<p><span class="math display">\[ SSE = \sum\limits_{i=1}^n w_i e_i^2\]</span></p>
<p>with <span class="math inline">\(w_i = 1/\hat \sigma^2_i\)</span>.</p>
<p>Weighted regression will correct for heteroscedasticity.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">scaled_residuals =</span> mBp3<span class="sc">$</span>residuals <span class="sc">/</span> mSd<span class="sc">$</span>fitted, <span class="at">fit =</span> mBp3<span class="sc">$</span>fitted) <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(fit, scaled_residuals)) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="08-MultipleRegression_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
</div>
<div id="inference" class="section level3" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Inference</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mBp3)</span></code></pre></div>
<pre><code>
Call:
lm(formula = BPSysAve ~ Age * Gender, data = bpData, weights = 1/mSd$fitted^2)

Weighted Residuals:
    Min      1Q  Median      3Q     Max 
-4.3642 -0.8494 -0.0940  0.7605  6.5701 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    97.59709    0.63501 153.693  &lt; 2e-16 ***
Age             0.44082    0.01505  29.294  &lt; 2e-16 ***
Gendermale     13.36724    1.09017  12.262  &lt; 2e-16 ***
Age:Gendermale -0.19115    0.02420  -7.899 3.45e-15 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.319 on 4828 degrees of freedom
Multiple R-squared:  0.2182,    Adjusted R-squared:  0.2178 
F-statistic: 449.3 on 3 and 4828 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The research questions translate to following nullhypotheses:</p>
<ol style="list-style-type: decimal">
<li><p>Association between blood pressure and age for females? <span class="math display">\[H_0: \beta_\text{Age} = 0 \text{ vs } H_1: \beta_\text{Age} \neq 0 \]</span></p></li>
<li><p>Association between blood pressure and age for males? <span class="math display">\[H_0: \beta_\text{Age} + \beta_\text{Age:Gendermale} = 0 \text{ vs } H_1: \beta_\text{Age} + \beta_\text{Age:Gendermale} \neq 0 \]</span></p></li>
<li><p>Is the association between blood pressure and age different for females and males? <span class="math display">\[H_0: \beta_\text{Age:Gendermale} = 0 \text{ vs } H_1: \beta_\text{Age:Gendermale} \neq 0 \]</span></p></li>
</ol>
<ul>
<li>We can assess hypotheses 1 and 3 immediately using the output of the model.</li>
<li>Hypotheses 2 is a linear combination of two parameters.</li>
<li>We also need multiple tests for assessing the association between sysBp and Age.</li>
</ul>
<p>We can again use an Anova approach.</p>
<ol style="list-style-type: decimal">
<li>We first assess the omnibus hypothesis that there is no association between age and blood pressure. <span class="math display">\[ H_0: \beta_\text{Age} = \beta_\text{Age} + \beta_\text{Age:Gendermale} = \beta_\text{Age:Gendermale} = 0
\]</span></li>
</ol>
<ul>
<li>which simplifies to assessing</li>
</ul>
<p><span class="math display">\[ H_0: \beta_\text{Age} = \beta_\text{Age:Gendermale} = 0
\]</span></p>
<ul>
<li>We can do this by comparing two models: the full model with an effect for Gender, Age and Gender x Age interaction against a reduced model with only Gender.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>If we can reject this hypothesis we can again do a posthoc analysis for each of the contrasts.</li>
</ol>
<div id="omnibus-test" class="section level4" number="6.2.3.1">
<h4><span class="header-section-number">6.2.3.1</span> Omnibus test</h4>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>mBp0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(BPSysAve <span class="sc">~</span> Gender, bpData, <span class="at">w =</span> <span class="dv">1</span> <span class="sc">/</span> mSd<span class="sc">$</span>fitted<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mBp0, mBp3)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"4830","2":"10200.529","3":"NA","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"4828","2":"8404.529","3":"2","4":"1796","5":"515.858","6":"9.123215e-204","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="posthoc-tests" class="section level4" number="6.2.3.2">
<h4><span class="header-section-number">6.2.3.2</span> Posthoc tests</h4>
<p>For the posthoc tests we will again build upon the <code>multcomp</code> package.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>bpPosthoc <span class="ot">&lt;-</span> <span class="fu">glht</span>(mBp3, <span class="at">linfct =</span> <span class="fu">c</span>(</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Age = 0&quot;</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Age + Age:Gendermale = 0&quot;</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Age:Gendermale = 0&quot;</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>bpPosthoc <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Fit: lm(formula = BPSysAve ~ Age * Gender, data = bpData, weights = 1/mSd$fitted^2)

Linear Hypotheses:
                          Estimate Std. Error t value Pr(&gt;|t|)    
Age == 0                   0.44082    0.01505  29.294   &lt;1e-10 ***
Age + Age:Gendermale == 0  0.24967    0.01895  13.175   &lt;1e-10 ***
Age:Gendermale == 0       -0.19115    0.02420  -7.899   &lt;1e-10 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
(Adjusted p values reported -- single-step method)</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>bpPosthocCI <span class="ot">&lt;-</span> bpPosthoc <span class="sc">%&gt;%</span> <span class="fu">confint</span>()</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>bpPosthocCI</span></code></pre></div>
<pre><code>
     Simultaneous Confidence Intervals

Fit: lm(formula = BPSysAve ~ Age * Gender, data = bpData, weights = 1/mSd$fitted^2)

Quantile = 2.3154
95% family-wise confidence level
 

Linear Hypotheses:
                          Estimate lwr     upr    
Age == 0                   0.4408   0.4060  0.4757
Age + Age:Gendermale == 0  0.2497   0.2058  0.2936
Age:Gendermale == 0       -0.1911  -0.2472 -0.1351</code></pre>
<p>Note that the glht function allows us to define the contrasts by explicitely defining the nullhypothese using the names of the model parameters.</p>
</div>
<div id="conclusion" class="section level4" number="6.2.3.3">
<h4><span class="header-section-number">6.2.3.3</span> Conclusion</h4>
<p>We can conclude that the association between age and blood pressure is extremely significant (p &lt;&lt; 0.001).</p>
<p>The blood pressure for females that differ in age is on average 0.44 mm Hg higher per year of age difference for the eldest female and is extremely significant (p &lt;&lt; 0.001, 95% CI [0.41, 0.48].</p>
<p>The blood pressure for males that differ in age is on average 0.25 mm Hg higher per year of age difference for the eldest male and is extremely significant (p &lt;&lt; 0.001, 95% CI [0.21, 0.29].</p>
<p>The average blood pressure difference between subjects that differ in age is on average 0.19 mm Hg/jaar higher for females than for males (p &lt;&lt; 0.001, 95% CI [0.14, 0.25]).</p>
</div>
</div>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiOC4gTXVsdGlwbGUgcmVncmVzc2lvbiIKYXV0aG9yOiAiTGlldmVuIENsZW1lbnQiCmRhdGU6ICJzdGF0T21pY3MsIEdoZW50IFVuaXZlcnNpdHkgKGh0dHBzOi8vc3RhdG9taWNzLmdpdGh1Yi5pbykiCi0tLQoKCjxhIHJlbD0ibGljZW5zZSIgaHJlZj0iaHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMCI+PGltZyBhbHQ9IkNyZWF0aXZlIENvbW1vbnMgTGljZW5zZSIgc3R5bGU9ImJvcmRlci13aWR0aDowIiBzcmM9Imh0dHBzOi8vaS5jcmVhdGl2ZWNvbW1vbnMub3JnL2wvYnktbmMtc2EvNC4wLzg4eDMxLnBuZyIgLz48L2E+CgoKYGBge3Igc2V0dXAsIGluY2x1ZGU9RkFMU0V9CmtuaXRyOjpvcHRzX2NodW5rJHNldCgKICBpbmNsdWRlID0gVFJVRSwgY29tbWVudCA9IE5BLCBlY2hvID0gVFJVRSwKICBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRSwgY2FjaGUgPSBUUlVFCikKbGlicmFyeSh0aWR5dmVyc2UpCmBgYAoKCiMgSW50cm8KCi0gVW50aWwgbm93OiBvbmUgb3V0Y29tZSAkWSQgYW5kIGEgc2luZ2xlICBwcmVkaWN0b3IgJFgkLgotIE9mdGVuIHVzZWZ1bCB0byB1c2UgbXVsdGlwbGUgcHJlZGljdG9ycyB0byBtb2RlbCB0aGUgcmVzcG9uc2UuIGUuZwoKMS4gQXNzb2NpYXRpb24gYmV0d2VlbiBYIGFuZCBZIGlzIGFmZmVjdGVkIGJ5IGNvbmZvdW5kZXI6IFNtb2tpbmcgYW5kIGFnZSBieSB5b3VuZ3N0ZXJzIGFyZSBjb25mb3VuZGVkIGFuZCB0aGV5IGJvdGggYWZmZWN0IHRoZSBsdW5nIGNhcGFjaXR5CjIuIFdoaWNoIGdyb3VwIG9mIHZhcmlhYmxlcyBpcyBhc3NvY2lhdGVkIHdpdGggYSBnaXZlbiBvdXRjb21lLiBFLmcgSGFiaXRhdCBhbmQgaHVtYW4gYWN0aXZpdHkgb24gdGhlIGJpb2RpdmVyc2l0eSBvZiB0aGUgcmFpbiBmb3Jlc3QuIChTaXplLCBhZ2UsIGhlaWdodCBvZiB0aGUgd29vZCAkXHJpZ2h0YXJyb3ckIGFzc2VzcyBhbGwgZWZmZWN0cyBzaW11bHRhbmVvdXNseS4KMy4gUHJlZGljdGlvbiBvZiBvdXRjb21lIGZvciBpbmRpdmlkdWFsczogdXNlIGFzIG1hbnkgcHJlZGljdGl2ZSBpbmZvcm1hdGlvbiBzaW11bHRhbmVvdXNseS4gRS5nIHByZWRpY3Rpb24gb2YgcmlzayBvbiBtb3J0YWxpdHkgaXMgdXNlZCBvbiBhIGRhaWx5IGJhc2lzIGluIGludGVuc2l2ZSBjYXJlIHVuaXRzIHRvIHByaW9yaXRpc2UgcGF0aWVudCBjYXJlLgoKJFxyaWdodGFycm93JCBFeHRlbmQgc2ltcGxlIGxpbmVhciByZWdyZXNzaW9uIHRvIG11bHRpcGxlIHByZWRpY3RvcnMuCgotLS0KCiMjIFByb3N0YXRlIGNhbmNlciBleGFtcGxlCgotIFByb3N0YXRlIHNwZWNpZmljIGFudGlnZW4gKFBTQSkgYW5kIGEgbnVtYmVyIG9mIGNsaW5pY2FsIHZhcmlhYmxlcyBmb3IgOTcgbWFsZXMgd2l0aCByYWRpY2FsIHByb3N0YXRlY3RvbXkuCi0gQXNzb2NpYXRpb24gb2YgUFNBIGJ5CgogICAgLSB0dW1vciB2b2x1bWUgKGxjYXZvbCkKICAgIC0gcHJvc3RhdGUgd2VpZ2h0IChsd2VpZ2h0KQogICAgLSBhZ2UKICAgIC0gYmVuaWduIHByb3N0YXRlIGh5cGVydHJvcGh5ICAobGJwaCkKICAgIC0gc2VtaW5hbCB2ZXNpY2xlIGludmFzaW9uIChzdmkpCiAgICAtIGNhcHN1bGFyIHBlbmV0cmF0aW9uIChsY3ApCiAgICAtIEdsZWFzb24gc2NvcmUgKGdsZWFzb24pCiAgICAtIHByZWNlbnRhZ2UgZ2xlYXNvbiBzY29yZSA0LzUgKHBnZzQ1KQoKLS0tCgpgYGB7cn0KcHJvc3RhdGUgPC0gcmVhZF9jc3YoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9HVFBCL1BTTFMyMC9tYXN0ZXIvZGF0YS9wcm9zdGF0ZS5jc3YiKQpwcm9zdGF0ZQpwcm9zdGF0ZSRzdmkgPC0gYXMuZmFjdG9yKHByb3N0YXRlJHN2aSkKYGBgCgotLS0KCmBgYHtyICwgb3V0LndpZHRoPScxMDAlJywgZmlnLmFzcD0uOCwgZmlnLmFsaWduPSdjZW50ZXInLGVjaG89RkFMU0V9CmxpYnJhcnkoR0dhbGx5KQpwcm9zdGF0ZSAlPiUKICBzZWxlY3QoLXBnZzQ1KSAlPiUKICBnZ3BhaXJzKCkKYGBgCgotLS0KCiMgQWRkaXRpdmUgIG11bHRpcGxlIGxpbmFpciBtb2RlbAoKU2VwYXJhdGUgc2ltcGxlIGxpbmFpciBtb2RlbHMsIGxpa2UKCiQkRShZfFhfdik9XGFscGhhK1xiZXRhX3YgWF92JCQKCi0gQXNzb2NpYXRpb24gYmV0d2VlbiBscHNhIGVuIDEgdmFyaWFiZWxlIGUuZyBsY2F2b2wuCi0gTW9yZSBhY2N1cmF0ZSBwcmVkaWN0aW9ucyBieSBzaW11bHRhbmVvdXNseSBhY2NvdW50aW5nIGZvciBtdWx0aXBsZSBwcmVkaWN0b3JzCi0gRXN0aW1hdGUgZm9yIHBhcmFtZXRlciAkXGJldGFfdiQgZG9lcyBub3Qgb25seSBjYXB0dXJlIHRoZSBlZmZlY3Qgb2YgdHVtb3Igdm9sdW1lLgotICRcYmV0YV92JCBhdmVyYWdlIGRpZmZlcmVuY2UgZm9yIGxvZy1wc2EgZm9yIHBhdGllbnRzIHRoYXQgZGlmZmVyIGluIDEgdW5pdCBvZiB0aGUgbG9nIHR1bW9yIHZvbHVtZS4KLSBFdmVuIGlmIGxjYXZvbCBpcyBub3QgYXNzb2NpYXRlZCB3aXRoIGxwc2EgdGhlbiBwYXRpZW50cyB3aXRoIGEgaGlnaGVyIHR1bW9yIHZvbHVtZSBjYW4gaGF2ZSBhIGhpZ2hlciBscHNhIGJlY2F1c2UgdGhlaXIgc2VtZW4gdmVzaWNsZXMgYXJlIGFmZmVjdGVkIChzdmkgc3RhdHVzIDEpLgokXHJpZ2h0YXJyb3ckIGNvbmZvdW5kaW5nLgotIENvbXBhcmUgcGF0aWVudHMgd2l0aCBzYW1lIHN2aSBzdGF0dXMKLSBJcyBwb3NpYmxlIGluIG11bHRpcGxlIGxpbmVhciBtb2RlbAoKLS0tCgojIyBTdGF0aXN0aWNhbCBtb2RlbAoKLSAkcC0xJCBwcmVkaWN0b3JzICRYXzEsLi4uLFhfe3AtMX0kIGFuZCBvdXRjb21lICRZJCBmb3IgJG4kIHN1YmplY3Rlbi4KClxiZWdpbntlcXVhdGlvbn0KWV9pID1cYmV0YV8wICsgXGJldGFfMSBYX3tpMX0gKyAuLi4gK1xiZXRhX3twLTF9IFhfe2lwLTF9ICsgXGVwc2lsb25faQpcZW5ke2VxdWF0aW9ufQoKLSAkXGJldGFfMCxcYmV0YV8xLC4uLixcYmV0YV97cC0xfSQgdW5rbm93biBwYXJhbWV0ZXJzCi0gJFxlcHNpbG9uX2kkIHJlc2lkdWFscyB0aGF0IGNhbm5vdCBiZSBleHBsYWluZWQgYnkgcHJlZGljdG9ycwotIEVzdGltYXRpb24gYnkgKmxlYXN0IHNxdWFyZXMgbWV0aG9kKgoKLS0tCgpNb2RlbCBhbGxvd3MgdG8KCjEuIHByZWRpY3QgdGhlIGV4cGVjdGVkIG91dGNvbWUgZm9yIHN1YmplY3RzIGdpdmVuIHRoZWlyIHZhbHVlcyAkeF8xLC4uLix4X3twLTF9JCBmb3IgdGhlIHByZWRpY3RvciB2YXJpYWJsZXMuCiRFW1lcdmVydCBYXzE9eF8xLCBcbGRvdHMgWF97cC0xfT14X3twLTF9XT1caGF0e1xiZXRhfV8wK1xoYXR7XGJldGF9XzF4XzErLi4uK1xoYXR7XGJldGF9X3twLTF9eF97cC0xfSQuCjIuIERvZXMgdGhlIGF2ZXJhZ2Ugb3V0Y29tZSBkaWZmZXIgYmV0d2VlbiB0d28gZ3JvdXBzIG9mIHBhdGllbnRzIHRoYXQgZGlmZmVyIGJ5ICRcZGVsdGEkIHVuaXRzIGluIHByZWRpY3RvciAkWF9qJCBidXQgaGF2ZSB0aGUgc2FtZSB2YWx1ZSBmb3IgdGhlIHJlbWFpbmluZyB2YXJpYWJsZXMgJFx7WF9rLGs9MSwuLi4scCxrXG5lIGpcfSQuCiQkClxiZWdpbnthcnJheX17bH0KRShZfFhfMT14XzEsLi4uLFhfaj14X2orXGRlbHRhLC4uLixYX3twLTF9PXhfe3AtMX0pIFxcClxxdWFkXHF1YWQgLSBFKFl8WF8xPXhfMSwuLi4sWF9qPXhfaiwuLi4sWF97cC0xfT14X3twLTF9KSBcXFxcClxxdWFkID1cYmV0YV8wICsgXGJldGFfMSB4XzEgKyAuLi4gKyBcYmV0YV9qKHhfaitcZGVsdGEpKy4uLitcYmV0YV97cC0xfSB4X3twLTF9XFwKXHF1YWRccXVhZC0gXGJldGFfMCAtIFxiZXRhXzEgeF8xIC0gLi4uIC0gXGJldGFfanhfai0uLi4tXGJldGFfe3AtMX0geF97cC0xfSBcXFxcClxxdWFkPSBcYmV0YV9qXGRlbHRhClxlbmR7YXJyYXl9CiQkCgpJbnRlcnByZXRhdGlvbiAkXGJldGFfaiQ6CgotIGRpZmZlcmVuY2UgaW4gbWVhbiBvdXRjb21lIGJldHdlZW4gc3ViamVjdHMgdGhhdCBkaWZmZXIgaW4gb25lIHVuaXQgb2YgJFhfaiQsIGJ1dCBoYXZlIHRoZSBzYW1lIHZhbHVlIGZvciB0aGUgcmVtYWluaW5nIHByZWRpY3RvcnMgaW4gdGhlIG1vZGVsLgoKb3IKCi0gRWZmZWN0IG9mIHByZWRpY3RvciBqIGNvcnJlY3RlZCBmb3IgdGhlIHJlbWFpbmluZyBwcmVkaWN0b3JzLiAgZS5nLiBlZmZlY3Qgb2YgY2FuY2VyIHZvbHVtZSBjb3JyZWN0IGZvciBwcm9zdGF0ZSB3ZWlnaHQgYW5kIHRoZSBzdmkgc3RhdHVzLgoKLS0tCgojIyMgUHJvc3RhdGUgZXhhbXBsZQoKYGBge3J9CmxtViA8LSBsbShscHNhIH4gbGNhdm9sLCBwcm9zdGF0ZSkKc3VtbWFyeShsbVYpCmBgYAoKLS0tCgpgYGB7cn0KbG1WV1MgPC0gbG0obHBzYSB+IGxjYXZvbCArIGx3ZWlnaHQgKyBzdmksIHByb3N0YXRlKQpzdW1tYXJ5KGxtVldTKQpgYGAKCi0tLQoKYGBge3Igb3V0LndpZHRoPSc4MCUnLCBmaWcuYXNwPS44LCBmaWcuYWxpZ249J2NlbnRlcicsIG1lc3NhZ2U9RkFMU0UsZWNobz1GQUxTRX0KbGlicmFyeShwbG90M0QpCmdyaWQubGluZXMgPC0gMTAKeCA8LSBwcm9zdGF0ZSRsY2F2b2wKeSA8LSBwcm9zdGF0ZSRsd2VpZ2h0CnogPC0gcHJvc3RhdGUkbHBzYQpmaXQgPC0gbG0oeiB+IHggKyB5ICsgc3ZpLCBkYXRhID0gcHJvc3RhdGUpCngucHJlZCA8LSBzZXEobWluKHgpLCBtYXgoeCksIGxlbmd0aC5vdXQgPSBncmlkLmxpbmVzKQp5LnByZWQgPC0gc2VxKG1pbih5KSwgbWF4KHkpLCBsZW5ndGgub3V0ID0gZ3JpZC5saW5lcykKCiMgZml0dGVkIHBvaW50cyBmb3IgZHJvcGxpbmVzIHRvIHN1cmZhY2UKdGggPC0gMjAKcGggPC0gNQpzY2F0dGVyM0QoeCwgeSwgeiwKICBwY2ggPSAxNiwgY29sID0gYygiZGFya2JsdWUiLCAicmVkIilbYXMuZG91YmxlKHByb3N0YXRlJHN2aSldLCBjZXggPSAuNzUsCiAgdGhldGEgPSB0aCwgcGhpID0gcGgsIHRpY2t0eXBlID0gImRldGFpbGVkIiwKICB4bGFiID0gImxjYXZvbCIsIHlsYWIgPSAibHdlaWdodCIsIHpsYWIgPSAibHBzYSIsCiAgY29sdmFyID0gRkFMU0UsIGJ0eSA9ICJnIgopCgpmb3IgKGkgaW4gMTpucm93KHByb3N0YXRlKSkgewogIGxpbmVzM0QoeCA9IHJlcChwcm9zdGF0ZSRsY2F2b2xbaV0sIDIpLCB5ID0gcmVwKHByb3N0YXRlJGx3ZWlnaHRbaV0sIDIpLCB6ID0gYyhwcm9zdGF0ZSRscHNhW2ldLCBsbVZXUyRmaXRbaV0pLCBjb2wgPSBjKCJkYXJrYmx1ZSIsICJyZWQiKVthcy5kb3VibGUocHJvc3RhdGUkc3ZpKVtpXV0sIGFkZCA9IFRSVUUsIGx0eSA9IDIpCn0KCnoucHJlZDNEIDwtIG91dGVyKHgucHJlZCwgeS5wcmVkLCBmdW5jdGlvbih4LCB5KSB7CiAgbG1WV1MkY29lZlsxXSArIGxtVldTJGNvZWZbMl0gKiB4ICsgbG1WV1MkY29lZlszXSAqIHkKfSkKeC5wcmVkM0QgPC0gb3V0ZXIoeC5wcmVkLCB5LnByZWQsIGZ1bmN0aW9uKHgsIHkpIHgpCnkucHJlZDNEIDwtIG91dGVyKHgucHJlZCwgeS5wcmVkLCBmdW5jdGlvbih4LCB5KSB5KQpzdXJmM0QoeC5wcmVkM0QsIHkucHJlZDNELCB6LnByZWQzRCwgY29sID0gImJsdWUiLCBmYWNldHMgPSBOQSwgYWRkID0gVFJVRSkKejIucHJlZDNEIDwtIG91dGVyKHgucHJlZCwgeS5wcmVkLCBmdW5jdGlvbih4LCB5KSB7CiAgbG1WV1MkY29lZlsxXSArIGxtVldTJGNvZWZbNF0gKyBsbVZXUyRjb2VmWzJdICogeCArIGxtVldTJGNvZWZbM10gKiB5Cn0pCnN1cmYzRCh4LnByZWQzRCwgeS5wcmVkM0QsIHoyLnByZWQzRCwgY29sID0gInJlZCIsIGZhY2V0cyA9IE5BLCBhZGQgPSBUUlVFKQpgYGAKCi0tLQoKIyBJbmZlcmVuY2UgaW4gbXVsdGlwbGUgbGluZWFyIG1vZGVscwoKSWYgZGF0YSBhcmUgcmVwcmVzZW50YXRpdmUgdGhhbiB0aGUgbGVhc3Qgc3F1YXJlcyBlc3RpbWF0b3JzIGZvciB0aGUgaW50ZXJjZXB0IGFuZCBzbG9wZXMgYXJlIHVuYmlhc2VkLgokJEVbXGhhdCBcYmV0YV9qXT1cYmV0YV9qLFxxdWFkIGo9MCxcbGRvdHMscC0xLiQkCgotIEdhaW4gaW5zaWdodCBpbiB0aGUgZGlzdHJpYnV0aW9uIG9mIHRoZSBwYXJhbWV0ZXIgZXN0aW1hdG9ycyBzbyBhcyB0byBnZW5lcmFsaXplIHRoZSBlZmZlY3QgaW4gdGhlIHNhbXBsZSB0byB0aGUgcG9wdWxhdGlvbi4KCi0gQWRkaXRpb25hbCBhc3N1bXB0aW9ucyBhcmUgbmVlZGVkIGZvciBpbmZlcmVuY2UuCgoxLiAqTGluZWFyaXR5KgoKMi4gKkluZGVwZW5kZW5jZSoKCjMuICpIb21vc2NlZGFzdGljaXR5KiBvZiAqZXF1YWwgdmFyaWFuY2UqCjQuICpOb3JtYWxpdHkqOiByZXNpZHVhbHMgJFxlcHNpbG9uX2kkIGFyZSBub3JtYWxseSBkaXN0cmlidXRlZC4KClVuZGVyIHRoZXNlIGFzc3VtcHRpb25zOgokJFxlcHNpbG9uX2kgXHNpbSBOKDAsXHNpZ21hXjIpLiQkCmVuCiQkWV9pXHNpbSBOKFxiZXRhXzArXGJldGFfMSBYX3tpMX0rXGxkb3RzK1xiZXRhX3twLTF9IFhfe2lwLTF9LFxzaWdtYV4yKSQkCgotLS0KCi0gU2xvcGVzIGFyZSBhZ2FpbiBtb3JlIHByZWNpc2UgaWYgdGhlIHByZWRpY3RvciB2YWx1ZXMgaGF2ZSBhIGxhcmdlciByYW5nZS4KCi0gQ29uZGl0aW9uYWwgdmFyaWFuY2UgKCRcc2lnbWFeMiQpIGNhbiBhZ2FpbiBiZSBlc3RpbWF0ZWQgYmFzZWQgb24gdGhlICptZWFuIHNxdWFyZWQgZXJyb3IqIChNU0UpOgoKJCRcaGF0XHNpZ21hXjI9TVNFPVxmcmFje1xzdW1cbGltaXRzX3tpPTF9Xm4gXGxlZnQoeV9pLVxoYXRcYmV0YV8wLVxoYXRcYmV0YV8xIFhfe2kxfS1cbGRvdHMtXGhhdFxiZXRhX3twLTF9IFhfe2lwLTF9XHJpZ2h0KV4yfXtuLXB9PVxmcmFje1xzdW1cbGltaXRzX3tpPTF9Xm4gZV4yX2l9e24tcH0uJCQKCkFnYWluIGh5cG90aGVzaXMgdGVzdHMgYW5kIGNvbmZpZGVuY2UgaW50ZXJ2YWxzIGJ5CiQkVF9rPVxmcmFje1xoYXR7XGJldGF9X2stXGJldGFfa317U0UoXGhhdHtcYmV0YX1fayl9IFx0ZXh0eyBtZXQgfSBrPTAsIFxsZG90cywgcC0xLiQkCgpJZiBhbGwgYXNzdW1wdGlvbnMgYXJlIHNhdGlzZmllZCB0aGFuIHRoZSBzdGF0aXN0aWNzICRUX2skIHQtZGlzdHJpYnV0ZWQgd2l0aCAkbi1wJCBkZWdyZWVzIG9mIGZyZWVkb20uCgotLS0KCldoZW4gbm9ybWFsaXR5IHRodXMgbm90IGhvbGQsIGJ1dCBsaW5lYXJpdGVpdCwgaW5kZXBlbmRlbmNlIGFuZCBob21vc2NlZGFzdGljaXR5IGFyZSB2YWxpZCB3ZSBjYW4gYWdhaW4gYWRvcHQgdGhlIENMVCB0aGF0IHN0YXRlcyB0aGF0IHN0YXRpc3RpYyAkVF9rJCBpcyBhcHByb3hpbWF0ZWx5IG5vcm1hbGx5IGRpc3RyaWJ1dGVkIGluIGxhcmdlIHNhbXBsZXMuCgotLS0KCldlIGNhbiBidWlsZCBjb25maWRlbmNlIGludGVydmFscyBvbiB0aGUgc2xvcGVzIGJ5OgokJFtcaGF0XGJldGFfaiAtIHRfe24tcCxcYWxwaGEvMn0gXHRleHR7U0V9X3tcaGF0XGJldGFfan0sXGhhdFxiZXRhX2ogKyB0X3tuLXAsXGFscGhhLzJ9IFx0ZXh0e1NFfV97XGhhdFxiZXRhX2p9XSQkLgoKYGBge3J9CmNvbmZpbnQobG1WV1MpCmBgYAoKLS0tCgpGb3JtYWwgaHlwb3RoZXNpcyB0ZXN0czoKJCRIXzA6IFxiZXRhX2o9MCQkCiQkSF8xOiBcYmV0YV9qXG5lcTAkJAoKV2l0aCB0ZXN0IHN0YXRpc3RpYwokJFQ9XGZyYWN7XGhhdHtcYmV0YX1fai0wfXtTRShcaGF0e1xiZXRhfV9qKX0kJAp3aGljaCBmb2xsb3dzIGEgdC1kaXN0cmlidXRpb24gd2l0aCAkbi1wJCBkZWdyZWVzIG9mIGZyZWVkb20gdW5kZXIgJEhfMCQKCi0tLQoKYGBge3J9CnN1bW1hcnkobG1WV1MpCmBgYAoKLS0tCgojIyBBc3Nlc3MgdGhlIG1vZGVsIGFzc3VtcHRpb25zCgpgYGB7cn0KcGxvdChsbVZXUykKYGBgCgotLS0KCiMjIFRoZSBub24gYWRkaXRpdmUgbXVsdGlwbGUgbGluZWFyIG1vZGVsCiMjIyBJbnRlcmFjdGlvbiBiZXR3ZWVuIHR3byBjb250aW51b3VzIHZhcmlhYmxlcwoKVGhlIHByZXZpb3VzIG1vZGVsIGlzIGFkZGl0aXZlIGJlY2F1c2UgdGhlIGNvbnRyaWJ1dGlvbiBvZiB0aGUgY2FuY2VyIHZvbHVtZSBvbiBscHNhIGRvZXMgbm90IGRlcGVuZCBvbiB0aGUgaGVpZ2h0IG9mIHRoZSBwcm9zdGF0ZSB3ZWlnaHQgYW5kIHRoZSBzdmkgc3RhdHVzLgoKVGhlIHNsb3BlIGZvciBsY2F2b2wgZG9lcyBub3QgZGVwZW5kIG9uIGxvZyBwcm9zdGF0ZSB3ZWlnaHQgYW5kIHN2aS4KCiQkClxiZXRhXzAgKyBcYmV0YV92ICh4X3t2fStcZGVsdGFfdikgKyBcYmV0YV93IHhfe3d9ICtcYmV0YV9zIHhfe3N9IC0gXGJldGFfMCAtIFxiZXRhX3YgeF97dn0gLSBcYmV0YV93IHhfe3d9IC1cYmV0YV9zIHhfcyA9IFxiZXRhX3YgXGRlbHRhX3YKJCQKClRoZSBzdmkgc3RhdHVzIGFuZCB0aGUgbG9nLXByb3N0YXRlZ2V3aWNodCAoJHhfdyQpIGRvIG5vdCBpbmZsdWVuY2UgdGhlIGNvbnRyaWJ1dGlvbiBvZiB0aGUgbG9nLXR1bW9yIHZvbHVtZSAoJHhfdiQpIHRvIHRoZSBhdmVyYWdlIGxvZy1QU0EgYW5kIHZpY2UgdmVyc2EuCgotLS0KCi0gSXQgaXMgaG93ZXZlciBwb3NzaWJsZSB0aGF0IHRoZSBhc3NvY2lhdGlvbiBvZiBscHNhIGFuZCBsY2F2b2wgZGVwZW5kcyBvbiB0aGUgcHJvc3RhdGUgd2VpZ2h0LgotIFRoZSBhdmVyYWdlIGRpZmZlcmVuY2UgaW4gbHBzYSBmb3IgcGF0aWVudHMgdGhhdCBkaWZmZXIgaW4gb25lIHVuaXQgb2YgdGhlIGxvZy10dW1vciB2b2x1bWUgY2FuIGZvciBpbnN0YW5jZSBjYW4gYmUgaGlnaGVyIGZvciBwYXRpZW50cyB3aWh0IGEgaGlnaCB0dW1vciB3ZWlnaHQgdGhlbiBmb3IgdGhvc2Ugd2l0aCBhIGxvdyB0dW1vciB3ZWlnaHQuCi0gVGhlIGVmZmVjdCBvZiB0aGUgdHVtb3Igdm9sdW1lIG9uIHRoZSBQU0EgZGVwZW5kcyBvbiB0aGUgcHJvc3RhdGUgd2VpZ2h0LgoKVG8gbW9kZWwgdGhpcyAqKmludGVyYWN0aWUqKiBvciAqKmVmZmVjdCBtb2RpZmljYXRpb24qKiB3ZSBjYW4gYWRkIGEgcHJvZHVjdCB0ZXJtIG9mIGJvdGggdmFyaWFibGVzIHRvIHRoZSBtb2RlbAoKJCQKWV9pID0gXGJldGFfMCArIFxiZXRhX3YgeF97aXZ9ICsgXGJldGFfdyB4X3tpd30gK1xiZXRhX3MgeF97aXN9ICsgXGJldGFfe3Z3fSB4X3tpdn14X3tpd30gK1xlcHNpbG9uX2kKJCQKClRoaXMgdGVybSBxdWFudGlmaWVzIHRoZSAqaW50ZXJhY3RpZS1lZmZlY3QqIG9mIHByZWRpY3RvcnMgJHhfdiQgZW4gJHhfdyQgb24gdGhlIG1lYW4gb3V0Y29tZS4KClRlcm1zICRcYmV0YV92eF97aXZ9JCBhbmQgJFxiZXRhX3d4X3tpd30kIGFyZSByZWZlcnJlZCB0byBhcyAqbWFpbiBlZmZlY3RzKiBvZiBwcmVkaWN0b3JzICR4X3YkIGFuZCAkeF93JC4KCi0tLQoKVGhlIGRpZmZlcmVuY2UgaW4gbHBzYSBmb3IgcGF0aWVudHMgdGhhdCBkaWZmZXIgMSB1bml0IGluICRYX3YkIGFuZCBoYXZlIGFuIGVxdWFsIGxvZyBwcm9zdGF0ZSB3ZWlnaHQgYW5kIHRoZSBzYW1lIHN2aSBzdGF0dXMgbm93IGJlY29tZXM6CgokJApcYmVnaW57YXJyYXl9e2x9CkUoWSB8IFhfdj14X3YgKzEsIFhfdz14X3csIFhfcz14X3MpIC0gRShZIHwgWF92PXhfdiwgWF93PXhfdywgWF9zPXhfcykgXFwKXHF1YWQgPSBcYmV0YV8wICsgXGJldGFfdiAoeF97dn0rMSkgKyBcYmV0YV93IHhfdyArXGJldGFfcyB4X3tzfSArIFxiZXRhX3t2d30gKHhfe3Z9KzEpIHhfdyAtIFxiZXRhXzAgLSBcYmV0YV92IHhfe3Z9IC0gXGJldGFfdyB4X3cgLVxiZXRhX3MgeF97c30gLSBcYmV0YV97dnd9ICh4X3t2fSkgeF93IFxcClxxdWFkID0gXGJldGFfdiArICBcYmV0YV97dnd9IHhfdwogXGVuZHthcnJheX0KICQkCgotLS0KCmBgYHtyfQpsbVZXU19JbnRWVyA8LSBsbShscHNhIH4gbGNhdm9sICsgbHdlaWdodCArIHN2aSArIGxjYXZvbDpsd2VpZ2h0LCBwcm9zdGF0ZSkKc3VtbWFyeShsbVZXU19JbnRWVykKYGBgCgotLS0KCgpgYGB7ciBvdXQud2lkdGg9JzEwMCUnLCBmaWcuYXNwPS44LCBmaWcuYWxpZ249J2NlbnRlcicsIG1lc3NhZ2U9RkFMU0UsZWNobz1GQUxTRX0KcGFyKG1mcm93ID0gYygxLCAyKSkKbGlicmFyeShwbG90M0QpCmdyaWQubGluZXMgPC0gMTAKeCA8LSBwcm9zdGF0ZSRsY2F2b2wKeSA8LSBwcm9zdGF0ZSRsd2VpZ2h0CnogPC0gcHJvc3RhdGUkbHBzYQpmaXQgPC0gbG0oeiB+IHggKyB5ICsgc3ZpLCBkYXRhID0gcHJvc3RhdGUpCngucHJlZCA8LSBzZXEobWluKHgpLCBtYXgoeCksIGxlbmd0aC5vdXQgPSBncmlkLmxpbmVzKQp5LnByZWQgPC0gc2VxKG1pbih5KSwgbWF4KHkpLCBsZW5ndGgub3V0ID0gZ3JpZC5saW5lcykKCiMgZml0dGVkIHBvaW50cyBmb3IgZHJvcGxpbmVzIHRvIHN1cmZhY2UKdGggPC0gLTI1CnBoIDwtIDUKc2NhdHRlcjNEKHgsIHksIHosCiAgcGNoID0gMTYsIGNvbCA9IGMoImRhcmtibHVlIiwgInJlZCIpW2FzLmRvdWJsZShwcm9zdGF0ZSRzdmkpXSwgY2V4ID0gLjc1LAogIHRoZXRhID0gdGgsIHBoaSA9IHBoLCB0aWNrdHlwZSA9ICJkZXRhaWxlZCIsCiAgeGxhYiA9ICJsY2F2b2wiLCB5bGFiID0gImx3ZWlnaHQiLCB6bGFiID0gImxwc2EiLAogIGNvbHZhciA9IEZBTFNFLCBidHkgPSAiZyIsIG1haW4gPSAiQWRkaXRpdmUgbW9kZWwiCikKCmZvciAoaSBpbiB3aGljaChwcm9zdGF0ZSRzdmkgPT0gImhlYWx0aHkiKSkgewogIGxpbmVzM0QoeCA9IHJlcChwcm9zdGF0ZSRsY2F2b2xbaV0sIDIpLCB5ID0gcmVwKHByb3N0YXRlJGx3ZWlnaHRbaV0sIDIpLCB6ID0gYyhwcm9zdGF0ZSRscHNhW2ldLCBsbVZXUyRmaXRbaV0pLCBjb2wgPSBjKCJkYXJrYmx1ZSIsICJyZWQiKVthcy5kb3VibGUocHJvc3RhdGUkc3ZpKVtpXV0sIGFkZCA9IFRSVUUsIGx0eSA9IDIpCn0KCnoucHJlZDNEIDwtIG91dGVyKHgucHJlZCwgeS5wcmVkLCBmdW5jdGlvbih4LCB5KSB7CiAgbG1WV1MkY29lZlsxXSArIGxtVldTJGNvZWZbMl0gKiB4ICsgbG1WV1MkY29lZlszXSAqIHkKfSkKeC5wcmVkM0QgPC0gb3V0ZXIoeC5wcmVkLCB5LnByZWQsIGZ1bmN0aW9uKHgsIHkpIHgpCnkucHJlZDNEIDwtIG91dGVyKHgucHJlZCwgeS5wcmVkLCBmdW5jdGlvbih4LCB5KSB5KQpzdXJmM0QoeC5wcmVkM0QsIHkucHJlZDNELCB6LnByZWQzRCwgY29sID0gImJsdWUiLCBmYWNldHMgPSBOQSwgYWRkID0gVFJVRSkKCgpzY2F0dGVyM0QoeCwgeSwgeiwKICBwY2ggPSAxNiwgY29sID0gYygiZGFya2JsdWUiLCAicmVkIilbYXMuZG91YmxlKHByb3N0YXRlJHN2aSldLCBjZXggPSAuNzUsCiAgdGhldGEgPSB0aCwgcGhpID0gcGgsIHRpY2t0eXBlID0gImRldGFpbGVkIiwKICB4bGFiID0gImxjYXZvbCIsIHlsYWIgPSAibHdlaWdodCIsIHpsYWIgPSAibHBzYSIsCiAgY29sdmFyID0gRkFMU0UsIGJ0eSA9ICJnIiwgbWFpbiA9ICJNb2RlbCBtZXQgbGNhdm9sOmx3ZWlnaHQgaW50ZXJhY3RpZSIKKQoKZm9yIChpIGluIHdoaWNoKHByb3N0YXRlJHN2aSA9PSAiaGVhbHRoeSIpKSB7CiAgbGluZXMzRCh4ID0gcmVwKHByb3N0YXRlJGxjYXZvbFtpXSwgMiksIHkgPSByZXAocHJvc3RhdGUkbHdlaWdodFtpXSwgMiksIHogPSBjKHByb3N0YXRlJGxwc2FbaV0sIGxtVldTX0ludFZXJGZpdFtpXSksIGNvbCA9IGMoImRhcmtibHVlIiwgInJlZCIpW2FzLmRvdWJsZShwcm9zdGF0ZSRzdmkpW2ldXSwgYWRkID0gVFJVRSwgbHR5ID0gMikKfQoKei5wcmVkM0QgPC0gb3V0ZXIoeC5wcmVkLCB5LnByZWQsIGZ1bmN0aW9uKHgsIHkpIHsKICBsbVZXU19JbnRWVyRjb2VmWzFdICsgbG1WV1NfSW50VlckY29lZlsyXSAqIHggKyBsbVZXU19JbnRWVyRjb2VmWzNdICogeSArIGxtVldTX0ludFZXJGNvZWZbNV0gKiB4ICogeQp9KQp4LnByZWQzRCA8LSBvdXRlcih4LnByZWQsIHkucHJlZCwgZnVuY3Rpb24oeCwgeSkgeCkKeS5wcmVkM0QgPC0gb3V0ZXIoeC5wcmVkLCB5LnByZWQsIGZ1bmN0aW9uKHgsIHkpIHkpCnN1cmYzRCh4LnByZWQzRCwgeS5wcmVkM0QsIHoucHJlZDNELCBjb2wgPSAiYmx1ZSIsIGZhY2V0cyA9IE5BLCBhZGQgPSBUUlVFKQpgYGAKCi0tLQoKLSBOb3RlIHRoYXQgdGhlIGludGVyYWN0aW9uIGVmZmVjdCB0aGF0IGlzIG9ic2VydmVkIGlzIG5vdCBzdGF0aXN0aWNhbGx5IHNpZ25pZmljYW50IChwPWByIHJvdW5kKHN1bW1hcnkobG1WV1NfSW50VlcpJGNvZWZbNSw0XSwyKWApLgotIFRoZSBtYWluIGVmZmVjdHMgdGhhdCBhcmUgaW52b2x2ZWQgaW4gdGhlIGludGVyYWN0aW9uIGNhbm5vdCBiZSBpbnRlcnByZXRlZCBzZXBhcmF0ZWx5IGZyb20gb25lIGFub3RoZXIuCi0gV2Ugd2lsbCB0aGVyZWZvcmUgcmVtb3ZlIG5vbi1zaWduaWZpY2FudCBpbnRlcmFjdGlvbiB0ZXJtcyBmcm9tIHRoZSBtb2RlbC4KLSBVcG9uIHJlbW92YWwgb2Ygbm9uLXNpZ25pZmljYW50IGludGVyYWN0aW9uIHRlcm1zIHRoZSBtYWluIGVmZmVjdHMgY2FuIGJlIGludGVycHJldGVkLgoKLS0tCgojIyBJbnRlcmFjdGlvbiBiZXR3ZWVuIGEgY29udGludW91cyB2YXJpYWJsZSBhbmQgYSBmYWN0b3IgdmFyaWFibGUKCkludGVyYWN0aW9uIGJldHdlZW4gbGNhdm9sICRcbGVmdHJpZ2h0YXJyb3ckIHN2aSBhbmQgbHdlaWdodCAkXGxlZnRyaWdodGFycm93JCBzdmkuCgpUaGUgbW9kZWwgYmVjb21lcwoKJCRZPVxiZXRhXzArXGJldGFfdlhfditcYmV0YV93WF93K1xiZXRhX3NYX3MrXGJldGFfe3ZzfVhfdlhfcyArIFxiZXRhX3t3c31YX3dYX3MgK1xlcHNpbG9uJCQKCi0tLQoKYGBge3J9CmxtVldTX0ludFZTX1dTIDwtIGxtKGxwc2EgfiBsY2F2b2wgKyBsd2VpZ2h0ICsgc3ZpICsgc3ZpOmxjYXZvbCArIHN2aTpsd2VpZ2h0LCBkYXRhID0gcHJvc3RhdGUpCnN1bW1hcnkobG1WV1NfSW50VlNfV1MpCmBgYAoKLS0tCgpCZWNhdXNlICRYX1MkIGlzIGEgZHVtbXkgdmFyaWFiZWxlIHdlIG9idGFpbiB0byBkaXN0aW5jdCByZWdyZXNzaW9uIHBsYW5lczoKCjEuIE1vZGVsIGZvciAkWF9zPTAkOiAkJFk9XGJldGFfMCtcYmV0YV92WF92K1xiZXRhX3dYX3cgKyBcZXBzaWxvbiQkIHdoZXJlIHRoZSBtYWluIGVmZmVjdHMgYXJlIHRoZSBzbG9wZSBmb3IgbGNhdm9sIGFuZCBsd2VpZ2h0CjIuIGFuZCBtb2RlbCBmb3IgJFhfcz0xJDoKICAgJCRcYmVnaW57YXJyYXl9e2xjbH0KICAgWSY9JlxiZXRhXzArXGJldGFfdlhfditcYmV0YV9zK1xiZXRhX3dYX3crXGJldGFfe3ZzfVhfdiArIFxiZXRhX3t3c31YX3cgK1xlcHNpbG9uXFwKICAmPSYgKFxiZXRhXzArXGJldGFfcykrKFxiZXRhX3YrXGJldGFfe3ZzfSlYX3YrKFxiZXRhX3crXGJldGFfe3dzfSlYX3crXGVwc2lsb24KICBcZW5ke2FycmF5fSQkCndpdGggaW50ZXJjZXB0ICRcYmV0YV8wK1xiZXRhX3MkIGFuZCBzbG9wZXMgJFxiZXRhX3YrXGJldGFfe3ZzfSQgYW5kICRcYmV0YV93K1xiZXRhX3t3c30kCgotLS0KCmBgYHtyIG91dC53aWR0aD0nMTAwJScsIGZpZy5hc3A9LjgsIGZpZy5hbGlnbj0nY2VudGVyJywgbWVzc2FnZT1GQUxTRSxlY2hvPUZBTFNFfQpwYXIobWZyb3cgPSBjKDEsIDIpKQpsaWJyYXJ5KHBsb3QzRCkKZ3JpZC5saW5lcyA8LSAxMAp4IDwtIHByb3N0YXRlJGxjYXZvbAp5IDwtIHByb3N0YXRlJGx3ZWlnaHQKeiA8LSBwcm9zdGF0ZSRscHNhCmZpdCA8LSBsbSh6IH4geCArIHkgKyBzdmksIGRhdGEgPSBwcm9zdGF0ZSkKeC5wcmVkIDwtIHNlcShtaW4oeCksIG1heCh4KSwgbGVuZ3RoLm91dCA9IGdyaWQubGluZXMpCnkucHJlZCA8LSBzZXEobWluKHkpLCBtYXgoeSksIGxlbmd0aC5vdXQgPSBncmlkLmxpbmVzKQoKIyBmaXR0ZWQgcG9pbnRzIGZvciBkcm9wbGluZXMgdG8gc3VyZmFjZQp0aCA8LSAtMjUKcGggPC0gNQpzY2F0dGVyM0QoeCwgeSwgeiwKICBwY2ggPSAxNiwgY29sID0gYygiZGFya2JsdWUiLCAicmVkIilbYXMuZG91YmxlKHByb3N0YXRlJHN2aSldLCBjZXggPSAuNzUsCiAgdGhldGEgPSB0aCwgcGhpID0gcGgsIHRpY2t0eXBlID0gImRldGFpbGVkIiwKICB4bGFiID0gImxjYXZvbCIsIHlsYWIgPSAibHdlaWdodCIsIHpsYWIgPSAibHBzYSIsCiAgY29sdmFyID0gRkFMU0UsIGJ0eSA9ICJnIiwgbWFpbiA9ICJBZGRpdGl2ZSBtb2RlbCIKKQoKZm9yIChpIGluIHdoaWNoKHByb3N0YXRlJHN2aSA9PSAiaGVhbHRoeSIpKSB7CiAgbGluZXMzRCh4ID0gcmVwKHByb3N0YXRlJGxjYXZvbFtpXSwgMiksIHkgPSByZXAocHJvc3RhdGUkbHdlaWdodFtpXSwgMiksIHogPSBjKHByb3N0YXRlJGxwc2FbaV0sIGxtVldTJGZpdFtpXSksIGNvbCA9IGMoImRhcmtibHVlIiwgInJlZCIpW2FzLmRvdWJsZShwcm9zdGF0ZSRzdmkpW2ldXSwgYWRkID0gVFJVRSwgbHR5ID0gMikKfQoKei5wcmVkM0QgPC0gb3V0ZXIoeC5wcmVkLCB5LnByZWQsIGZ1bmN0aW9uKHgsIHkpIHsKICBsbVZXUyRjb2VmWzFdICsgbG1WV1MkY29lZlsyXSAqIHggKyBsbVZXUyRjb2VmWzNdICogeQp9KQp4LnByZWQzRCA8LSBvdXRlcih4LnByZWQsIHkucHJlZCwgZnVuY3Rpb24oeCwgeSkgeCkKeS5wcmVkM0QgPC0gb3V0ZXIoeC5wcmVkLCB5LnByZWQsIGZ1bmN0aW9uKHgsIHkpIHkpCnN1cmYzRCh4LnByZWQzRCwgeS5wcmVkM0QsIHoucHJlZDNELCBjb2wgPSAiYmx1ZSIsIGZhY2V0cyA9IE5BLCBhZGQgPSBUUlVFKQp6Mi5wcmVkM0QgPC0gb3V0ZXIoeC5wcmVkLCB5LnByZWQsIGZ1bmN0aW9uKHgsIHkpIHsKICBsbVZXUyRjb2VmWzFdICsgbG1WV1MkY29lZls0XSArIGxtVldTJGNvZWZbMl0gKiB4ICsgbG1WV1MkY29lZlszXSAqIHkKfSkKc3VyZjNEKHgucHJlZDNELCB5LnByZWQzRCwgejIucHJlZDNELCBjb2wgPSAib3JhbmdlIiwgZmFjZXRzID0gTkEsIGFkZCA9IFRSVUUpCgoKc2NhdHRlcjNEKHgsIHksIHosCiAgcGNoID0gMTYsIGNvbCA9IGMoImRhcmtibHVlIiwgInJlZCIpW2FzLmRvdWJsZShwcm9zdGF0ZSRzdmkpXSwgY2V4ID0gLjc1LAogIHRoZXRhID0gdGgsIHBoaSA9IHBoLCB0aWNrdHlwZSA9ICJkZXRhaWxlZCIsCiAgeGxhYiA9ICJsY2F2b2wiLCB5bGFiID0gImx3ZWlnaHQiLCB6bGFiID0gImxwc2EiLAogIGNvbHZhciA9IEZBTFNFLCBidHkgPSAiZyIsIG1haW4gPSAiTW9kZWwgbWV0IGxjYXZvbDpsd2VpZ2h0IGludGVyYWN0aWUiCikKCmZvciAoaSBpbiB3aGljaChwcm9zdGF0ZSRzdmkgPT0gImhlYWx0aHkiKSkgewogIGxpbmVzM0QoeCA9IHJlcChwcm9zdGF0ZSRsY2F2b2xbaV0sIDIpLCB5ID0gcmVwKHByb3N0YXRlJGx3ZWlnaHRbaV0sIDIpLCB6ID0gYyhwcm9zdGF0ZSRscHNhW2ldLCBsbVZXU19JbnRWU19XUyRmaXRbaV0pLCBjb2wgPSBjKCJkYXJrYmx1ZSIsICJyZWQiKVthcy5kb3VibGUocHJvc3RhdGUkc3ZpKVtpXV0sIGFkZCA9IFRSVUUsIGx0eSA9IDIpCn0KCnoucHJlZDNEIDwtIG91dGVyKHgucHJlZCwgeS5wcmVkLCBmdW5jdGlvbih4LCB5KSB7CiAgbG1WV1NfSW50VlNfV1MkY29lZlsxXSArIGxtVldTX0ludFZTX1dTJGNvZWZbMl0gKiB4ICsgbG1WV1NfSW50VlNfV1MkY29lZlszXSAqIHkKfSkKeC5wcmVkM0QgPC0gb3V0ZXIoeC5wcmVkLCB5LnByZWQsIGZ1bmN0aW9uKHgsIHkpIHgpCnkucHJlZDNEIDwtIG91dGVyKHgucHJlZCwgeS5wcmVkLCBmdW5jdGlvbih4LCB5KSB5KQpzdXJmM0QoeC5wcmVkM0QsIHkucHJlZDNELCB6LnByZWQzRCwgY29sID0gImJsdWUiLCBmYWNldHMgPSBOQSwgYWRkID0gVFJVRSkKejIucHJlZDNEIDwtIG91dGVyKHgucHJlZCwgeS5wcmVkLCBmdW5jdGlvbih4LCB5KSB7CiAgbG1WV1NfSW50VlNfV1MkY29lZlsxXSArIGxtVldTX0ludFZTX1dTJGNvZWZbNF0gKyBsbVZXU19JbnRWU19XUyRjb2VmWzJdICogeCArIGxtVldTX0ludFZTX1dTJGNvZWZbM10gKiB5ICsgbG1WV1NfSW50VlNfV1MkY29lZls1XSAqIHggKyBsbVZXU19JbnRWU19XUyRjb2VmWzZdICogeQp9KQpzdXJmM0QoeC5wcmVkM0QsIHkucHJlZDNELCB6Mi5wcmVkM0QsIGNvbCA9ICJvcmFuZ2UiLCBmYWNldHMgPSBOQSwgYWRkID0gVFJVRSkKYGBgCgotLS0KCiMgQU5PVkEgVGFiZWwKClRoZSB0b3RhbCBTU1RvdCBpcyBhZ2FpbgoKJCQKICBcdGV4dHtTU1RvdH0gPSBcc3VtX3tpPTF9Xm4gKFlfaSAtIFxiYXJ7WX0pXjIuCiQkCgpUaGUgcmVzaWR1YWwgc3VtIG9mIHNxdWFyZXMgcmVtYWlucyBzaW1pbGFyCiQkCiAgXHRleHR7U1NFfSA9IFxzdW1fe2k9MX1ebiAoWV9pLVxoYXR7WX1faSleMi4KJCQKCkFnYWluIHRoZSB0b3RhbCBzdW0gb2Ygc3F1YXJlcyBjYW4gYmUgZGVjb21wb3NlZCBpbiAsCiQkCiAgXHRleHR7U1NUb3R9ID0gXHRleHR7U1NSfSArIFx0ZXh0e1NTRX0gLAokJAp3aXRoCiQkCiAgXHRleHR7U1NSfSA9IFxzdW1fe2k9MX1ebiAoXGhhdHtZfV9pLVxiYXJ7WX0pXjIuCiQkCgotLS0KCldlIGhhdmUgZm9sbG93aW5nIGRlZ3JlZXMgb2YgZnJlZWRvbSBhbmQgbWVhbiBzdW0gb2Ygc3F1YXJlczoKCi0gU1NUb3QgaGFzICRuLTEkIGRlZ3JlZXMgb2YgZnJlZWRvbSBhbmQgJFx0ZXh0e1NTVG90fS8obi0xKSQgaXMgYW4gZXN0aW1hdG9yIGZvciB0aGUgdG90YWwgdmFyaWFuY2UgaW4gJFkkIChtYXJnaW5hbCBkaXN0cmlidXRpb24gb2YgJFkkKS4KLSBTU0UgaGFzICRuLXAkIGRlZ3JlZXMgb2YgZnJlZWRvbSBhbmQgJFx0ZXh0e01TRX09XHRleHR7U1NFfS8obi1wKSQgaXMgYW4gc2NoYXR0ZXIgZm9yIHRoZSByZXNpZHVhbCB2YXJpYW5jZSBvZiAkWSQgZ2l2ZW4gdGhlIHByZWRpY3RvcmVzIChpLmUuIGFuIGVzdGltYXRvciBmb3IgdGhlIHJlc2lkdWFsIHZhcmlhbmNlICRcc2lnbWFeMiQgb2YgdGhlIGVycm9yIHRlcm0gJFxlcHNpbG9uJCkuCi0gU1NSIGhhcyAkcC0xJCBkZWdyZWVzIG9mIGZyZWVkb20gICBhbmQgJFx0ZXh0e01TUn09XHRleHR7U1NSfS8ocC0xKSQgaXMgdGhlIG1lYW4gc3VtIG9mIHNxdWFyZXMgb2YgdGhlIHJlZ3Jlc3Npb24uCgpUaGUgZGV0ZXJtaW5hdGlvbiBjb2VmZmljaWVudHMgcmVtYWlucyBhcyBiZWZvcmUsICBpLmUuCiQkCiAgUl4yID0gMS1cZnJhY3tcdGV4dHtTU0V9fXtcdGV4dHtTU1RvdH19ID0gXGZyYWN7XHRleHR7U1NSfX17XHRleHR7U1NUb3R9fQokJAphbmQgaXMgdGhlIGZyYWN0aW9uIG9mIHRoZSB0b3RhbCB2YXJpYWJpbGl0eSB0aGF0IGNhbiBiZSBleHBsYWluZWQgYnkgdGhlIHJlZ3Jlc3Npb24gbW9kZWwuCgpUZXN0c3RhdGlzdGljICRGPVx0ZXh0e01TUn0vXHRleHR7TVNFfSQgaXMgdW5kZXIgJEhfMDpcYmV0YV8xPVxsZG90cz1cYmV0YV97cC0xfT0wJCBkaXN0cmlidXRlZCBieSBhbiBGIGRpc3RyaWJ1dGlvbjogJEZfe3AtMTtuLXB9JC4KCi0tLQoKYGBge3IsIGVjaG89RkFMU0V9CnN1bW1hcnkobG1WV1MpCmBgYAoKLS0tCgojIyBBZGRpdGlvbmFsIHN1bXMgb2Ygc3F1YXJlcwoKCkNvbnNpZGVyIDIgbW9kZWxzIGZvciB0aGUgcHJlZGljdG9ycyAkeF8xJCBlbiAkeF8yJDoKJCQKICBZX2kgPSBcYmV0YV8wK1xiZXRhXzEgeF97aTF9ICsgXGVwc2lsb25faSwKJCQKd2l0aCAkXGVwc2lsb25faVx0ZXh0eyBpaWQgfSBOKDAsXHNpZ21hXzFeezJ9KSQsIGFuZAokJApZX2kgPSBcYmV0YV8wK1xiZXRhXzEgeF97aTF9K1xiZXRhXzIgeF97aTJ9ICsgXGVwc2lsb25faSwKJCQKd2l0aCAkXGVwc2lsb25faVx0ZXh0eyBpaWQgfSBOKDAsXHNpZ21hXzJeezJ9KSQuCgpmb3IgdGhlIGZpcnN0IChnZXJlZHVjZWVyZGUpIG1vZGVsIHdlIGhhdmUgZGVjb21wb3NpdGlvbgpcWwogIFx0ZXh0e1NTVG90fSA9IFx0ZXh0e1NTUn1fMSArIFx0ZXh0e1NTRX1fMQpcXQplbiBmb3IgdGhlIHNlY29uZCBub24tcmVkdWNlZCBtb2RlbCB3ZSBoYXZlClxbCiAgXHRleHR7U1NUb3R9ID0gXHRleHR7U1NSfV8yICsgXHRleHR7U1NFfV8yClxdCihTU1RvdCBpcyBvZiBjb3Vyc2UgdGhlIHNhbWUgYmVjYXVzZSBpdCBvbmx5IGRlcGVuZHMgb24gdGhlIHJlc3BvbnNlIGFuZCBub3Qgb2YgdGhlIG1vZGVscykuCgotLS0KCioqRGVmaW5pdGlvbiBvZiBhZGRpdGlvbmFsIHN1bSBvZiBzcXVhcmVzKioKVGhlICphZGRpdGlvbmFsIHN1bSBvZiBzcXVhcmVzKiBvZiBwcmVkaWN0b3IgJHhfMiQgYXMgY29tcGFyZWQgdG8gdGhlIG1vZGVsIHdpdGggb25seSAkeF8xJCBhcyBwcmVkaWN0b3IgaXMgZ2l2ZW4gYnkKJCQKICBcdGV4dHtTU1J9X3syXG1pZCAxfSA9IFx0ZXh0e1NTRX1fMS1cdGV4dHtTU0V9XzI9XHRleHR7U1NSfV8yLVx0ZXh0e1NTUn1fMS4KJCQKCk5vdGUgdGhhdCwgICRcdGV4dHtTU0V9XzEtXHRleHR7U1NFfV8yPVx0ZXh0e1NTUn1fMi1cdGV4dHtTU1J9XzEkIGlzIHRyaXZpYWFsIGlzIGJlY2F1c2Ugb2YgdGhlIGRlY29tcG9zaXRpb24gb2YgdGhlIHRvdGFsIHN1bSBvZiBzcXVhcmVzLgoKVGhlIGFkZGl0aW9uYWwgc3VtIG9mIHNxdWFyZXMgJFx0ZXh0e1NTUn1fezJcbWlkIDF9JCBjYW4gc2ltcGx5IGJlIGludGVycHJldGVkIGFzIHRoZSBhZGRpdGlvbmFsIHZhcmlhYmlsaXR5IHRoYXQgY2FuIGJlIGV4cGxhaW5lZCBieSBhZGRpbmcgcHJlZGljdG9yICR4XzIkIHRvIHRoZSBtb2RlbCB3aXRoIHByZWRpY3RvciAkeF8xJC4KCldpdGggdGhpcyBzdW0gb2Ygc3F1YXJlcyB3ZSBjYW4gZnVydGhlciBkZWNvbXBvc2UgdGhlIHRvdGFsIHN1bSBvZiBzcXVhcmVzCiQkCiAgXHRleHR7U1NUb3R9ID0gXHRleHR7U1NSfV8xKyBcdGV4dHtTU1J9X3syXG1pZCAxfSArIFx0ZXh0e1NTRX0uCiQkCndoaWNoIGZvbGxvd3MgZGlyZWN0bHkgZnJvbSB0aGUgZGVmaW5pdGlvbiAkXHRleHR7U1NSfV97MlxtaWQgMX0kLgoKLS0tCgpFeHRlbnNpb246ICgkczxwLTEkKQokJApZX2kgPSBcYmV0YV8wICsgXGJldGFfMSB4X3tpMX0gKyBcY2RvdHMgKyBcYmV0YV97c30geF97aXN9ICsgXGVwc2lsb25faQokJAp3aXRoICRcZXBzaWxvbl9pXHRleHR7IGlpZCB9TigwLFxzaWdtYV8xXnsyfSkkLCBhbmQgKCRzPCBxXGxlcSBwLTEkKQokJApZX2kgPSBcYmV0YV8wICsgXGJldGFfMSB4X3tpMX0gKyBcY2RvdHMgKyBcYmV0YV97c30geF97aXN9ICsgXGJldGFfe3MrMX0geF97aXMrMX0gKyBcY2RvdHMgXGJldGFfe3F9eF97aXF9KyBcZXBzaWxvbl9pCiQkCndpdGggJFxlcHNpbG9uX2lcdGV4dHsgaWlkIH0gTigwLFxzaWdtYV8yXnsyfSkkLgoKClRoZSAqKmFkZGl0aW9uYWwgc3VtIG9mIHNxdWFyZXMqKiBvZiBwcmVkaWN0b3IgJHhfe3MrMX0sIFxsZG90cywgeF9xJCBjb21wYXJlZCB0byBhIG1vZGVsIHdpdGggb25seSBwcmVkaWN0b3JzICAkeF8xLFxsZG90cywgeF97c30kIGlzIGdpdmVuIGJ5CgokJAogIFx0ZXh0e1NTUn1fe3MrMSwgXGxkb3RzLCBxXG1pZCAxLFxsZG90cywgc30gPSBcdGV4dHtTU0V9XzEtXHRleHR7U1NFfV8yPVx0ZXh0e1NTUn1fMi1cdGV4dHtTU1J9XzEuCiQkCgotLS0KCiMjIyBUeXBlIEkgU3VtcyBvZiBTcXVhcmVzClN1cHBvc2UgdGhhdCAkcC0xJCBwcmVkaWN0b3JzIGFyZSBjb25zaWRlcmVkLCBhbmQgc3VwcG9zZSB0aGUgZm9sbG93aW5nIHNlcXVlbmNlIG9mIG1vZGVscyAoJHM9MixcbGRvdHMsIHAtMSQpCiQkCllfaSA9IFxiZXRhXzAgKyBcc3VtX3tqPTF9XntzfSBcYmV0YV9qIHhfe2lqfSArIFxlcHNpbG9uX2kKJCQKd3V0aCAkXGVwc2lsb25faVx0ZXh0eyBpaWQgfSBOKDAsXHNpZ21hXnsyfSkkLgoKLSBUaGUgY29ycmVzcG9uZGluZyBzdW0gb2Ygc3F1YXJlcyBhcmUgZGVub3RlZCBhcyAkXHRleHR7U1NSfV97c30kIGFuZCAkXHRleHR7U1NFfV97c30kLgotIFRoZSBzZXF1ZW5jZSBvZiBtb2RlbHMgZ2l2ZXMgcmlzZSB0byB0aGUgZm9sbG93aW5nIHN1bXMgb2Ygc3F1YXJlczogJFx0ZXh0e1NTUn1fe3NcbWlkIDEsXGxkb3RzLCBzLTF9JC4KLSBUaGUgbGF0dGVyIHN1bSBvZiBzcXVhcmVzIGlzIHJlZmVycmVkIHRvIGFzIHR5cGUgSSBzdW1zIG9mIHNxdWFyZXMuIE5vdGUgdGhhdCB0aGV5IGRlcGVuZCBvbiB0aGUgb3JkZXIgaW4gd2hpY2ggdGhlIG1vZGVscyB3ZXJlIGFkZGVkIHRvIHRoZSBtb2RlbC4KCi0tLQoKV2UgY2FuIHNob3cgZm9yIG1vZGVsIE1vZGVsIHdpdGggJHM9cC0xJCB0aGF0CiQkCiBcdGV4dHtTU1RvdH0gPSBcdGV4dHtTU1J9XzEgKyBcdGV4dHtTU1J9X3syXG1pZCAxfSArIFx0ZXh0e1NTUn1fezNcbWlkIDEsMn0gKyBcY2RvdHMgKyBcdGV4dHtTU1J9X3twLTFcbWlkIDEsXGxkb3RzLCBwLTJ9ICsgXHRleHR7U1NFfSwKJCQKd2l0aCAkXHRleHR7U1NFfSQgdGhlIHJlc2lkdWFsIHN1bSBvZiBzcXVhcmVzIG9mIHRoZSBtb2RlbCB3aXRoIGFsbCAkcC0xJCBwcmVkaWN0b3JzCiQkCiAgXHRleHR7U1NSfV8xICsgXHRleHR7U1NSfV97MlxtaWQgMX0gKyBcdGV4dHtTU1J9X3szXG1pZCAxLDJ9ICsgXGNkb3RzICsgXHRleHR7U1NSfV97cC0xXG1pZCAxLFxsZG90cywgcC0yfSA9IFx0ZXh0e1NTUn0KJCQKd2l0aCAkXHRleHR7U1NSfSQgdGhlIHN1bSBvZiBzcXVhcmVzIG9mIGFsbCAgJHAtMSQgcHJlZGljdG9ycy4KCi0gVGhlIGludGVycHJldGF0aW9uIG9mIGVhY2ggdGVybSBkZXBlbmRzIG9uIHRoZSBvcmRlciBvZiB0aGUgc2VxdWVuY2Ugb2YgdGhlIHJlZ3Jlc3Npb24gbW9kZWxzLgoKLS0tCgotIEVhY2ggdHlwZSBJIFNTUiBpbnZvbHZlcyAxIHByZWRpY3RvciBhbmQgaGFzIDEgZGVncmVlIG9mIGZyZWVkb20gKG5vdGUgdGhhdCBtdWx0aXBsZSBkdW1taWVzIGZvciBhIGZhY3RvciBhcmUgdHlwaWNhbGx5IHJlbW92ZWQgdG9nZXRoZXIpLgotIEZvciBlYWNoIHR5cGUgSSBTU1IgdGVybSB0aGUgbWVhbiBzdW0gb2Ygc3F1YXJlcyBpcyBkZWZpbmVkIGJ5ICAkXHRleHR7TVNSfV97alxtaWQgMSxcbGRvdHMsIGotMX09XHRleHR7U1NSfV97alxtaWQgMSxcbGRvdHMsIGotMX0vMSQuCi0gQW5kIHRlc3RzdGF0aXN0aWMgJEY9XHRleHR7TVNSfV97alxtaWQgMSxcbGRvdHMsIGotMX0vXHRleHR7TVNFfSQgZm9sbG93cyBhICRGX3sxO24tKGorMSl9JCBkaXN0cmlidXRpb24gdW5kZXIgICRIXzA6XGJldGFfaj0wJCB3aXRoICRzPWokLgotIFRoZXNlIHN1bXMgb2Ygc3F1YXJlcyBhcmUgdGhlIGRlZmF1bHQgc3VtIG9mIHNxdWFyZXMgaW4gdGhlIGFub3ZhIGZ1bmN0aW9uIG9mIFIuCgotLS0KCiMjIyBUeXBlIElJSSBTdW1zIG9mIHNxdWFyZXMKCiBUeXBlIElJSSBzdW0gb2Ygc3F1YXJlcyBmb3IgcHJlZGljdG9yICR4X2okIGFyZSBnaXZlbiBieSB0aGUgYWRkaXRpb25hbCBzdW0gb2Ygc3F1YXJlcwokJAogIFx0ZXh0e1NTUn1fe2ogXG1pZCAxLFxsZG90cywgai0xLGorMSxcbGRvdHMsIHAtMX0gPSBcdGV4dHtTU0V9XzEtXHRleHR7U1NFfV8yCiQkCgotICRcdGV4dHtTU0V9XzIkIHRoZSBzdW0gb2Ygc3F1YXJlcyBvZiB0aGUgcmVzaWR1YWxzIG9mIHRoZSBtb2RlbCB3aXRoIGFsbCAkcC0xJCBwcmVkaWN0b3JzLgotICRcdGV4dHtTU0V9XzEkIHN1bSBvZiBzcXVhcmVzIG9mIHRoZSByZXNpZHVhbHMgd2l0aCBhbGwgJHAtMSQgcHJlZGljdG9ycywgZXhjZXB0IGZvciBwcmVkaWN0b3IgJHhfaiQuCgpUaGUgdHlwZSBJSUkgc3VtIG9mIHNxdWFyZXMgJFx0ZXh0e1NTUn1fe2ogXG1pZCAxLFxsZG90cywgai0xLGorMSxcbGRvdHMsIHAtMX0kIHF1YW50aWZ5IHRoZSBjb250cmlidXRpb24gaW4gdGhlIHRvdGFsIHZhcmlhbmNlIG9mIHRoZSBvdXRjb21lIGV4cGxhaW5lZCBieSAkeF9qJCB0aGF0IGNhbm5vdCBiZSBleHBsYWluZWQgYnkgdGhlIHJlbWFpbmluZyAkcC0yJCBwcmVkaWN0b3JzLgoKLS0tCgpUaGUgdHlwZSBJSUkgc3VtIG9mIHNxdWFyZXMgaGFzIDEgZGVncmVlIG9mIGZyZWVkb20gYmVjYXVzZSBpdCBpbnZvbHZlcyAxICRcYmV0YSQtcGFyYW1ldGVyLgoKRm9yIGVhY2ggdHlwZSBJSUkgU1NSIHRlcm0gdGhlIG1lYW4gc3VtIG9mIHNxdWFyZXMgaXMgZGVmaW5lZCBieSAkXHRleHR7TVNSfV97aiBcbWlkIDEsXGxkb3RzLCBqLTEsaisxLFxsZG90cywgcC0xfT1cdGV4dHtTU1J9X3tqIFxtaWQgMSxcbGRvdHMsIGotMSxqKzEsXGxkb3RzLCBwLTF9LzEkLgoKVGVzdHN0YXRpc3RpZWsgJEY9XHRleHR7TVNSfV97aiBcbWlkIDEsXGxkb3RzLCBqLTEsaisxLFxsZG90cywgcC0xfS9cdGV4dHtNU0V9JCBpcyAkRl97MTtuLXB9JCBkaXN0cmlidXRlZCB1bmRlciAkSF8wOlxiZXRhX2o9MCQuCgpXZSBjYW4gb2J0YWluIHRoZXNlIHN1bXMgb2Ygc3F1YXJlcyB1c2luZyB0aGUgYEFub3ZhYCBmdW5jdGlvbiBmcm9tIHRoZSBgY2FyYCBwYWNrYWdlLgotLS0KCmBgYHtyfQpsaWJyYXJ5KGNhcikKQW5vdmEobG1WV1MsIHR5cGUgPSAzKQpgYGAKClRoZSBwLXZhbHVlcyBhcmUgaWRlbnRpY2FsIHRvIHRob3NlIG9mIHR3by1zaWRlZCB0LXRlc3RzCgpOb3RlLCBob3dldmVyLCB0aGF0IGFsbCBkdW1taWVzIGZvciBmYWN0b3JzIHdpdGggbXVsdGlwbGUgbGV2ZWxzIHdpbGwgYmUgdGFrZW4gb3V0IG9mIHRoZSBtb2RlbCBhdCBvbmNlLiBTbyB0aGVuIHRoZSB0eXBlIElJSSBzdW0gb2Ygc3F1YXJlcyB3aWxsIGhhdmUgYXMgbWFueSBkZWdyZWVzIG9mIGZyZWVkb20gYXMgdGhlIG51bWJlciBvZiBkdW1taWVzIGFuZCBhbiBvbW5pYnVzIHRlc3QgaXMgcGVyZm9ybWVkIGZvciB0aGUgZWZmZWN0IG9mIHRoZSBmYWN0b3IuCgotLS0KCiMgRGlhZ25vc3RpY3MKIyMgTXVsdGljb2xsaW5lYXJpdGVpdAoKYGBge3IgZWNobz1GQUxTRX0Kc3VtbWFyeShsbVZXUykKYGBgCgotLS0KCmBgYHtyIGVjaG89RkFMU0V9CnN1bW1hcnkobG1WV1NfSW50VlcpCmBgYAoKLS0tCgotIEVzdGltYXRlcyBhcmUgZGlmZmVyZW50IGZyb20gdGhvc2UgaW4gdGhlIGFkZGl0aXZlIG1vZGVsIGFuZCB0aGUgc3RhbmRhcmQgZXJyb3JzIGFyZSBtdWNoIGhpZ2hlciEKCi0gVGhpcyBpcyBjYXVzZWQgYnkgdGhlIG11bHRpY29sbGluZWFyaXR5IHByb2JsZW0uCgotIElmIDIgcHJlZGljdG9ycyBhcmUgc3Ryb25nbHkgY29ycmVsYXRlZCB0aGFuIHRoZXkgc2hhcmUgYSBsb3Qgb2YgaW5mb3JtYXRpb24uCgotIEl0IGlzIHRoZXJlZm9yZSBkaWZmaWN1bHQgdG8gZXN0aW1hdGUgdGhlIGluZGl2aWR1YWwgY29udHJpYnV0aW9uIG9mIGVhY2ggcHJlZGljdG9yIG9uIHRoZSBvdXRjb21lLgoKLSBMZWFzdCBzcXVhcmVzIGVzdGltYXRvcnMgYmVjb21lIGluc3RhYmxlLgoKLSBTdGFuZGFyZCBlcnJvcnMgYmVjb21lIGluZmxhdGVkLgoKLSBBcyBsb25nIGFzIHdlIG9ubHkgZG8gcHJlZGljdGlvbnMgb24gdGhlIGJhc2lzIG9mIHRoZSByZWdyZXNzaW9uIG1vZGVsIHdpdGhvdXQgZXh0cmFwb2xhdGluZyBiZXlvbmQgdGhlIHJhbmdlIG9mIHRoZSBwcmVkaWN0b3JzIG9ic2VydmVkIGluIHRoZSBzYW1wbGUgbXVsdGljb2xpbmVhcml0eSBpcyBub3QgcHJvYmxlbWF0aWMuCgotIEJ1dCBmb3IgaW5mZXJlbmNlIGl0IGlzIHByb2JsZW1hdGljLgoKLS0tCgpgYGB7cn0KY29yKGNiaW5kKHByb3N0YXRlJGxjYXZvbCwgcHJvc3RhdGUkbHdlaWdodCwgcHJvc3RhdGUkbGNhdm9sICogcHJvc3RhdGUkbHdlaWdodCkpCmBgYAoKLSBIaWdoIGNvcnJlbGF0aW9uIGJldHdlZW4gbG9nLXR1bW9yIHZvbHVtZSBhbmQgaW50ZXJhY3Rpb24uCi0gSXQgaXMgYSBrbm93biBwcm9ibGVtIGZvciBoaWdoZXIgb3JkZXIgdGVybXMgKGludGVyYWN0aW9ucyBhbmQgcXVhZHJhdGljIHRlcm1zKQoKLS0tCgotIERldGVjdCBtdWx0aWNvbGxpbmVhcml0ZWl0IGJhc2VkIG9uIHRoZSBjb3JyZWxhdGlvbiBtYXRyaXggb3Igc2NhdHRlcnBsb3QgbWF0cml4IGlzIHN1Ym9wdGltYWwuCi0gSW4gbW9kZWxzIHdpdGggMyBvciBtb3JlIHByZWRpY3RvcnMsIHNheSBYMSwgWDIsIFgzIHdlIGNhbiBoYXZlIGhpZ2ggbXVsdGljb2xsaW5lYXJpdHkgd2hpbGUgYWxsZSBwYWlyc3dpc2UgY29ycmVsYXRpb25zIGJldHdlZW4gdGhlIHByZWRpY3RvcnMgYXJlIGxvdy4KLSBXZSBhbHNvIGhhdmUgbXVsdGljb2xsaW5lYXJpdHkgaWYgdGhlcmUgaXMgYSBoaWdoIGNvcnJlbGF0aW9uIGJldHdlZW4gWDEgYW5kIGEgbGluYWlyIGNvbWJpbmF0aW9uIG9mIFgyIGFuZCBYMy4KCi0tLQoKIyMjIFZhcmlhbmNlIGluZmxhdGlvbiBmYWN0b3IgKFZJRikKCkZvciBwYXJhbWV0ZXIgJGokIGluIGRlIHJlZ3Jlc3Npb24gbW9kZWwKXFtcdGV4dHJte1ZJRn1faj1cbGVmdCgxLVJfal4yXHJpZ2h0KV57LTF9XF0KCi0gSW4gdGhpcyBleHByZXNzaW9uICRSX2peMiQgaXMgdGhlIG11bHRpcGxlIGRldGVybWluYXRpb24gY29lZmZpY2llbnQgb2YgdGhlIGxpbmVhciByZWdyZXNzaW9uIG9mIHByZWRpY3RvciBqIG9uIHRoZSByZW1haW5pbmcgcHJlZGljdG9ycyBpbiB0aGUgbW9kZWwuCi0gVklGIGlzIDEgaWYgcHJlZGljdG9yIGogaXMgbm90IGxpbmVhciBhc3NvY2lhdGVkIHdpdGggdGhlIHJlbWFpbmluZyBwcmVkaWN0b3JzIGluIHRoZSBtb2RlbC4KLSBWSUYgaXMgbGFyZ2VyIHRoYW4gMSBpbiBhbGwgYW5kZXJlIGNhc2VzLgotIFZJRiBpcyB0aGUgZmFjdG9yIHdpdGggd2hpY2ggdGhlIG9ic2VydmVkIHZhcmlhbmNlIGluZmxhdGVzIGFzIGNvbXBhcmVkIHRvIGEgbW9kZWwgZm9yIHdoaWNoIGFsbCBwcmVkaWN0b3JlbiB3b3VsZCBiZSBpbmRlcGVuZGVuZC4KLSBWSUYgPiAxMCAkXHJpZ2h0YXJyb3ckIHN0cm9uZyBtdWx0aWNvbGxpbmVhcml0eS4KCi0tLQoKIyMjIEJvZHkgZmF0IGV4YW1wbGUKCmBgYHtyIG91dC53aWR0aD0nOTAlJywgZmlnLmFzcD0uOCwgZmlnLmFsaWduPSdjZW50ZXInLCBtZXNzYWdlPUZBTFNFLGVjaG89RkFMU0V9CmJvZHlmYXQgPC0gcmVhZF9kZWxpbSgiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0dUUEIvUFNMUzIwL21hc3Rlci9kYXRhL2JvZHlmYXQudHh0IiwgZGVsaW0gPSAiICIpCmJvZHlmYXQgJT4lIGdncGFpcnMoKQpgYGAKCi0tLQoKYGBge3IgZWNobz1GQUxTRX0KbG1GYXQgPC0gbG0oQm9keV9mYXQgfiBUcmljZXBzICsgVGhpZ2ggKyBNaWRhcm0sIGRhdGEgPSBib2R5ZmF0KQpzdW1tYXJ5KGxtRmF0KQpgYGAKCi0tLQoKYGBge3J9CnZpZihsbUZhdCkKYGBgCgotLS0KCmBgYHtyIGVjaG89RkFMU0V9CmxtTWlkYXJtIDwtIGxtKE1pZGFybSB+IFRyaWNlcHMgKyBUaGlnaCwgZGF0YSA9IGJvZHlmYXQpCnN1bW1hcnkobG1NaWRhcm0pCmBgYAoKLS0tCgoKV2UgZXZhbHVhdGUgdGhlIFZJRiBpbiB0aGUgcHJvc3RhdGUgY2FuY2VyIGV4YW1wbGUgZm9yIHRoZSBhZGRpdGl2ZSBtb2RlbCBhbmQgdGhlIG1vZGVsIHdpdGggaW50ZXJhY3RpZS4KCmBgYHtyfQp2aWYobG1WV1MpCnZpZihsbVZXU19JbnRWVykKYGBgCgotIEluZmxhdGlvbiBpbiBpbnRlcmFjdGlvbiB0ZXJtcyBvZnRlbiBjYXVzZWQgYmVjYXVzZSBtYWluIGVmZmVjdCBnZXQgYW5vdGhlciBpbnRlcnByZXRhdGlvbi4KCi0tLQoKIyMgSW5mbHVlbmNpYWwgT2JzZXJ2YXRpZXMKCgpgYGB7cn0Kc2V0LnNlZWQoMTEyMzU4KQpub2JzIDwtIDIwCnNkeSA8LSAxCnggPC0gc2VxKDAsIDEsIGxlbmd0aCA9IG5vYnMpCnkgPC0gMTAgKyA1ICogeCArIHJub3JtKG5vYnMsIHNkID0gc2R5KQp4MSA8LSBjKHgsIDAuNSkKeTEgPC0gYyh5LCAxMCArIDUgKiAxLjUgKyBybm9ybSgxLCBzZCA9IHNkeSkpCngyIDwtIGMoeCwgMS41KQp5MiA8LSBjKHksIHkxWzIxXSkKeDMgPC0gYyh4LCAxLjUpCnkzIDwtIGMoeSwgMTEpCnBsb3QoeCwgeSwgeGxpbSA9IHJhbmdlKGMoeDEsIHgyLCB4MykpLCB5bGltID0gcmFuZ2UoYyh5MSwgeTIsIHkzKSkpCnBvaW50cyhjKHgxWzIxXSwgeDJbMjFdLCB4M1syMV0pLCBjKHkxWzIxXSwgeTJbMjFdLCB5M1syMV0pLCBwY2ggPSBhcy5jaGFyYWN0ZXIoMTozKSwgY29sID0gMjo0KQphYmxpbmUobG0oeSB+IHgpLCBsd2QgPSAyKQphYmxpbmUobG0oeTEgfiB4MSksIGNvbCA9IDIsIGx0eSA9IDIsIGx3ZCA9IDIpCmFibGluZShsbSh5MiB+IHgyKSwgY29sID0gMywgbHR5ID0gMywgbHdkID0gMikKYWJsaW5lKGxtKHkzIH4geDMpLCBjb2wgPSA0LCBsdHkgPSA0LCBsd2QgPSAyKQpsZWdlbmQoInRvcGxlZnQiLCBjb2wgPSAxOjQsIGx0eSA9IDE6NCwgbGVnZW5kID0gcGFzdGUoImxtIiwgYygiIiwgYXMuY2hhcmFjdGVyKDE6MykpKSwgdGV4dC5jb2wgPSAxOjQpCmBgYAoKLS0tCgotIEl0IGlzIG5vdCBkZXNpcmFibGUgdGhhdCBhIHNpbmdsZSBvYnNlcnZhdGlvbiBsYXJnZWx5IGluZmx1ZW5jZXMgdGhlIHJlc3VsdCBvZiBhIGxpbmVhciByZWdyZXNzaW9uIGFuYWx5c2lzCgotIERpYWdub3N0aWNzIGFsbG93IHVzIHRvIGRldGVjdCBleHRyZW1lIG9ic2VydmF0aW9ucy4KLSAqU3R1ZGVudGl6ZWQgcmVzaWR1YWxzKiB0byBzcG90IG91dGxpZXJzCi0gKkxldmVyYWdlKiB0byBzcG90IG9ic2VydmF0aW9ucyB3aXRoIGV4dHJlZW0gY292YXJpYXRlIHBhdHRlcm4KCi0tLQoKIyMjIENvb2sncyBkaXN0YW5jZQoKLSBBIHN0YXRpc3RpY3MgdG8gYXNzZXNzIHRoZSBpbmZsdWVuY2UgdGhlIGVmZmVjdCBvZiBhIHNpbmdsZSBvYnNlcnZhdGlvbiBvbiB0aGUgcmVncmVzc2lvbiBhbmFseXNpcwotIENvb2sncyBkaXN0YW5jZSBmb3Igb2JzZXJ2YXRpb24gaSBpcyBkaWFnbm9zdGljIG1lYXN1cmUgZm9yIHRoaXMgcGFydGljdWxhciBvYnNlcnZhdGlvbiBvbiBhbGwgYWxsIHByZWRpY3Rpb25zIG9yIG9uICphbGwqIGVzdGltYXRlZCBwYXJhbWV0ZXJzLgpcW0RfaT1cZnJhY3tcc3VtX3tqPTF9Xm4oXGhhdHtZfV9qLVxoYXR7WX1fe2ooaSl9KV4yfXtwXHRleHRybXtNU0V9fVxdCgotIE9ic2VydmF0aW9uICRpJCBoYXMgYSBsYXJnZSBpbmZsdWVuY2Ugb24gdGhlIHJlZ3Jlc3Npb24gcGFyYW1ldGVycyBhbmQgcHJlZGljdGlvbnMgaWYgdGhlICBDb29rJ3MgZGlzdGFuY2UgJERfaSQgaXMgbGFyZ2UuCi0gRXh0cmVtZSBDb29rJ3MgZGlzdGFuY2UgaWYgaXQgaXMgbGFyZ2VyIHRoYW4gdGhlIDUwJSBxdWFudGlsZSBvZiBhbiAkRl97cCsxLG4tKHArMSl9JC1kaXN0cmlidXRpb24uCgotLS0KCgpgYGB7ciAgb3V0LndpZHRoPScxMDAlJywgZmlnLmFzcD0uOCwgZmlnLmFsaWduPSdjZW50ZXInLCBtZXNzYWdlPUZBTFNFLCBlY2hvPUZBTFNFfQpwYXIobWZyb3cgPSBjKDIsIDIpKQpwbG90KGxtVldTLCB3aGljaCA9IDUpCnBsb3QobG1WV1NfSW50VlcsIHdoaWNoID0gNSkKcGxvdChjb29rcy5kaXN0YW5jZShsbVZXUyksIHR5cGUgPSAiaCIsIHlsaW0gPSBjKDAsIDEpLCBtYWluID0gIkFkZGl0aXZlIG1vZGVsIikKYWJsaW5lKGggPSBxZigwLjUsIGxlbmd0aChsbVZXUyRjb2VmKSwgbnJvdyhwcm9zdGF0ZSkgLSBsZW5ndGgobG1WV1MkY29lZikpLCBsdHkgPSAyKQpwbG90KGNvb2tzLmRpc3RhbmNlKGxtVldTX0ludFZXKSwgdHlwZSA9ICJoIiwgeWxpbSA9IGMoMCwgMSksIG1haW4gPSAiTW9kZWwgd2l0aCBsY2F2b2w6bHdlaWdodCBpbnRlcmFjdGlvbiIpCmFibGluZShoID0gcWYoMC41LCBsZW5ndGgobG1WV1NfSW50VlckY29lZiksIG5yb3cocHJvc3RhdGUpIC0gbGVuZ3RoKGxtVldTX0ludFZXJGNvZWYpKSwgbHR5ID0gMikKYGBgCgotLS0KCi0gT25jZSB3ZSBlc3RhYmxpc2hlZCB0aGF0IGFuIG9ic2VydmF0aW9uIGlzIGluZmx1ZW50aWFsIHdlIGNhbiB1c2UgKkRGQkVUQVMqIHRvIGZpbmQgdGhlIHBhcmFtZXRlcnMgZm9yIHdoaWNoIHRoZSBlc3RpbWF0ZXMgYXJlIGxhcmdlbHkgYWZmZWN0ZWQgYnkgdGhlIG9ic2VydmF0aW9uCi0gIERGQkVUQVMgb2Ygb2JzZXJ2YXRpZSBpIGlzIGEgZGlhZ25vc3RpYyBtZWFzdXJlIGZvciAqZWFjaCBtb2RlbCBwYXJhbWV0ZXIgc2VwYXJhdGVseSouCiQkXHRleHRybXtERkJFVEFTfV97aihpKX09XGZyYWN7XGhhdHtcYmV0YX1fe2p9LVxoYXR7XGJldGF9X3tqKGkpfX17XHRleHRybXtTRH0oXGhhdHtcYmV0YX1fe2p9KX0kJAotICBERkJFVEFTIGlzIGV4dHJlbWUgd2hlbiBpdCBpcyBsYXJnZXIgdGhhbiAxIGluIHNtYWxsIHRvIG1vZGVyYXRlIGRhdGFzZXRzIG9yIGV4Y2VlZHMgJDIvXHNxcnR7bn0kIGluIGxhcmdlIGRhdGFzZXRzLgoKLS0tCgoKYGBge3Igb3V0LndpZHRoPSc5MCUnLCBmaWcuYXNwPS44LCBmaWcuYWxpZ249J2NlbnRlcicsIG1lc3NhZ2U9RkFMU0UsIGVjaG89RkFMU0V9CnBhcihtZnJvdyA9IGMoMiwgMikpCmRmYmV0YXNQbG90cyhsbVZXUykKYGBgCgotLS0KCmBgYHtyIG91dC53aWR0aD0nOTAlJywgZmlnLmFsaWduPSdjZW50ZXInLCBtZXNzYWdlPUZBTFNFLCBlY2hvPUZBTFNFfQpwYXIobWZyb3cgPSBjKDIsIDIpKQpkZmJldGFzUGxvdHMobG1WV1NfSW50VlcpCmBgYAoKLS0tCgpgYGB7ciBvdXQud2lkdGg9JzEwMCUnLGZpZy5hbGlnbj0nY2VudGVyJywgbWVzc2FnZT1GQUxTRSwgZWNobz1GQUxTRX0KYm94cGxvdChleHAocHJvc3RhdGUkbHdlaWdodCksIHlsYWIgPSAiUHJvc3RhdGUgV2VpZ2h0IChnKSIpCmBgYAoKCiMgQ29uc3RyYXN0cwoKLSBJbiBtb3JlIGNvbXBsZXggZGVzaWducyB0aGF0IGFyZSBtb2RlbGxlZCB1c2luZyBnZW5lcmFsIGxpbmVhciBtb2RlbHMgb25lIG9mdGVuIGhhcyB0byBhc3Nlc3MgbXVsdGlwbGUgaHlwb3RoZXNlcy4KLSBNb3Jlb3ZlciB0aGVzZSBoeXBvdGhlc2VzIGNhbiB0eXBpY2FsbHkgbm90IGFsd2F5cyBiZSB0cmFuc2xhdGVkIGludG8gYSB0ZXN0IG9uIG9uZSBwYXJhbWV0ZXIsIGJ1dCBpbiBhIGxpbmVhciBjb21iaW5hdGlvbiBvZiBtb2RlbCBwYXJhbWV0ZXJzLgotIEEgbGluZWFyIGNvbWJpbmF0aW9uIG9mIG1vZGVsIHBhcmFtZXRlcnMgaXMgYWxzbyByZWZlcnJlZCB0byBhcyBhIGNvbnRyYXN0LgoKIyMgTkhBTkVTIGV4YW1wbGUKCi0gU3VwcG9zZSB0aGF0IHJlc2VhcmNoZXJzIHdhbnQgdG8gYXNzZXNzIHRoZSBhc3NvY2lhdGlvbiBiZXR3ZWVuIGFnZSBhbmQgYmxvb2RwcmVzc3VyZS4KCi0gUG9zc2libHkgdGhpcyBhc3NvY2lhdGlvbiB3aWxsIGRpZmZlciBmb3IgZmVtYWxlcyBhbmQgbWFsZXMuCgotIFRoZXkgd2FudCB0byBhc3Nlc3MgZm9sbG93aW5nIGh5cG90aGVzZXM6CgogICAgLSBJcyB0aGVyZSBhbiBhc3NvY2lhdGlvbiBiZXR3ZWVuIGFnZSBhbmQgYmxvb2QgcHJlc3N1cmUgZm9yIGZlbWFsZXM/CiAgICAtIElzIHRoZXJlIGFuIGFzc29jaWF0aW9uIGJldHdlZW4gYWdlIGFuZCBibG9vZCBwcmVzc3VyZSBmb3IgbWFsZXM/CiAgICAtIElzIHRoZSBhc3NvY2lhdGlvbiBiZXR3ZWVuIGFnZSBhbmQgYmxvb2QgcHJlc3N1cmUgZGlmZmVyZW50IGZvciBmZW1hbGVzIGFuZCAgbWFsZXM/CgojIyBNb2RlbAoKV2UgZml0IGEgbW9kZWwgZm9yIHRoZSBhdmVyYWdlIHN5c3RvbGljIGJsb29kIHByZXNzdXJlIChgQlBTeXNBdmVgKSB1c2luZyBhZ2UsIGdlbmRlciBhbmQgdGhlIGludGVyYWN0aW9uIGJldHdlZW4gYWdlIGFuZCBnZW5kZXIgZm9yIGFkdWx0IGNhdWNhc2lhbnMgZnJvbSB0aGUgTkhBTkVTIHN0dWR5LgoKYGBge3J9CmxpYnJhcnkoTkhBTkVTKQpicERhdGEgPC0gTkhBTkVTICU+JQogIGZpbHRlcigKICAgIFJhY2UxID09ICJXaGl0ZSIgJgogICAgICBBZ2UgPj0gMTggJgogICAgICAhaXMubmEoQlBTeXNBdmUpCiAgKQoKbUJwMSA8LSBsbShCUFN5c0F2ZSB+IEFnZSAqIEdlbmRlciwgYnBEYXRhKQpwYXIobWZyb3cgPSBjKDIsIDIpKQpwbG90KG1CcDEpCmBgYAoKLSBBc3N1bXB0aW9ucyBhcmUgbm90IGZ1bGxmaWxsZWQhCgogICAgLSBsaW5lYXJpdGVpdCBpcyBvawogICAgLSBoZXRlcm9zY2VkYXN0aWNpdHkKICAgIC0gTm8gbm9ybWFsaXR5OiBkaXN0cmlidXRpb24gaXMgc2tld2VkIHRvIHRoZSByaWdodCAuCiAgICAtIExhcmdlIGRhdGFzZXQgc28gd2UgY2FuIGFkb3B0IHRoZSBDTFQKCiMjIyBUcmFuc2Zvcm1hdGlvbgoKV2UgZml0IGEgbW9kZWwgdXNpbmcgbG9nMiB0cmFuc2Zvcm1lZCBhdmVyYWdlIHN5c3RvbGljIGJsb29kIHByZXNzdXJlIChgQlBTeXNBdmVgKS4KCmBgYHtyfQptQnAyIDwtIGxtKEJQU3lzQXZlICU+JSBsb2cyKCkgfiBBZ2UgKiBHZW5kZXIsIGJwRGF0YSkKcGFyKG1mcm93ID0gYygyLCAyKSkKcGxvdChtQnAyKQpgYGAKCi0gUmVzaWR1YWxzIGFyZSBzdGlsbCBoZXRlcm9zY2VkYXN0aWMuCgojIyMgUmVtZWRpYXRlIGZvciBoZXRlcm9zY2VkYXN0aWNpdHkKCi0gSWYgdGhlIHJlc2lkdWFsIHBsb3Qgc2hvd3MgYSBjb25lIHdlIGNhbiBnZXQgdG8gdmFsaWQgaW5mZXJlbmNlIGZvciBsYXJnZSBzYW1wbGVzIGJ5IG1vZGVsaW5nIHRoZSB2YXJpYW5jZSAgZXhwbGljaXRseSBpbiBmdW5jdGlvbiBvZiB0aGUgZml0dGVkIHJlc3BvbnNlLgoKLSBUaGUgaW52ZXJzZSB2YXJpYW5jZSBmb3IgZWFjaCBvYnNlcnZhdGlvbiBjYW4gdGhhbiBiZSB1c2VkIGFzIGEgd2VpZ2h0IGluIHRoZSBsbSBmdW5jdGlvbi4KCjEuIE1vZGVsIHN0YW5kYXJkIGRldmlhdGlvbiBpbiBmdW5jdGlvbiBvZiBtZWFuIHJlc3BvbnNlLgoyLiBEbyB0aGlzIGJ5IG1vZGVsaW5nIGFic29sdXRlIHZhbHVlcyBvZiByZXNpZHVhbHMgaW4gZnVuY3Rpb24gb2YgZml0dGVkIHZhbHVlcyBvZiBtb2RlbC4KMy4gV2UgY2FuIHRoYW4gZXN0aW1hdGUgdGhlIHZhcmlhbmNlIG9mIFkgZm9yIGVhY2ggb2JzZXJ2YXRpb24gYnkgc3F1YXJpbmcgdGhlIHByZWRpY3Rpb25zIGZvciBhbGwgb2JzZXJ2YXRpb25zIHVzaW5nIHRoZSBtb2RlbCBmb3IgdGhlIHN0YW5kYXJkIGRldmlhdGlvbi4KNC4gSW5mZXJlbmNlIHJlbWFpbnMgdmFsaWQgYXN5bXB0b3RpY2FsbHkuCgpgYGB7cn0KbVNkIDwtIGxtKG1CcDEkcmVzICU+JSBhYnMoKSB+IG1CcDIkZml0dGVkKQpgYGAKCldlIGVzdGltYXRlIHRoZSBtb2RlbCBhZ2FpbjoKCmBgYHtyfQptQnAzIDwtIGxtKEJQU3lzQXZlIH4gQWdlICogR2VuZGVyLCBicERhdGEsIHcgPSAxIC8gbVNkJGZpdHRlZF4yKQpgYGAKClJlc2lkdWFscyBhcmUgc3RpbGwgaGV0ZXJvc2NlZGFzdGljLgoKYGBge3J9CmRhdGEuZnJhbWUocmVzaWR1YWxzID0gbUJwMyRyZXNpZHVhbHMsIGZpdCA9IG1CcDMkZml0dGVkKSAlPiUKICBnZ3Bsb3QoYWVzKGZpdCwgcmVzaWR1YWxzKSkgKwogIGdlb21fcG9pbnQoKQpgYGAKCkJ1dCB3ZSBhY2NvdW50ZWQgZm9yIHRoYXQgdXNpbmcgd2VpZ2h0cyEKTm90ZSB0aGF0IGlmIHdlIHJlc2NhbGUgdGhlIHJlc2lkdWFscyB1c2luZyB0aGUgc3RhbmRhcmQgZGV2aWF0aW9uIChtdWx0aXBseWluZyB0aGVtIHdpdGggdGhlIHNxdWFyZSByb290IG9mIHRoZSB3ZWlnaHQpIHdlIG9idGFpbiAgcmVzY2FsZWQgcmVzaWR1YWxzIHRoYXQgYXJlIGhvbW9zY2VkYXN0aWMuCgpUaGUgbW9kZWwgcGFyYW1ldGVycyBhcmUgZXN0aW1hdGVkIHVzaW5nIHdlaWdodGVkIGxlYXN0IHNxdWFyZXM6CgpcWyBTU0UgPSBcc3VtXGxpbWl0c197aT0xfV5uIHdfaSBlX2leMlxdCgp3aXRoICR3X2kgPSAxL1xoYXQgXHNpZ21hXjJfaSQuCgpXZWlnaHRlZCByZWdyZXNzaW9uIHdpbGwgY29ycmVjdCBmb3IgaGV0ZXJvc2NlZGFzdGljaXR5LgoKYGBge3J9CmRhdGEuZnJhbWUoc2NhbGVkX3Jlc2lkdWFscyA9IG1CcDMkcmVzaWR1YWxzIC8gbVNkJGZpdHRlZCwgZml0ID0gbUJwMyRmaXR0ZWQpICU+JQogIGdncGxvdChhZXMoZml0LCBzY2FsZWRfcmVzaWR1YWxzKSkgKwogIGdlb21fcG9pbnQoKQpgYGAKCiMjIyBJbmZlcmVuY2UKCmBgYHtyfQpzdW1tYXJ5KG1CcDMpCmBgYAoKVGhlIHJlc2VhcmNoIHF1ZXN0aW9ucyB0cmFuc2xhdGUgdG8gZm9sbG93aW5nIG51bGxoeXBvdGhlc2VzOgoKMS4gQXNzb2NpYXRpb24gYmV0d2VlbiBibG9vZCBwcmVzc3VyZSBhbmQgYWdlIGZvciBmZW1hbGVzPyBcW0hfMDogXGJldGFfXHRleHR7QWdlfSA9IDAgXHRleHR7IHZzIH0gSF8xOiBcYmV0YV9cdGV4dHtBZ2V9IFxuZXEgMCBcXQoKMi4gQXNzb2NpYXRpb24gYmV0d2VlbiBibG9vZCBwcmVzc3VyZSBhbmQgYWdlIGZvciBtYWxlcz8gXFtIXzA6IFxiZXRhX1x0ZXh0e0FnZX0gKyBcYmV0YV9cdGV4dHtBZ2U6R2VuZGVybWFsZX0gPSAwIFx0ZXh0eyB2cyB9IEhfMTogXGJldGFfXHRleHR7QWdlfSArIFxiZXRhX1x0ZXh0e0FnZTpHZW5kZXJtYWxlfSBcbmVxIDAgXF0KCjMuIElzIHRoZSBhc3NvY2lhdGlvbiBiZXR3ZWVuIGJsb29kIHByZXNzdXJlIGFuZCBhZ2UgZGlmZmVyZW50IGZvciBmZW1hbGVzIGFuZCBtYWxlcz8gIFxbSF8wOiBcYmV0YV9cdGV4dHtBZ2U6R2VuZGVybWFsZX0gPSAwIFx0ZXh0eyB2cyB9IEhfMTogXGJldGFfXHRleHR7QWdlOkdlbmRlcm1hbGV9IFxuZXEgMCBcXQoKCi0gV2UgY2FuIGFzc2VzcyBoeXBvdGhlc2VzIDEgYW5kIDMgaW1tZWRpYXRlbHkgdXNpbmcgdGhlIG91dHB1dCBvZiB0aGUgbW9kZWwuCi0gSHlwb3RoZXNlcyAyIGlzIGEgbGluZWFyIGNvbWJpbmF0aW9uIG9mIHR3byBwYXJhbWV0ZXJzLgotIFdlIGFsc28gbmVlZCBtdWx0aXBsZSB0ZXN0cyBmb3IgYXNzZXNzaW5nIHRoZSBhc3NvY2lhdGlvbiBiZXR3ZWVuIHN5c0JwIGFuZCBBZ2UuCgpXZSBjYW4gYWdhaW4gdXNlIGFuIEFub3ZhIGFwcHJvYWNoLgoKMS4gIFdlIGZpcnN0IGFzc2VzcyB0aGUgb21uaWJ1cyBoeXBvdGhlc2lzIHRoYXQgdGhlcmUgaXMgbm8gYXNzb2NpYXRpb24gYmV0d2VlbiBhZ2UgYW5kIGJsb29kIHByZXNzdXJlLgpcWyBIXzA6IFxiZXRhX1x0ZXh0e0FnZX0gPSBcYmV0YV9cdGV4dHtBZ2V9ICsgXGJldGFfXHRleHR7QWdlOkdlbmRlcm1hbGV9ID0gXGJldGFfXHRleHR7QWdlOkdlbmRlcm1hbGV9ID0gMApcXQoKLSB3aGljaCBzaW1wbGlmaWVzIHRvIGFzc2Vzc2luZwoKXFsgSF8wOiBcYmV0YV9cdGV4dHtBZ2V9ID0gXGJldGFfXHRleHR7QWdlOkdlbmRlcm1hbGV9ID0gMApcXQoKLSBXZSBjYW4gZG8gdGhpcyBieSBjb21wYXJpbmcgdHdvIG1vZGVsczogdGhlIGZ1bGwgbW9kZWwgd2l0aCBhbiBlZmZlY3QgZm9yIEdlbmRlciwgQWdlIGFuZCBHZW5kZXIgeCBBZ2UgaW50ZXJhY3Rpb24gYWdhaW5zdCBhIHJlZHVjZWQgbW9kZWwgd2l0aCBvbmx5IEdlbmRlci4KCjIuIElmIHdlIGNhbiByZWplY3QgdGhpcyBoeXBvdGhlc2lzIHdlIGNhbiBhZ2FpbiBkbyBhIHBvc3Rob2MgYW5hbHlzaXMgZm9yIGVhY2ggb2YgdGhlIGNvbnRyYXN0cy4KCgojIyMjIE9tbmlidXMgdGVzdAoKYGBge3J9Cm1CcDAgPC0gbG0oQlBTeXNBdmUgfiBHZW5kZXIsIGJwRGF0YSwgdyA9IDEgLyBtU2QkZml0dGVkXjIpCmFub3ZhKG1CcDAsIG1CcDMpCmBgYAoKCiMjIyMgUG9zdGhvYyB0ZXN0cwoKRm9yIHRoZSBwb3N0aG9jIHRlc3RzIHdlIHdpbGwgYWdhaW4gYnVpbGQgdXBvbiB0aGUgYG11bHRjb21wYCBwYWNrYWdlLgoKYGBge3J9CmxpYnJhcnkobXVsdGNvbXApCmJwUG9zdGhvYyA8LSBnbGh0KG1CcDMsIGxpbmZjdCA9IGMoCiAgIkFnZSA9IDAiLAogICJBZ2UgKyBBZ2U6R2VuZGVybWFsZSA9IDAiLAogICJBZ2U6R2VuZGVybWFsZSA9IDAiCikpCmJwUG9zdGhvYyAlPiUgc3VtbWFyeSgpCgpicFBvc3Rob2NDSSA8LSBicFBvc3Rob2MgJT4lIGNvbmZpbnQoKQpicFBvc3Rob2NDSQpgYGAKCk5vdGUgdGhhdCB0aGUgZ2xodCBmdW5jdGlvbiBhbGxvd3MgdXMgdG8gZGVmaW5lIHRoZSBjb250cmFzdHMgYnkgZXhwbGljaXRlbHkgZGVmaW5pbmcgdGhlIG51bGxoeXBvdGhlc2UgdXNpbmcgdGhlIG5hbWVzIG9mIHRoZSBtb2RlbCBwYXJhbWV0ZXJzLgoKIyMjIyBDb25jbHVzaW9uCgpXZSBjYW4gY29uY2x1ZGUgdGhhdCB0aGUgYXNzb2NpYXRpb24gYmV0d2VlbiBhZ2UgYW5kIGJsb29kIHByZXNzdXJlIGlzIGV4dHJlbWVseSBzaWduaWZpY2FudCAocCA8PCAwLjAwMSkuCgpUaGUgYmxvb2QgcHJlc3N1cmUgZm9yIGZlbWFsZXMgdGhhdCBkaWZmZXIgaW4gYWdlIGlzIG9uIGF2ZXJhZ2UgYHIgcm91bmQoYnBQb3N0aG9jQ0kkY29uZmludFsxLDFdLDIpYCBtbSBIZyBoaWdoZXIgcGVyIHllYXIgb2YgYWdlIGRpZmZlcmVuY2UgZm9yIHRoZSBlbGRlc3QgZmVtYWxlIGFuZCBpcyBleHRyZW1lbHkgc2lnbmlmaWNhbnQgKHAgPDwgMC4wMDEsIDk1JSBDSSBbYHIgcm91bmQoYnBQb3N0aG9jQ0kkY29uZmludFsxLC0xXSwyKWBdLgoKVGhlIGJsb29kIHByZXNzdXJlIGZvciBtYWxlcyB0aGF0IGRpZmZlciBpbiBhZ2UgaXMgb24gYXZlcmFnZSBgciByb3VuZChicFBvc3Rob2NDSSRjb25maW50WzIsMV0sMilgIG1tIEhnIGhpZ2hlciBwZXIgeWVhciBvZiBhZ2UgZGlmZmVyZW5jZSBmb3IgdGhlIGVsZGVzdCBtYWxlIGFuZCBpcyBleHRyZW1lbHkgc2lnbmlmaWNhbnQgKHAgPDwgMC4wMDEsIDk1JSBDSSBbYHIgcm91bmQoYnBQb3N0aG9jQ0kkY29uZmludFsyLC0xXSwyKWBdLgoKVGhlIGF2ZXJhZ2UgYmxvb2QgcHJlc3N1cmUgZGlmZmVyZW5jZSBiZXR3ZWVuIHN1YmplY3RzIHRoYXQgZGlmZmVyIGluIGFnZSBpcyBvbiBhdmVyYWdlICBgciByb3VuZChhYnMoYnBQb3N0aG9jQ0kkY29uZmludFszLDFdKSwyKWAgbW0gSGcvamFhciBoaWdoZXIgZm9yIGZlbWFsZXMgdGhhbiBmb3IgbWFsZXMgKHAgPDwgMC4wMDEsIDk1JSBDSSBbYHIgYnBQb3N0aG9jQ0kkY29uZmludFszLC0xXSAlPiUgYWJzICU+JSBzb3J0ICU+JXJvdW5kKC4sMilgXSkuCg==</div>
<div class="footer">
    <hr>
    This work is licensed under the <a href= "https://creativecommons.org/licenses/by-nc-sa/4.0">
    CC BY-NC-SA 4.0</a> licence.
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("08-MultipleRegression.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
